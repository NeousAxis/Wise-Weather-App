{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/cyrilleger/Wise-Weather-App/src/components/MapComponent.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useState } from 'react';\nimport { useLanguage } from '../context/LanguageContext';\nimport { useTemperatureUnit } from '../context/TemperatureUnitContext';\nimport { Search, MapPin, Locate } from 'lucide-react';\nimport 'leaflet/dist/leaflet.css';\nimport { MapContainer, TileLayer, Marker, Popup, useMap } from 'react-leaflet';\n\n// Fix Leaflet icon issue\nimport L from 'leaflet';\n\nconst MapComponent = () => {\n    const { t } = useLanguage();\n    const { convertTemp, unit } = useTemperatureUnit();\n    const [viewMode, setViewMode] = useState<'official' | 'community'>('official');\n    const [searchQuery, setSearchQuery] = useState('');\n    const [center, setCenter] = useState<[number, number]>([48.8566, 2.3522]); // Paris default\n    const [zoom, setZoom] = useState(13);\n\n    useEffect(() => {\n        // Fix Leaflet icon issue\n        L.Icon.Default.mergeOptions({\n            iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\n            iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\n            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\n        });\n    }, []);\n\n    // Mock data\n    const officialMarkers = [\n        { id: 1, lat: 48.8566, lon: 2.3522, temp: 15, condition: 'Sun' },\n        { id: 2, lat: 48.8606, lon: 2.3376, temp: 16, condition: 'Cloud' },\n    ];\n\n    const communityMarkers = [\n        { id: 101, lat: 48.8580, lon: 2.3500, condition: 'Rain', user: 'User1' },\n        { id: 102, lat: 48.8550, lon: 2.3550, condition: 'Sun', user: 'User2' },\n    ];\n\n    const handleSearch = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!searchQuery) return;\n\n        try {\n            const res = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${searchQuery}&count=1&language=en&format=json`);\n            const data = await res.json();\n            if (data.results && data.results.length > 0) {\n                const { latitude, longitude } = data.results[0];\n                setCenter([latitude, longitude]);\n            }\n        } catch (err) {\n            console.error(\"Search failed\", err);\n        }\n    };\n\n    const handleLocate = () => {\n        navigator.geolocation.getCurrentPosition((pos) => {\n            setCenter([pos.coords.latitude, pos.coords.longitude]);\n        });\n    };\n\n    // Custom MapController to handle center updates\n    const MapController = () => {\n        const map = useMap();\n        useEffect(() => {\n            map.setView(center, zoom);\n        }, [center, zoom, map]);\n        return null;\n    };\n\n    // We need to import React-Leaflet components dynamically inside this component or just assume this component is loaded dynamically.\n    // I'll use the \"import inside render\" or \"require\" approach if I can't use top-level imports.\n    // Actually, the best way in Next.js App Router is to make a wrapper component that imports this one dynamically.\n    // So I will write this file using standard imports, but I'll need to make sure 'leaflet' is not accessed during SSR.\n    // 'react-leaflet' imports are safe? No, they use 'leaflet'.\n\n    // I'll use the dynamic import approach for the sub-components here to be safe within this file.\n\n    return (\n        <div className=\"map-page\">\n            <div className=\"map-controls\">\n                <form onSubmit={handleSearch} className=\"search-bar\">\n                    <input\n                        type=\"text\"\n                        placeholder={t.map.search_placeholder}\n                        value={searchQuery}\n                        onChange={(e) => setSearchQuery(e.target.value)}\n                    />\n                    <button type=\"submit\"><Search size={20} /></button>\n                </form>\n                <button className=\"btn-icon\" onClick={handleLocate} title={t.map.my_position}>\n                    <Locate size={20} />\n                </button>\n\n                <div className=\"toggle-switch\">\n                    <button\n                        className={`toggle-btn ${viewMode === 'official' ? 'active' : ''}`}\n                        onClick={() => setViewMode('official')}\n                    >\n                        {t.map.official_forecasts}\n                    </button>\n                    <button\n                        className={`toggle-btn ${viewMode === 'community' ? 'active community' : ''}`}\n                        onClick={() => setViewMode('community')}\n                    >\n                        {t.map.community_reports}\n                    </button>\n                </div>\n            </div>\n\n            <div className=\"map-container\">\n                <MapContainer center={center} zoom={zoom} style={{ height: '100%', width: '100%' }}>\n                    <TileLayer\n                        url=\"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png\"\n                        attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>'\n                    />\n                    <MapController />\n\n                    {viewMode === 'official' ? (\n                        officialMarkers.map(m => (\n                            <Marker key={m.id} position={[m.lat, m.lon]}>\n                                <Popup>\n                                    <div className=\"popup-content\">\n                                        <strong>Official</strong>\n                                        <br />\n                                        Temp: {convertTemp(m.temp)}Â°{unit}\n                                        <br />\n                                        {m.condition}\n                                    </div>\n                                </Popup>\n                            </Marker>\n                        ))\n                    ) : (\n                        communityMarkers.map(m => (\n                            <Marker key={m.id} position={[m.lat, m.lon]}>\n                                <Popup>\n                                    <div className=\"popup-content\">\n                                        <strong>Community</strong>\n                                        <br />\n                                        User: {m.user}\n                                        <br />\n                                        {m.condition}\n                                    </div>\n                                </Popup>\n                            </Marker>\n                        ))\n                    )}\n                </MapContainer>\n            </div>\n\n            <style jsx>{`\n        .map-page {\n          height: calc(100vh - var(--header-height));\n          display: flex;\n          flex-direction: column;\n        }\n        .map-controls {\n          padding: 1rem;\n          display: flex;\n          gap: 1rem;\n          align-items: center;\n          background: var(--background);\n          z-index: 10;\n        }\n        .search-bar {\n          display: flex;\n          align-items: center;\n          border: 1px solid rgba(128, 128, 128, 0.2);\n          border-radius: 0.5rem;\n          padding: 0.5rem;\n          flex: 1;\n        }\n        .search-bar input {\n          border: none;\n          outline: none;\n          flex: 1;\n          background: transparent;\n          color: var(--foreground);\n        }\n        .btn-icon {\n          background: none;\n          border: 1px solid rgba(128, 128, 128, 0.2);\n          padding: 0.5rem;\n          border-radius: 0.5rem;\n          cursor: pointer;\n          color: var(--foreground);\n        }\n        .toggle-switch {\n          display: flex;\n          background: rgba(128, 128, 128, 0.1);\n          border-radius: 0.5rem;\n          padding: 0.25rem;\n        }\n        .toggle-btn {\n          padding: 0.5rem 1rem;\n          border: none;\n          background: transparent;\n          cursor: pointer;\n          border-radius: 0.25rem;\n          font-size: 0.875rem;\n          color: var(--foreground);\n        }\n        .toggle-btn.active {\n          background: white;\n          color: black;\n          box-shadow: 0 1px 2px rgba(0,0,0,0.1);\n        }\n        .toggle-btn.active.community {\n          background: var(--secondary);\n          color: white;\n        }\n        .map-container {\n          flex: 1;\n          position: relative;\n        }\n      `}</style>\n        </div>\n    );\n};\n\nexport default MapComponent;\n"],"names":["React","useEffect","useState","useLanguage","useTemperatureUnit","Search","MapPin","Locate","MapContainer","TileLayer","Marker","Popup","useMap","L","MapComponent","t","convertTemp","unit","viewMode","setViewMode","searchQuery","setSearchQuery","center","setCenter","zoom","setZoom","Icon","Default","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","officialMarkers","id","lat","lon","temp","condition","communityMarkers","user","handleSearch","e","FormEvent","preventDefault","res","fetch","data","json","results","length","latitude","longitude","err","console","error","handleLocate","navigator","geolocation","getCurrentPosition","pos","coords","MapController","map","setView","search_placeholder","target","value","my_position","official_forecasts","community_reports","height","width","m"],"mappings":"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","ignoreList":[]}}]
}