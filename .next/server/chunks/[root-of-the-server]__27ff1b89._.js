module.exports=[44594,e=>e.a(async(t,n)=>{try{let t=await e.y("@genkit-ai/flow");e.n(t),n()}catch(e){n(e)}},!0),28848,(e,t,n)=>{t.exports=e.x("@genkit-ai/core",()=>require("@genkit-ai/core"))},47525,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={checkOperation:()=>p};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848);async function p(e,t){if(!t.action)throw new l.GenkitError({status:"INVALID_ARGUMENT",message:"Provided operation is missing original request information"});let n=await e.lookupBackgroundAction(t.action);if(!n)throw new l.GenkitError({status:"INVALID_ARGUMENT",message:`Failed to resolve background action from original request: ${t.action}`});return await n.check(t)}},39771,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={CustomPartSchema:()=>b,DataPartSchema:()=>A,Document:()=>_,DocumentDataSchema:()=>F,MediaPartSchema:()=>h,MediaSchema:()=>f,PartSchema:()=>C,ReasoningPartSchema:()=>m,ResourcePartSchema:()=>E,TextPartSchema:()=>d,ToolRequestPartSchema:()=>g,ToolRequestSchema:()=>D,ToolResponsePartSchema:()=>v,ToolResponseSchema:()=>y,checkUniqueDocuments:()=>z};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848);let p=l.z.object({text:l.z.never().optional(),media:l.z.never().optional(),toolRequest:l.z.never().optional(),toolResponse:l.z.never().optional(),data:l.z.unknown().optional(),metadata:l.z.record(l.z.unknown()).optional(),custom:l.z.record(l.z.unknown()).optional(),reasoning:l.z.never().optional(),resource:l.z.never().optional()}),d=p.extend({text:l.z.string()}),m=p.extend({reasoning:l.z.string()}),f=l.z.object({contentType:l.z.string().optional(),url:l.z.string()}),h=p.extend({media:f}),D=l.z.object({ref:l.z.string().optional(),name:l.z.string(),input:l.z.unknown().optional()}),g=p.extend({toolRequest:D}),y=l.z.object({ref:l.z.string().optional(),name:l.z.string(),output:l.z.unknown().optional()}),v=p.extend({toolResponse:y}),A=p.extend({data:l.z.unknown()}),b=p.extend({custom:l.z.record(l.z.any())}),E=p.extend({resource:l.z.object({uri:l.z.string()})}),C=l.z.union([d,h]),F=l.z.object({content:l.z.array(C),metadata:l.z.record(l.z.string(),l.z.any()).optional()});function w(e){return void 0===e?e:JSON.parse(JSON.stringify(e))}class _{content;metadata;constructor(e){this.content=w(e.content),this.metadata=w(e.metadata)}static fromText(e,t){return new _({content:[{text:e}],metadata:t})}static fromMedia(e,t,n){return new _({content:[{media:{contentType:t,url:e}}],metadata:n})}static fromData(e,t,n){return"text"===t?this.fromText(e,n):this.fromMedia(e,t,n)}get text(){return this.content.map(e=>e.text||"").join("")}get media(){return this.content.filter(e=>e.media&&!e.text).map(e=>e.media)}get data(){return this.text?this.text:this.media?this.media[0].url:""}get dataType(){return this.text?"text":this.media&&this.media[0].contentType?this.media[0].contentType:void 0}toJSON(){return{content:w(this.content),metadata:w(this.metadata)}}getEmbeddingDocuments(e){let t=[];for(let n of e){let e=this.toJSON();n.metadata&&(e.metadata||(e.metadata={}),e.metadata.embedMetadata=n.metadata),t.push(new _(e))}return z(t),t}}function z(e){let t=new Set;for(let n of e){let e=JSON.stringify(n);if(t.has(e))return console.warn("Warning: embedding documents are not unique. Are you missing embed metadata?"),!1;t.add(e)}return!0}},20121,(e,t,n)=>{t.exports=e.x("@genkit-ai/core/schema",()=>require("@genkit-ai/core/schema"))},47721,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={EmbedderInfoSchema:()=>C,EmbeddingSchema:()=>m,defineEmbedder:()=>v,embed:()=>A,embedMany:()=>E,embedder:()=>g,embedderActionMetadata:()=>w,embedderRef:()=>F};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848),p=e.r(20121),d=e.r(39771);let m=l.z.object({embedding:l.z.array(l.z.number()),metadata:l.z.record(l.z.string(),l.z.unknown()).optional()}),f=l.z.object({input:l.z.array(d.DocumentDataSchema),options:l.z.any().optional()}),h=l.z.object({embeddings:l.z.array(m)});function D(e,t){return e.__configSchema=t,e}function g(e,t){return D((0,l.action)(y(e),(e,n)=>t({input:e.input.map(e=>new d.Document(e)),options:e.options},n)),e.configSchema)}function y(e){return{actionType:"embedder",name:e.name,inputSchema:f,outputSchema:h,metadata:{type:"embedder",info:e.info,embedder:{customOptions:e.configSchema?(0,p.toJsonSchema)({schema:e.configSchema}):void 0}}}}function v(e,t,n){return D((0,l.defineAction)(e,y(t),e=>n(e.input.map(e=>new d.Document(e)),e.options)),t.configSchema)}async function A(e,t){let n=await b(e,t);if(!n.embedderAction){let e;throw e="string"==typeof t.embedder?t.embedder:t.embedder?.__action?.name?t.embedder.__action.name:t.embedder.name,Error(`Unable to resolve embedder ${e}`)}return(await n.embedderAction({input:"string"==typeof t.content?[d.Document.fromText(t.content,t.metadata)]:[t.content],options:{version:n.version,...n.config,...t.options}})).embeddings}async function b(e,t){if("string"==typeof t.embedder)return{embedderAction:await e.lookupAction(`/embedder/${t.embedder}`)};if(Object.hasOwnProperty.call(t.embedder,"__action"))return{embedderAction:t.embedder};if(Object.hasOwnProperty.call(t.embedder,"name")){let n=t.embedder;return{embedderAction:await e.lookupAction(`/embedder/${t.embedder.name}`),config:{...n.config},version:n.version}}throw Error(`failed to resolve embedder ${t.embedder}`)}async function E(e,t){let n;if(!(n="string"==typeof t.embedder?await e.lookupAction(`/embedder/${t.embedder}`):Object.hasOwnProperty.call(t.embedder,"info")?await e.lookupAction(`/embedder/${t.embedder.name}`):t.embedder))throw Error("Unable to utilize the provided embedder");return(await n({input:t.content.map(e=>"string"==typeof e?d.Document.fromText(e,t.metadata):e),options:t.options})).embeddings}let C=l.z.object({label:l.z.string().optional(),supports:l.z.object({input:l.z.array(l.z.enum(["text","image","video"])).optional(),multilingual:l.z.boolean().optional()}).optional(),dimensions:l.z.number().optional()});function F(e){let t=e.name;return e.namespace&&!t.startsWith(e.namespace+"/")&&(t=`${e.namespace}/${t}`),{...e,name:t}}function w({name:e,info:t,configSchema:n}){return{actionType:"embedder",name:e,inputJsonSchema:(0,p.toJsonSchema)({schema:f}),outputJsonSchema:(0,p.toJsonSchema)({schema:h}),metadata:{embedder:{...t,customOptions:n?(0,p.toJsonSchema)({schema:n}):void 0}}}}},63041,(e,t,n)=>{t.exports=e.x("@genkit-ai/core/logging",()=>require("@genkit-ai/core/logging"))},93064,(e,t,n)=>{t.exports=e.x("@genkit-ai/core/tracing",()=>require("@genkit-ai/core/tracing"))},88836,(e,t,n)=>{"use strict";var r,o=Object.defineProperty,u=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,s={},c={ATTR_PREFIX:()=>D,BaseDataPointSchema:()=>y,BaseEvalDataPointSchema:()=>v,EVALUATOR_METADATA_KEY_DEFINITION:()=>F,EVALUATOR_METADATA_KEY_DISPLAY_NAME:()=>C,EVALUATOR_METADATA_KEY_IS_BILLED:()=>w,EvalResponseSchema:()=>_,EvalResponsesSchema:()=>z,EvalStatusEnum:()=>b,EvaluatorInfoSchema:()=>B,SPAN_STATE_ATTR:()=>g,ScoreSchema:()=>E,defineEvaluator:()=>S,evaluate:()=>k,evaluator:()=>x,evaluatorRef:()=>P};for(var l in c)o(s,l,{get:c[l],enumerable:!0});t.exports=((e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of a(t))i.call(e,n)||void 0===n||o(e,n,{get:()=>t[n],enumerable:!(r=u(t,n))||r.enumerable});return e})(o({},"__esModule",{value:!0}),s);var p=e.r(28848),d=e.r(63041),m=e.r(20121),f=e.r(93064),h=e.r(54799);let D="genkit",g=D+":state",y=p.z.object({input:p.z.unknown(),output:p.z.unknown().optional(),context:p.z.array(p.z.unknown()).optional(),reference:p.z.unknown().optional(),testCaseId:p.z.string().optional(),traceIds:p.z.array(p.z.string()).optional()}),v=y.extend({testCaseId:p.z.string()}),A=p.z.enum(["UNKNOWN","PASS","FAIL"]);var b=((r=b||{}).UNKNOWN="UNKNOWN",r.PASS="PASS",r.FAIL="FAIL",r);let E=p.z.object({id:p.z.string().describe("Optional ID to differentiate different scores if applying in a single evaluation").optional(),score:p.z.union([p.z.number(),p.z.string(),p.z.boolean()]).optional(),status:A.optional(),error:p.z.string().optional(),details:p.z.object({reasoning:p.z.string().optional()}).passthrough().optional()}),C="evaluatorDisplayName",F="evaluatorDefinition",w="evaluatorIsBilled",_=p.z.object({sampleIndex:p.z.number().optional(),testCaseId:p.z.string(),traceId:p.z.string().optional(),spanId:p.z.string().optional(),evaluation:p.z.union([E,p.z.array(E)])}),z=p.z.array(_),O=p.z.object({dataset:p.z.array(y),evalRunId:p.z.string(),options:p.z.unknown()});function S(e,t,n){let r=x(t,n);return e.registerAction("evaluator",r),r}function x(e,t){var n,r,o;let u={};return u[w]=void 0==e.isBilled||e.isBilled,u[C]=e.displayName,u[F]=e.definition,e.configSchema&&(u.customOptions=(0,m.toJsonSchema)({schema:e.configSchema})),n=(0,p.action)({actionType:"evaluator",name:e.name,inputSchema:O.extend({dataset:e.dataPointType?p.z.array(e.dataPointType):p.z.array(y),options:e.configSchema??p.z.unknown(),evalRunId:p.z.string(),batchSize:p.z.number().optional()}),outputSchema:z,metadata:{type:"evaluator",evaluator:u}},async e=>{let n=[],r=function(e,t){let n;n=t||1;let r=[];for(var o=0;o<e.length;o+=n)r.push(e.slice(o,o+n).map(e=>({...e,testCaseId:e.testCaseId??(0,h.randomUUID)()})));return r}(e.dataset,e.batchSize);for(let o=0;o<r.length;o++){let u=r[o];try{await (0,f.runInNewSpan)({metadata:{name:e.batchSize?`Batch ${o}`:`Test Case ${u[0].testCaseId}`,metadata:{"evaluator:evalRunId":e.evalRunId}},labels:{[f.SPAN_TYPE_ATTR]:"evaluator"}},async(r,a)=>{let i=a.spanContext().spanId,s=a.spanContext().traceId,c=u.map((n,u)=>{let a=e.batchSize?e.batchSize*o+u:o;return r.input={input:n.input,output:n.output,context:n.context},t(n,e.options).then(e=>({...e,traceId:s,spanId:i,sampleIndex:a})).catch(e=>({sampleIndex:a,spanId:i,traceId:s,testCaseId:n.testCaseId,evaluation:{error:`Evaluation of test case ${n.testCaseId} failed: 
${e}`}}))}),l=await Promise.all(c);r.output=1===l.length?l[0]:l,l.map(e=>{n.push(e)})})}catch(e){d.logger.error(`Evaluation of batch ${o} failed: 
${e.stack}`);continue}}return n}),r=e.dataPointType,o=e.configSchema,n.__dataPointType=r,n.__configSchema=o,n}async function k(e,t){let n;if(!(n="string"==typeof t.evaluator?await e.lookupAction(`/evaluator/${t.evaluator}`):Object.hasOwnProperty.call(t.evaluator,"info")?await e.lookupAction(`/evaluator/${t.evaluator.name}`):t.evaluator))throw Error("Unable to utilize the provided evaluator");return await n({dataset:t.dataset,options:t.options,evalRunId:t.evalRunId??(0,h.randomUUID)()})}let B=p.z.object({label:p.z.string().optional(),metrics:p.z.array(p.z.string())});function P(e){return{...e}}},11055,(e,t,n)=>{t.exports=e.x("@genkit-ai/core/async",()=>require("@genkit-ai/core/async"))},63433,(e,t,n)=>{t.exports=e.x("@genkit-ai/core/registry",()=>require("@genkit-ai/core/registry"))},60497,e=>{"use strict";let t,n,r,o,u,a,i,s,c,l,p,d,m,f;var h=/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,D=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,g=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/,y=e=>"string"==typeof e&&(e>="a"&&e<="z"||e>="A"&&e<="Z"||"$"===e||"_"===e||D.test(e)),v=e=>"string"==typeof e&&(e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||"$"===e||"_"===e||"‌"===e||"‍"===e||g.test(e)),A=e=>"string"==typeof e&&/[0-9]/.test(e),b=e=>"string"==typeof e&&/[0-9A-Fa-f]/.test(e);function E(){if(t[o])return String.fromCodePoint(t.codePointAt(o))}function C(){let e=E();return"\n"===e?(u++,a=0):e?a+=e.length:a++,e&&(o+=e.length),e}let F={default(){let e;switch(f){case"	":case"\v":case"\f":case" ":case" ":case"\uFEFF":case"\n":case"\r":case"\u2028":case"\u2029":C();return;case"/":C(),l="comment";return;case void 0:return C(),w("eof")}return"string"==typeof(e=f)&&h.test(e)?void C():F[n]()},comment(){switch(f){case"*":C(),l="multiLineComment";return;case"/":C(),l="singleLineComment";return}throw k(C())},multiLineComment(){switch(f){case"*":C(),l="multiLineCommentAsterisk";return;case void 0:throw k(C())}C()},multiLineCommentAsterisk(){switch(f){case"*":C();return;case"/":C(),l="default";return;case void 0:throw k(C())}C(),l="multiLineComment"},singleLineComment(){switch(f){case"\n":case"\r":case"\u2028":case"\u2029":C(),l="default";return;case void 0:return C(),w("eof")}C()},value(){switch(f){case"{":case"[":return w("punctuator",C());case"n":return C(),_("ull"),w("null",null);case"t":return C(),_("rue"),w("boolean",!0);case"f":return C(),_("alse"),w("boolean",!1);case"-":case"+":"-"===C()&&(m=-1),l="sign";return;case".":p=C(),l="decimalPointLeading";return;case"0":p=C(),l="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":p=C(),l="decimalInteger";return;case"I":return C(),_("nfinity"),w("numeric",1/0);case"N":return C(),_("aN"),w("numeric",NaN);case'"':case"'":d='"'===C(),p="",l="string";return}throw k(C())},identifierNameStartEscape(){if("u"!==f)throw k(C());C();let e=z();switch(e){case"$":case"_":break;default:if(!y(e))throw P()}p+=e,l="identifierName"},identifierName(){switch(f){case"$":case"_":case"‌":case"‍":p+=C();return;case"\\":C(),l="identifierNameEscape";return}if(v(f)){p+=C();return}return w("identifier",p)},identifierNameEscape(){if("u"!==f)throw k(C());C();let e=z();switch(e){case"$":case"_":case"‌":case"‍":break;default:if(!v(e))throw P()}p+=e,l="identifierName"},sign(){switch(f){case".":p=C(),l="decimalPointLeading";return;case"0":p=C(),l="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":p=C(),l="decimalInteger";return;case"I":return C(),_("nfinity"),w("numeric",1/0*m);case"N":return C(),_("aN"),w("numeric",NaN)}throw k(C())},zero(){switch(f){case".":p+=C(),l="decimalPoint";return;case"e":case"E":p+=C(),l="decimalExponent";return;case"x":case"X":p+=C(),l="hexadecimal";return}return w("numeric",0*m)},decimalInteger(){switch(f){case".":p+=C(),l="decimalPoint";return;case"e":case"E":p+=C(),l="decimalExponent";return}if(A(f)){p+=C();return}return w("numeric",m*Number(p))},decimalPointLeading(){if(A(f)){p+=C(),l="decimalFraction";return}throw k(C())},decimalPoint(){switch(f){case"e":case"E":p+=C(),l="decimalExponent";return}if(A(f)){p+=C(),l="decimalFraction";return}return w("numeric",m*Number(p))},decimalFraction(){switch(f){case"e":case"E":p+=C(),l="decimalExponent";return}if(A(f)){p+=C();return}return w("numeric",m*Number(p))},decimalExponent(){switch(f){case"+":case"-":p+=C(),l="decimalExponentSign";return}if(A(f)){p+=C(),l="decimalExponentInteger";return}throw k(C())},decimalExponentSign(){if(A(f)){p+=C(),l="decimalExponentInteger";return}throw k(C())},decimalExponentInteger(){if(A(f)){p+=C();return}return w("numeric",m*Number(p))},hexadecimal(){if(b(f)){p+=C(),l="hexadecimalInteger";return}throw k(C())},hexadecimalInteger(){if(b(f)){p+=C();return}return w("numeric",m*Number(p))},string(){switch(f){case"\\":C(),p+=function(){switch(E()){case"b":return C(),"\b";case"f":return C(),"\f";case"n":return C(),"\n";case"r":return C(),"\r";case"t":return C(),"	";case"v":return C(),"\v";case"0":if(C(),A(E()))throw k(C());return"\0";case"x":return C(),function(){let e="",t=E();if(!b(t)||(e+=C(),!b(t=E())))throw k(C());return String.fromCodePoint(parseInt(e+=C(),16))}();case"u":return C(),z();case"\n":case"\u2028":case"\u2029":return C(),"";case"\r":return C(),"\n"===E()&&C(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case void 0:throw k(C())}return C()}();return;case'"':if(d)return C(),w("string",p);p+=C();return;case"'":if(!d)return C(),w("string",p);p+=C();return;case"\n":case"\r":case void 0:throw k(C());case"\u2028":case"\u2029":var e;e=f,console.warn(`JSON5: '${R(e)}' in strings is not valid ECMAScript; consider escaping`)}p+=C()},start(){switch(f){case"{":case"[":return w("punctuator",C())}l="value"},beforePropertyName(){switch(f){case"$":case"_":p=C(),l="identifierName";return;case"\\":C(),l="identifierNameStartEscape";return;case"}":return w("punctuator",C());case'"':case"'":d='"'===C(),l="string";return}if(y(f)){p+=C(),l="identifierName";return}throw k(C())},afterPropertyName(){if(":"===f)return w("punctuator",C());throw k(C())},beforePropertyValue(){l="value"},afterPropertyValue(){switch(f){case",":case"}":return w("punctuator",C())}throw k(C())},beforeArrayValue(){if("]"===f)return w("punctuator",C());l="value"},afterArrayValue(){switch(f){case",":case"]":return w("punctuator",C())}throw k(C())},end(){throw k(C())}};function w(e,t){return{type:e,value:t,line:u,column:a}}function _(e){for(let t of e){if(E()!==t)throw k(C());C()}}function z(){let e="",t=4;for(;t-- >0;){if(!b(E()))throw k(C());e+=C()}return String.fromCodePoint(parseInt(e,16))}let O={start(){if("eof"===i.type)throw B();S()},beforePropertyName(){switch(i.type){case"identifier":case"string":s=i.value,n="afterPropertyName";return;case"punctuator":x();return;case"eof":throw B()}},afterPropertyName(){if("eof"===i.type)throw B();n="beforePropertyValue"},beforePropertyValue(){if("eof"===i.type)throw B();S()},beforeArrayValue(){if("eof"===i.type)throw B();"punctuator"===i.type&&"]"===i.value?x():S()},afterPropertyValue(){if("eof"===i.type)throw B();switch(i.value){case",":n="beforePropertyName";return;case"}":x()}},afterArrayValue(){if("eof"===i.type)throw B();switch(i.value){case",":n="beforeArrayValue";return;case"]":x()}},end(){}};function S(){let e;switch(i.type){case"punctuator":switch(i.value){case"{":e={};break;case"[":e=[]}break;case"null":case"boolean":case"numeric":case"string":e=i.value}if(void 0===c)c=e;else{let t=r[r.length-1];Array.isArray(t)?t.push(e):Object.defineProperty(t,s,{value:e,writable:!0,enumerable:!0,configurable:!0})}if(null!==e&&"object"==typeof e)r.push(e),n=Array.isArray(e)?"beforeArrayValue":"beforePropertyName";else{let e=r[r.length-1];n=null==e?"end":Array.isArray(e)?"afterArrayValue":"afterPropertyValue"}}function x(){r.pop();let e=r[r.length-1];n=null==e?"end":Array.isArray(e)?"afterArrayValue":"afterPropertyValue"}function k(e){return void 0===e?$(`JSON5: invalid end of input at ${u}:${a}`):$(`JSON5: invalid character '${R(e)}' at ${u}:${a}`)}function B(){return $(`JSON5: invalid end of input at ${u}:${a}`)}function P(){return a-=5,$(`JSON5: invalid identifier character at ${u}:${a}`)}function R(e){let t={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(t[e])return t[e];if(e<" "){let t=e.charCodeAt(0).toString(16);return"\\x"+("00"+t).substring(t.length)}return e}function $(e){let t=SyntaxError(e);return t.lineNumber=u,t.columnNumber=a,t}e.s(["default",0,{parse:function(e,h){t=String(e),n="start",r=[],o=0,u=1,a=0,i=void 0,s=void 0,c=void 0;do i=function(){for(l="default",p="",d=!1,m=1;;){f=E();let e=F[l]();if(e)return e}}(),O[n]();while("eof"!==i.type)return"function"==typeof h?function e(t,n,r){let o=t[n];if(null!=o&&"object"==typeof o)if(Array.isArray(o))for(let t=0;t<o.length;t++){let n=String(t),u=e(o,n,r);void 0===u?delete o[n]:Object.defineProperty(o,n,{value:u,writable:!0,enumerable:!0,configurable:!0})}else for(let t in o){let n=e(o,t,r);void 0===n?delete o[t]:Object.defineProperty(o,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}return r.call(t,n,o)}({"":c},"",h):c},stringify:function(e,t,n){let r,o,u,a=[],i="",s="";if(null==t||"object"!=typeof t||Array.isArray(t)||(n=t.space,u=t.quote,t=t.replacer),"function"==typeof t)o=t;else if(Array.isArray(t))for(let e of(r=[],t)){let t;"string"==typeof e?t=e:("number"==typeof e||e instanceof String||e instanceof Number)&&(t=String(e)),void 0!==t&&0>r.indexOf(t)&&r.push(t)}return n instanceof Number?n=Number(n):n instanceof String&&(n=String(n)),"number"==typeof n?n>0&&(n=Math.min(10,Math.floor(n)),s="          ".substr(0,n)):"string"==typeof n&&(s=n.substr(0,10)),function e(t,n){let u=n[t];switch(null!=u&&("function"==typeof u.toJSON5?u=u.toJSON5(t):"function"==typeof u.toJSON&&(u=u.toJSON(t))),o&&(u=o.call(n,t,u)),u instanceof Number?u=Number(u):u instanceof String?u=String(u):u instanceof Boolean&&(u=u.valueOf()),u){case null:return"null";case!0:return"true";case!1:return"false"}return"string"==typeof u?c(u,!1):"number"==typeof u?String(u):"object"==typeof u?Array.isArray(u)?function(t){let n;if(a.indexOf(t)>=0)throw TypeError("Converting circular structure to JSON5");a.push(t);let r=i;i+=s;let o=[];for(let n=0;n<t.length;n++){let r=e(String(n),t);o.push(void 0!==r?r:"null")}if(0===o.length)n="[]";else if(""===s)n="["+o.join(",")+"]";else{let e=",\n"+i,t=o.join(e);n="[\n"+i+t+",\n"+r+"]"}return a.pop(),i=r,n}(u):function(t){let n;if(a.indexOf(t)>=0)throw TypeError("Converting circular structure to JSON5");a.push(t);let o=i;i+=s;let u=r||Object.keys(t),l=[];for(let n of u){let r=e(n,t);if(void 0!==r){let e=function(e){if(0===e.length)return c(e,!0);let t=String.fromCodePoint(e.codePointAt(0));if(!y(t))return c(e,!0);for(let n=t.length;n<e.length;n++)if(!v(String.fromCodePoint(e.codePointAt(n))))return c(e,!0);return e}(n)+":";""!==s&&(e+=" "),e+=r,l.push(e)}}if(0===l.length)n="{}";else{let e;if(""===s)n="{"+(e=l.join(","))+"}";else{let t=",\n"+i;e=l.join(t),n="{\n"+i+e+",\n"+o+"}"}}return a.pop(),i=o,n}(u):void 0}("",{"":e});function c(e){let t={"'":.1,'"':.2},n={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"},r="";for(let o=0;o<e.length;o++){let u=e[o];switch(u){case"'":case'"':t[u]++,r+=u;continue;case"\0":if(A(e[o+1])){r+="\\x00";continue}}if(n[u]){r+=n[u];continue}if(u<" "){let e=u.charCodeAt(0).toString(16);r+="\\x"+("00"+e).substring(e.length);continue}r+=u}let o=u||Object.keys(t).reduce((e,n)=>t[e]<t[n]?e:n);return r=r.replace(RegExp(o,"g"),n[o]),o+r+o}}}])},34279,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Allow=n.ALL=n.COLLECTION=n.ATOM=n.SPECIAL=n.INF=n._INFINITY=n.INFINITY=n.NAN=n.BOOL=n.NULL=n.OBJ=n.ARR=n.NUM=n.STR=void 0,n.STR=1,n.NUM=2,n.ARR=4,n.OBJ=8,n.NULL=16,n.BOOL=32,n.NAN=64,n.INFINITY=128,n._INFINITY=256,n.INF=n.INFINITY|n._INFINITY,n.SPECIAL=n.NULL|n.BOOL|n.INF|n.NAN,n.ATOM=n.STR|n.NUM|n.SPECIAL,n.COLLECTION=n.ARR|n.OBJ,n.ALL=n.ATOM|n.COLLECTION,n.Allow={STR:n.STR,NUM:n.NUM,ARR:n.ARR,OBJ:n.OBJ,NULL:n.NULL,BOOL:n.BOOL,NAN:n.NAN,INFINITY:n.INFINITY,_INFINITY:n._INFINITY,INF:n.INF,SPECIAL:n.SPECIAL,ATOM:n.ATOM,COLLECTION:n.COLLECTION,ALL:n.ALL},n.default=n.Allow},88561,(e,t,n)=>{"use strict";var r=e.e&&e.e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=e.e&&e.e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.Allow=n.MalformedJSON=n.PartialJSON=n.parseJSON=n.parse=void 0;let u=e.r(34279);Object.defineProperty(n,"Allow",{enumerable:!0,get:function(){return u.Allow}}),o(e.r(34279),n);class a extends Error{}n.PartialJSON=a;class i extends Error{}function s(e,t=u.Allow.ALL){if("string"!=typeof e)throw TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw Error(`${e} is empty`);return c(e.trim(),t)}n.MalformedJSON=i,n.parseJSON=s;let c=(e,t)=>{let n=e.length,r=0,o=e=>{throw new a(`${e} at position ${r}`)},s=e=>{throw new i(`${e} at position ${r}`)},c=()=>(f(),r>=n&&o("Unexpected end of input"),'"'===e[r])?l():"{"===e[r]?p():"["===e[r]?d():"null"===e.substring(r,r+4)||u.Allow.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):"true"===e.substring(r,r+4)||u.Allow.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):"false"===e.substring(r,r+5)||u.Allow.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):"Infinity"===e.substring(r,r+8)||u.Allow.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):"-Infinity"===e.substring(r,r+9)||u.Allow._INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):"NaN"===e.substring(r,r+3)||u.Allow.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):m(),l=()=>{let a=r,i=!1;for(r++;r<n&&('"'!==e[r]||i&&"\\"===e[r-1]);)i="\\"===e[r]&&!i,r++;if('"'==e.charAt(r))try{return JSON.parse(e.substring(a,++r-Number(i)))}catch(e){s(String(e))}else if(u.Allow.STR&t)try{return JSON.parse(e.substring(a,r-Number(i))+'"')}catch(t){return JSON.parse(e.substring(a,e.lastIndexOf("\\"))+'"')}o("Unterminated string literal")},p=()=>{r++,f();let a={};try{for(;"}"!==e[r];){if(f(),r>=n&&u.Allow.OBJ&t)return a;let o=l();f(),r++;try{let e=c();a[o]=e}catch(e){if(u.Allow.OBJ&t)return a;throw e}f(),","===e[r]&&r++}}catch(e){if(u.Allow.OBJ&t)return a;o("Expected '}' at end of object")}return r++,a},d=()=>{r++;let n=[];try{for(;"]"!==e[r];)n.push(c()),f(),","===e[r]&&r++}catch(e){if(u.Allow.ARR&t)return n;o("Expected ']' at end of array")}return r++,n},m=()=>{if(0===r){"-"===e&&s("Not sure what '-' is");try{return JSON.parse(e)}catch(n){if(u.Allow.NUM&t)try{return JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(e){}s(String(n))}}let a=r;for("-"===e[r]&&r++;e[r]&&-1===",]}".indexOf(e[r]);)r++;r!=n||u.Allow.NUM&t||o("Unterminated number literal");try{return JSON.parse(e.substring(a,r))}catch(t){"-"===e.substring(a,r)&&o("Not sure what '-' is");try{return JSON.parse(e.substring(a,e.lastIndexOf("e")))}catch(e){s(String(e))}}},f=()=>{for(;r<n&&" \n\r	".includes(e[r]);)r++};return c()};n.parse=s},83132,(e,t,n)=>{"use strict";let r,o;var u=Object.create,a=Object.defineProperty,i=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,c=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,p=(e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of s(t))l.call(e,o)||o===n||a(e,o,{get:()=>t[o],enumerable:!(r=i(t,o))||r.enumerable});return e},d={},m={extractItems:()=>v,extractJson:()=>y,parsePartialJson:()=>g};for(var f in m)a(d,f,{get:m[f],enumerable:!0});t.exports=p(a({},"__esModule",{value:!0}),d);var h=(o=null!=(r=e.r(60497))?u(c(r)):{},p(r&&r.__esModule?o:a(o,"default",{value:r,enumerable:!0}),r)),D=e.r(88561);function g(e){return h.default.parse(JSON.stringify((0,D.parse)(e,D.Allow.ALL)))}function y(e,t){let n,r,o,u=0,a=!1,i=!1;for(let t=0;t<e.length;t++){let s=e[t].replace(/\u00A0/g," ");if(i){i=!1;continue}if("\\"===s){i=!0;continue}if('"'===s){a=!a;continue}if(!a)if(n||"{"!==s&&"["!==s){if(s===n)u++;else if(s===r&&!--u)return h.default.parse(e.substring(o||0,t+1))}else n=s,r="{"===s?"}":"]",o=t,u++}if(void 0!==o&&u>0)try{return g(e.substring(o))}catch{if(t)throw Error(`Invalid JSON extracted from model output: ${e}`);return null}if(t)throw Error(`Invalid JSON extracted from model output: ${e}`);return null}function v(e,t=0){let n=[],r=t;if(0===t){let t=e.indexOf("[");if(-1===t)return{items:[],cursor:e.length};r=t+1}let o=-1,u=0,a=!1,i=!1;for(let t=r;t<e.length;t++){let s=e[t];if(i){i=!1;continue}if("\\"===s){i=!0;continue}if('"'===s){a=!a;continue}if(!a){if("{"===s)0===u&&(o=t),u++;else if("}"===s){if(0==--u&&-1!==o)try{let u=h.default.parse(e.substring(o,t+1));n.push(u),r=t+1,o=-1}catch{}}else if("]"===s&&0===u)break}}return{items:n,cursor:r}}},44303,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={arrayFormatter:()=>d};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848),p=e.r(83132);let d={name:"array",config:{contentType:"application/json",constrained:!0},handler:e=>{let t;if(e&&"array"!==e.type)throw new l.GenkitError({status:"INVALID_ARGUMENT",message:"Must supply an 'array' schema type when using the 'items' parser format."});return e&&(t=`Output should be a JSON array conforming to the following schema:
    
\`\`\`
${JSON.stringify(e)}
\`\`\`
    `),{parseChunk:e=>{let t=e.previousChunks?.length?(0,p.extractItems)(e.previousText).cursor:0,{items:n}=(0,p.extractItems)(e.accumulatedText,t);return n},parseMessage:e=>{let{items:t}=(0,p.extractItems)(e.text,0);return t},instructions:t}}}},62220,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={enumFormatter:()=>p};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848);let p={name:"enum",config:{contentType:"text/enum",constrained:!0},handler:e=>{let t;if(e&&"string"!==e.type&&"enum"!==e.type)throw new l.GenkitError({status:"INVALID_ARGUMENT",message:"Must supply a 'string' or 'enum' schema type when using the enum parser format."});return e?.enum&&(t=`Output should be ONLY one of the following enum values. Do not output any additional information or add quotes.

${e.enum.map(e=>e.toString()).join("\n")}`),{parseMessage:e=>e.text.replace(/['"]/g,"").trim(),instructions:t}}}},34864,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={jsonFormatter:()=>p};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(83132);let p={name:"json",config:{format:"json",contentType:"application/json",constrained:!0,defaultInstructions:!1},handler:e=>{let t;return e&&(t=`Output should be in JSON format and conform to the following schema:

\`\`\`
${JSON.stringify(e)}
\`\`\`
`),{parseChunk:e=>(0,l.extractJson)(e.accumulatedText),parseMessage:e=>(0,l.extractJson)(e.text),instructions:t}}}},10013,(e,t,n)=>{"use strict";let r,o;var u=Object.create,a=Object.defineProperty,i=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,c=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,p=(e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of s(t))l.call(e,o)||o===n||a(e,o,{get:()=>t[o],enumerable:!(r=i(t,o))||r.enumerable});return e},d={},m={jsonlFormatter:()=>y};for(var f in m)a(d,f,{get:m[f],enumerable:!0});t.exports=p(a({},"__esModule",{value:!0}),d);var h=e.r(28848),D=(o=null!=(r=e.r(60497))?u(c(r)):{},p(r&&r.__esModule?o:a(o,"default",{value:r,enumerable:!0}),r)),g=e.r(83132);let y={name:"jsonl",config:{contentType:"application/jsonl"},handler:e=>{let t;if(e&&("array"!==e.type||e.items?.type!=="object"))throw new h.GenkitError({status:"INVALID_ARGUMENT",message:"Must supply an 'array' schema type containing 'object' items when using the 'jsonl' parser format."});return e?.items&&(t=`Output should be JSONL format, a sequence of JSON objects (one per line) separated by a newline \`\\n\` character. Each line should be a JSON object conforming to the following schema:

\`\`\`
${JSON.stringify(e.items)}
\`\`\`
    `),{parseChunk:e=>{let t=[],n=e.accumulatedText,r=0;if(e.previousChunks?.length){let t=e.previousText.lastIndexOf("\n");-1!==t&&(r=t+1)}for(let e of n.slice(r).split("\n")){let n=e.trim();if(n.startsWith("{"))try{let e=D.default.parse(n);e&&t.push(e)}catch(e){break}}return t},parseMessage:e=>e.text.split("\n").map(e=>e.trim()).filter(e=>e.startsWith("{")).map(e=>(0,g.extractJson)(e)).filter(e=>!!e),instructions:t}}}},32841,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={textFormatter:()=>l};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);let l={name:"text",config:{contentType:"text/plain"},handler:()=>({parseChunk:e=>e.text,parseMessage:e=>e.text})}},78425,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={DEFAULT_FORMATS:()=>v,configureFormats:()=>A,defineFormat:()=>h,injectInstructions:()=>y,resolveFormat:()=>D,resolveInstructions:()=>g};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(44303),p=e.r(62220),d=e.r(34864),m=e.r(10013),f=e.r(32841);function h(e,t,n){let{name:r,...o}=t,u={config:o,handler:n};return e.registerValue("format",r,u),u}async function D(e,t){if(t){if((t.jsonSchema||t.schema)&&!t.format)return e.lookupValue("format","json");if(t.format)return e.lookupValue("format",t.format)}}function g(e,t,n){return"string"==typeof n?n:!1===n?void 0:e?e.handler(t).instructions:void 0}function y(e,t){if(!t||e.find(e=>e.content.find(e=>e.metadata?.purpose==="output"&&!e.metadata?.pending)))return e;let n={text:t,metadata:{purpose:"output"}},r=e.findIndex(e=>"system"===e.role);if(r<0&&(r=e.map(e=>e.role).lastIndexOf("user")),r<0)return e;let o={...e[r],content:[...e[r].content]},u=o.content.findIndex(e=>e.metadata?.purpose==="output"&&e.metadata?.pending);u>0?o.content.splice(u,1,n):o.content.push(n);let a=[...e];return a.splice(r,1,o),a}let v=[d.jsonFormatter,l.arrayFormatter,f.textFormatter,p.enumFormatter,m.jsonlFormatter];function A(e){for(let t of v)h(e,{name:t.name,...t.config},t.handler)}},17676,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={GenerateResponseChunk:()=>d};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848),p=e.r(83132);class d{index;role;content;custom;previousChunks;parser;constructor(e,t){this.content=e.content||[],this.custom=e.custom,this.previousChunks=t.previousChunks?[...t.previousChunks]:void 0,this.index=t.index,this.role=t.role,this.parser=t.parser}get text(){return this.content.map(e=>e.text||"").join("")}get reasoning(){return this.content.map(e=>e.reasoning||"").join("")}get accumulatedText(){return this.previousText+this.text}get previousText(){if(!this.previousChunks)throw new l.GenkitError({status:"FAILED_PRECONDITION",message:"Cannot compose accumulated text without previous chunks."});return this.previousChunks?.map(e=>e.content.map(e=>e.text||"").join("")).join("")}get media(){return this.content.find(e=>e.media)?.media||null}get data(){return this.content.find(e=>e.data)?.data}get toolRequests(){return this.content.filter(e=>!!e.toolRequest)}get output(){return this.parser?this.parser(this):this.data||(0,p.extractJson)(this.accumulatedText)}toJSON(){let e={role:this.role,index:this.index,content:this.content};return this.custom&&(e.custom=this.custom),e}}},8399,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={CandidateErrorSchema:()=>w,CandidateSchema:()=>F,FinishReasonSchema:()=>C,GenerateActionOptionsSchema:()=>k,GenerateActionOutputConfig:()=>x,GenerateRequestSchema:()=>b,GenerateResponseChunkSchema:()=>S,GenerateResponseSchema:()=>z,GenerationCommonConfigDescriptions:()=>g,GenerationCommonConfigSchema:()=>y,GenerationUsageSchema:()=>E,MessageSchema:()=>f,ModelInfoSchema:()=>h,ModelRequestSchema:()=>A,ModelResponseChunkSchema:()=>O,ModelResponseSchema:()=>_,OutputConfigSchema:()=>v,PartSchema:()=>d,RoleSchema:()=>m,ToolDefinitionSchema:()=>D};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848),p=e.r(39771);let d=l.z.union([p.TextPartSchema,p.MediaPartSchema,p.ToolRequestPartSchema,p.ToolResponsePartSchema,p.DataPartSchema,p.CustomPartSchema,p.ReasoningPartSchema,p.ResourcePartSchema]),m=l.z.enum(["system","user","model","tool"]),f=l.z.object({role:m,content:l.z.array(d),metadata:l.z.record(l.z.unknown()).optional()}),h=l.z.object({versions:l.z.array(l.z.string()).optional(),label:l.z.string().optional(),configSchema:l.z.record(l.z.any()).optional(),supports:l.z.object({multiturn:l.z.boolean().optional(),media:l.z.boolean().optional(),tools:l.z.boolean().optional(),systemRole:l.z.boolean().optional(),output:l.z.array(l.z.string()).optional(),contentType:l.z.array(l.z.string()).optional(),context:l.z.boolean().optional(),constrained:l.z.enum(["none","all","no-tools"]).optional(),toolChoice:l.z.boolean().optional()}).optional(),stage:l.z.enum(["featured","stable","unstable","legacy","deprecated"]).optional()}),D=l.z.object({name:l.z.string(),description:l.z.string(),inputSchema:l.z.record(l.z.any()).describe("Valid JSON Schema representing the input of the tool.").nullish(),outputSchema:l.z.record(l.z.any()).describe("Valid JSON Schema describing the output of the tool.").nullish(),metadata:l.z.record(l.z.any()).describe("additional metadata for this tool definition").optional()}),g={temperature:"Controls the degree of randomness in token selection. A lower value is good for a more predictable response. A higher value leads to more diverse or unexpected results.",maxOutputTokens:"The maximum number of tokens to include in the response.",topK:"The maximum number of tokens to consider when sampling.",topP:"Decides how many possible words to consider. A higher value means that the model looks at more possible words, even the less likely ones, which makes the generated text more diverse."},y=l.z.object({version:l.z.string().describe("A specific version of a model family, e.g. `gemini-2.0-flash` for the `googleai` family.").optional(),temperature:l.z.number().describe(g.temperature).optional(),maxOutputTokens:l.z.number().describe(g.maxOutputTokens).optional(),topK:l.z.number().describe(g.topK).optional(),topP:l.z.number().describe(g.topP).optional(),stopSequences:l.z.array(l.z.string()).max(5).describe("Set of character sequences (up to 5) that will stop output generation.").optional()}).passthrough(),v=l.z.object({format:l.z.string().optional(),schema:l.z.record(l.z.any()).optional(),constrained:l.z.boolean().optional(),contentType:l.z.string().optional()}),A=l.z.object({messages:l.z.array(f),config:l.z.any().optional(),tools:l.z.array(D).optional(),toolChoice:l.z.enum(["auto","required","none"]).optional(),output:v.optional(),docs:l.z.array(p.DocumentDataSchema).optional()}),b=A.extend({candidates:l.z.number().optional()}),E=l.z.object({inputTokens:l.z.number().optional(),outputTokens:l.z.number().optional(),totalTokens:l.z.number().optional(),inputCharacters:l.z.number().optional(),outputCharacters:l.z.number().optional(),inputImages:l.z.number().optional(),outputImages:l.z.number().optional(),inputVideos:l.z.number().optional(),outputVideos:l.z.number().optional(),inputAudioFiles:l.z.number().optional(),outputAudioFiles:l.z.number().optional(),custom:l.z.record(l.z.number()).optional(),thoughtsTokens:l.z.number().optional(),cachedContentTokens:l.z.number().optional()}),C=l.z.enum(["stop","length","blocked","interrupted","other","unknown"]),F=l.z.object({index:l.z.number(),message:f,usage:E.optional(),finishReason:C,finishMessage:l.z.string().optional(),custom:l.z.unknown()}),w=l.z.object({index:l.z.number(),code:l.z.enum(["blocked","other","unknown"]),message:l.z.string().optional()}),_=l.z.object({message:f.optional(),finishReason:C,finishMessage:l.z.string().optional(),latencyMs:l.z.number().optional(),usage:E.optional(),custom:l.z.unknown(),raw:l.z.unknown(),request:b.optional(),operation:l.OperationSchema.optional()}),z=_.extend({candidates:l.z.array(F).optional(),finishReason:C.optional()}),O=l.z.object({role:m.optional(),index:l.z.number().optional(),content:l.z.array(d),custom:l.z.unknown().optional(),aggregated:l.z.boolean().optional()}),S=O,x=l.z.object({format:l.z.string().optional(),contentType:l.z.string().optional(),instructions:l.z.union([l.z.boolean(),l.z.string()]).optional(),jsonSchema:l.z.any().optional(),constrained:l.z.boolean().optional()}),k=l.z.object({model:l.z.string(),docs:l.z.array(p.DocumentDataSchema).optional(),messages:l.z.array(f),tools:l.z.array(l.z.string()).optional(),resources:l.z.array(l.z.string()).optional(),toolChoice:l.z.enum(["auto","required","none"]).optional(),config:l.z.any().optional(),output:x.optional(),resume:l.z.object({respond:l.z.array(p.ToolResponsePartSchema).optional(),restart:l.z.array(p.ToolRequestPartSchema).optional(),metadata:l.z.record(l.z.any()).optional()}).optional(),returnToolRequests:l.z.boolean().optional(),maxTurns:l.z.number().optional(),stepName:l.z.string().optional()})},74096,(e,t,n)=>{t.exports=e.x("node:perf_hooks",()=>require("node:perf_hooks"))},22703,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={CONTEXT_PREFACE:()=>g,TEST_ONLY:()=>b,augmentWithContext:()=>v,downloadRequestMedia:()=>f,fallback:()=>w,retry:()=>F,simulateConstrainedGeneration:()=>_,simulateSystemPrompt:()=>D,validateSupport:()=>h};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848),p=e.r(39771),d=e.r(78425),m=e.r(28761);function f(t){return async(n,r)=>{let{default:o}=await e.A(72331);return r({...n,messages:await Promise.all(n.messages.map(async e=>{let n=await Promise.all(e.content.map(async e=>{if(!e.media||!e.media.url.startsWith("http")||t?.filter&&!t?.filter(e))return e;let n=await o(e.media.url,{size:t?.maxBytes});if(200!==n.status)throw Error(`HTTP error downloading media '${e.media.url}': ${await n.text()}`);let r=e.media.contentType||n.headers.get("content-type")||"";return{media:{contentType:r,url:`data:${r};base64,${Buffer.from(await n.arrayBuffer()).toString("base64")}`}}}));return{...e,content:n}}))})}}function h(e){let t=e.supports||{};return async(n,r)=>{function o(t){throw Error(`Model '${e.name}' does not support ${t}. Request: ${JSON.stringify(n,null,2)}`)}return!1===t.media&&n.messages.some(e=>e.content.some(e=>e.media))&&o("media, but media was provided"),!1===t.tools&&n.tools?.length&&o("tool use, but tools were provided"),!1===t.multiturn&&n.messages.length>1&&o(`multiple messages, but ${n.messages.length} were provided`),r()}}function D(e){let t=e?.preface||"SYSTEM INSTRUCTIONS:\n",n=e?.acknowledgement||"Understood.";return(e,r)=>{let o=[...e.messages];for(let r=0;r<o.length;r++)if("system"===e.messages[r].role){let e=o[r].content;o.splice(r,1,{role:"user",content:[{text:t},...e]},{role:"model",content:[{text:n}]});break}return r({...e,messages:o})}}let g="\n\nUse the following information to complete your task:\n\n",y=(e,t,n)=>{let r="- ";return n?.citationKey?r+=`[${e.metadata[n.citationKey]}]: `:n?.citationKey===void 0&&(r+=`[${e.metadata?.ref||e.metadata?.id||t}]: `),r+=e.text+"\n"};function v(e){let t=void 0===e?.preface?g:e.preface,n=e?.itemTemplate||y;return(r,o)=>{if(!r.docs?.length)return o(r);let u=function(e){for(let t=e.length-1;t>=0;t--)if("user"===e[t].role)return e[t]}(r.messages);if(!u)return o(r);let a=u?.content.findIndex(e=>e.metadata?.purpose==="context"),i=a>=0&&u.content[a];if(i&&!i.metadata?.pending)return o(r);let s=`${t||""}`;return r.docs?.forEach((t,r)=>{s+=n(new p.Document(t),r,e)}),s+="\n",a>=0?u.content[a]={...i,text:s,metadata:{purpose:"context"}}:u.content.push({text:s,metadata:{purpose:"context"}}),o(r)}}let A=setTimeout,b={setRetryTimeout(e){A=e}},E=["UNAVAILABLE","DEADLINE_EXCEEDED","RESOURCE_EXHAUSTED","ABORTED","INTERNAL"],C=["UNAVAILABLE","DEADLINE_EXCEEDED","RESOURCE_EXHAUSTED","ABORTED","INTERNAL","NOT_FOUND","UNIMPLEMENTED"];function F(e={}){let{maxRetries:t=3,statuses:n=E,initialDelayMs:r=1e3,maxDelayMs:o=6e4,backoffFactor:u=2,noJitter:a=!1,onError:i}=e;return async(e,s)=>{let c,p=r;for(let r=0;r<=t;r++)try{return await s(e)}catch(e){if(c=e,r<t){let t=!1;if(e instanceof l.GenkitError?n.includes(e.status)&&(t=!0):t=!0,t){i?.(e,r+1);let t=p;a||(t+=1e3*Math.pow(2,r)*Math.random()),await new Promise(e=>A(e,t)),p=Math.min(p*u,o);continue}}throw e}throw c}}function w(e,t){let{models:n,statuses:r=C,onError:o}=t;return async(t,u)=>{try{return await u(t)}catch(u){if(u instanceof l.GenkitError&&r.includes(u.status)){o?.(u);let a=u;for(let u of n)try{let n=await (0,m.resolveModel)(e.registry,u);return await n.modelAction(t)}catch(e){if(a=e,e instanceof l.GenkitError&&r.includes(e.status)){o?.(e);continue}throw e}throw a}throw u}}}function _(e){return(t,n)=>{let r;return t.output?.constrained&&t.output?.schema&&(r=(e?.instructionsRenderer??(e=>`Output should be in JSON format and conform to the following schema:

\`\`\`
${JSON.stringify(e)}
\`\`\`
`))(t.output?.schema),t={...t,messages:(0,d.injectInstructions)(t.messages,r),output:{...t.output,constrained:!1,format:void 0,contentType:void 0,schema:void 0}}),n(t)}}},28761,(e,t,n)=>{"use strict";let r,o;var u=Object.defineProperty,a=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,c=(e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of i(t))s.call(e,o)||o===n||u(e,o,{get:()=>t[o],enumerable:!(r=a(t,o))||r.enumerable});return e},l={},p={CustomPartSchema:()=>g.CustomPartSchema,DataPartSchema:()=>g.DataPartSchema,MediaPartSchema:()=>g.MediaPartSchema,TextPartSchema:()=>g.TextPartSchema,ToolRequestPartSchema:()=>g.ToolRequestPartSchema,ToolResponsePartSchema:()=>g.ToolResponsePartSchema,backgroundModel:()=>w,defineBackgroundModel:()=>F,defineGenerateAction:()=>A.defineGenerateAction,defineModel:()=>C,getBasicUsageStats:()=>O,model:()=>b,modelActionMetadata:()=>z,modelRef:()=>function e(t){let n=t.name;t.namespace&&!n.startsWith(t.namespace+"/")&&(n=`${t.namespace}/${n}`);let r={...t,name:n};return r.withConfig=r=>e({...t,name:n,config:r}),r.withVersion=r=>e({...t,name:n,version:r}),r},resolveModel:()=>x,simulateConstrainedGeneration:()=>v.simulateConstrainedGeneration};for(var d in p)u(l,d,{get:p[d],enumerable:!0});t.exports=c(u({},"__esModule",{value:!0}),l);var m=e.r(28848),f=e.r(63041),h=e.r(20121),D=e.r(74096),g=e.r(39771),y=e.r(8399),v=e.r(22703),A=e.r(79351);function b(e,t){let n=(0,m.action)(E(e),(e,n)=>{let r=D.performance.now();return t(e,n).then(e=>({...e,latencyMs:D.performance.now()-r}))});return Object.assign(n,{__configSchema:e.configSchema||m.z.unknown()}),n}function E(e){let t=e.label||e.name,n=_(e);return{actionType:"model",name:e.name,description:t,inputSchema:y.GenerateRequestSchema,outputSchema:y.GenerateResponseSchema,metadata:{model:{label:t,customOptions:e.configSchema?(0,h.toJsonSchema)({schema:e.configSchema}):void 0,versions:e.versions,supports:e.supports}},use:n}}function C(e,t,n){let r=(0,m.defineAction)(e,E(t),(e,r)=>{let o=D.performance.now();return n(e,"v2"===t.apiVersion?r:r.streamingRequested?r.sendChunk:void 0).then(e=>({...e,latencyMs:D.performance.now()-o}))});return Object.assign(r,{__configSchema:t.configSchema||m.z.unknown()}),r}function F(e,t){let n=w(t);return(0,m.registerBackgroundAction)(e,n),n}function w(e){let t=e.label||e.name,n=_(e),r=(0,m.backgroundAction)({actionType:"background-model",name:e.name,description:t,inputSchema:y.GenerateRequestSchema,outputSchema:y.GenerateResponseSchema,metadata:{model:{label:t,customOptions:e.configSchema?(0,h.toJsonSchema)({schema:e.configSchema}):void 0,versions:e.versions,supports:e.supports}},use:n,async start(t){let n=D.performance.now(),r=await e.start(t);return Object.assign(r,{latencyMs:D.performance.now()-n}),r},check:async t=>e.check(t),cancel:e.cancel?async t=>{if(!e.cancel)throw new m.GenkitError({status:"UNIMPLEMENTED",message:"cancel not implemented"});return e.cancel(t)}:void 0});return Object.assign(r,{__configSchema:e.configSchema||m.z.unknown()}),r}function _(e){let t=e.use||[];e?.supports?.context||t.push((0,v.augmentWithContext)());let n=(0,v.simulateConstrainedGeneration)();return t.push((t,r)=>!e?.supports?.constrained||e?.supports?.constrained==="none"||e?.supports?.constrained==="no-tools"&&(t.tools?.length??0)>0?n(t,r):r(t)),t}function z({name:e,info:t,configSchema:n,background:r}){return{actionType:r?"background-model":"model",name:e,inputJsonSchema:(0,h.toJsonSchema)({schema:y.GenerateRequestSchema}),outputJsonSchema:r?(0,h.toJsonSchema)({schema:m.OperationSchema}):(0,h.toJsonSchema)({schema:y.GenerateResponseSchema}),metadata:{model:{...t,customOptions:n?(0,h.toJsonSchema)({schema:n}):void 0}}}}function O(e,t){let n=S(e.flatMap(e=>e.content)),r=S(Array.isArray(t)?t.flatMap(e=>e.message.content):t.content);return{inputCharacters:n.characters,inputImages:n.images,inputVideos:n.videos,inputAudioFiles:n.audio,outputCharacters:r.characters,outputImages:r.images,outputVideos:r.videos,outputAudioFiles:r.audio}}function S(e){return e.reduce((e,t)=>{let n=t.media?.contentType?.startsWith("image")||t.media?.url?.startsWith("data:image"),r=t.media?.contentType?.startsWith("video")||t.media?.url?.startsWith("data:video"),o=t.media?.contentType?.startsWith("audio")||t.media?.url?.startsWith("data:audio");return{characters:e.characters+(t.text?.length||0),images:e.images+ +!!n,videos:e.videos+ +!!r,audio:e.audio+ +!!o}},{characters:0,images:0,videos:0,audio:0})}async function x(e,t,n){let r,o;if(t||(t=await e.lookupValue("defaultModel","defaultModel")),!t)throw new m.GenkitError({status:"INVALID_ARGUMENT",message:"Must supply a `model` to `generate()` calls."});if("string"==typeof t)o=t,r={modelAction:await k(e,t)};else if(t.hasOwnProperty("__action"))o=t.__action.name,r={modelAction:t};else{let n=t;o=n.name,r={modelAction:await k(e,n.name),config:{...n.config},version:n.version}}if(!r.modelAction)throw new m.GenkitError({status:"NOT_FOUND",message:`Model '${o}' not found`});return n?.warnDeprecated&&r.modelAction.__action.metadata?.model?.stage==="deprecated"&&f.logger.warn(`Model '${r.modelAction.__action.name}' is deprecated and may be removed in a future release.`),r}async function k(e,t){return await e.lookupAction(`/model/${t}`)||await e.lookupAction(`/background-model/${t}`)}r=e.r(8399),o=t.exports,c(l,r,"default"),o&&c(o,r,"default")},23728,(e,t,n)=>{!function(n,r){if("function"==typeof define&&define.amd){let t;void 0!==(t=r())&&e.v(t)}else t.exports?t.exports=r():n.UriTemplate=r()}(e.e,function(){var e={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},t={"*":!0};function n(e){return encodeURI(e).replace(/%25[0-9][0-9]/g,function(e){return"%"+e.substring(3)})}function r(e){return encodeURIComponent(e=e.replace(/%../g,""))===e}function o(u){if(!(this instanceof o))return new o(u);for(var a=u.split("{"),i=[a.shift()],s=[],c=[],l=[],p=[];a.length>0;){var d=a.shift(),m=d.split("}")[0],f=d.substring(m.length+1),h=function(o){var u="";e[o.charAt(0)]&&(u=o.charAt(0),o=o.substring(1));var a="",i="",s=!0,c=!1,l=!1;"+"==u?s=!1:"."==u?(i=".",a="."):"/"==u?(i="/",a="/"):"#"==u?(i="#",s=!1):";"==u?(i=";",a=";",c=!0,l=!0):"?"==u?(i="?",a="&",c=!0):"&"==u&&(i="&",a="&",c=!0);for(var p=[],d=o.split(","),m=[],f={},h=0;h<d.length;h++){var D=d[h],g=null;if(-1!=D.indexOf(":")){var y=D.split(":");D=y[0],g=parseInt(y[1])}for(var v={};t[D.charAt(D.length-1)];)v[D.charAt(D.length-1)]=!0,D=D.substring(0,D.length-1);var A={truncate:g,name:D,suffices:v};m.push(A),f[D]=A,p.push(D)}return{varNames:p,prefix:i,substitution:function(e){for(var t="",r=0,o=0;o<m.length;o++){var u=m[o],p=e(u.name);if(null==p||Array.isArray(p)&&0==p.length||"object"==typeof p&&0==Object.keys(p).length){r++;continue}if(o==r?t+=i:t+=a||",",Array.isArray(p)){c&&(t+=u.name+"=");for(var d=0;d<p.length;d++)d>0&&(t+=u.suffices["*"]&&a||",",u.suffices["*"]&&c&&(t+=u.name+"=")),t+=s?encodeURIComponent(p[d]).replace(/!/g,"%21"):n(p[d])}else if("object"==typeof p){c&&!u.suffices["*"]&&(t+=u.name+"=");var f=!0;for(var h in p)f||(t+=u.suffices["*"]&&a||","),f=!1,t+=s?encodeURIComponent(h).replace(/!/g,"%21"):n(h),t+=u.suffices["*"]?"=":",",t+=s?encodeURIComponent(p[h]).replace(/!/g,"%21"):n(p[h])}else c&&(t+=u.name,l&&""==p||(t+="=")),null!=u.truncate&&(p=p.substring(0,u.truncate)),t+=s?encodeURIComponent(p).replace(/!/g,"%21"):n(p)}return t},unSubstitution:function(e,t,n){if(i&&(e=e.substring(i.length)),1==m.length&&m[0].suffices["*"]){for(var o=m[0],u=o.name,l=o.suffices["*"]?e.split(a||","):[e],p=s&&-1!=e.indexOf("="),d=1;d<l.length;d++){var e=l[d];p&&-1==e.indexOf("=")&&(l[d-1]+=(a||",")+e,l.splice(d,1),d--)}for(var d=0;d<l.length;d++){var e=l[d];s&&-1!=e.indexOf("=")&&(p=!0);var h=e.split(",");1==h.length?l[d]=h[0]:l[d]=h}if(c||p){for(var D=t[u]||{},g=0;g<l.length;g++){var y=e;if(!c||y){if("string"==typeof l[g]){var e=l[g],v=e.split("=",1)[0],e=e.substring(v.length+1);if(s){if(n&&!r(e))return;e=decodeURIComponent(e)}y=e}else{var e=l[g][0],v=e.split("=",1)[0],e=e.substring(v.length+1);if(s){if(n&&!r(e))return;e=decodeURIComponent(e)}l[g][0]=e,y=l[g]}if(s){if(n&&!r(v))return;v=decodeURIComponent(v)}void 0!==D[v]?Array.isArray(D[v])?D[v].push(y):D[v]=[D[v],y]:D[v]=y}}1==Object.keys(D).length&&void 0!==D[u]?t[u]=D[u]:t[u]=D}else{if(s)for(var g=0;g<l.length;g++){var h=l[g];if(Array.isArray(h))for(var A=0;A<h.length;A++){if(n&&!r(h[A]))return;h[A]=decodeURIComponent(h[A])}else{if(n&&!r(h))return;l[g]=decodeURIComponent(h)}}void 0!==t[u]?Array.isArray(t[u])?t[u]=t[u].concat(l):t[u]=[t[u]].concat(l):1!=l.length||o.suffices["*"]?t[u]=l:t[u]=l[0]}}else{for(var l=1==m.length?[e]:e.split(a||","),b={},d=0;d<l.length;d++){for(var E=0;E<m.length-1&&E<d&&!m[E].suffices["*"];E++);if(E==d){b[d]=d;continue}for(var C=m.length-1;C>0&&m.length-C<l.length-d&&!m[C].suffices["*"];C--);if(m.length-C==l.length-d){b[d]=C;continue}b[d]=E}for(var d=0;d<l.length;d++){var e=l[d];if(e||!c){var h=e.split(","),p=!1;if(c){var e=h[0],u=e.split("=",1)[0],e=e.substring(u.length+1);h[0]=e;var o=f[u]||m[0]}else var o=m[b[d]],u=o.name;for(var g=0;g<h.length;g++)if(s){if(n&&!r(h[g]))return;h[g]=decodeURIComponent(h[g])}(c||o.suffices["*"])&&void 0!==t[u]?Array.isArray(t[u])?t[u]=t[u].concat(h):t[u]=[t[u]].concat(h):1!=h.length||o.suffices["*"]?t[u]=h:t[u]=h[0]}}}return 1}}}(m);c.push(h.substitution),l.push(h.unSubstitution),s.push(h.prefix),i.push(f),p=p.concat(h.varNames)}this.fill=function(e){if(e&&"function"!=typeof e){var t=e;e=function(e){return t[e]}}for(var n=i[0],r=0;r<c.length;r++)n+=(0,c[r])(e),n+=i[r+1];return n},this.fromUri=function(e,t){t=t||{};for(var n={},r=0;r<i.length;r++){var o=i[r];if(e.substring(0,o.length)!==o)return;if(e=e.substring(o.length),r>=i.length-1)if(""!=e)return;else break;var u=s[r];if(!u||e.substring(0,u.length)===u){for(var a=i[r+1],c=r;;){if(c==i.length-2){var p=e.substring(e.length-a.length);if(p!==a)return;var d=e.substring(0,e.length-a.length);e=p}else if(a){var m=e.indexOf(a),d=e.substring(0,m);e=e.substring(m)}else if(s[c+1]){var m=e.indexOf(s[c+1]);-1===m&&(m=e.length);var d=e.substring(0,m);e=e.substring(m)}else if(i.length>c+2){a=i[++c+1];continue}else{var d=e;e=""}break}if(!l[r](d,n,t.strict))return}}return n},this.varNames=p,this.template=u}return o.prototype={toString:function(){return this.template},fillFromObject:function(e){return this.fill(e)},test:function(e,t){return!!this.fromUri(e,t)}},o})},55837,(e,t,n)=>{"use strict";let r,o;var u=Object.create,a=Object.defineProperty,i=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,c=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,p=(e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of s(t))l.call(e,o)||o===n||a(e,o,{get:()=>t[o],enumerable:!(r=i(t,o))||r.enumerable});return e},d={},m={ResourceInputSchema:()=>y,ResourceOutputSchema:()=>v,defineResource:()=>E,dynamicResource:()=>_,findMatchingResource:()=>C,isDynamicResourceAction:()=>F,lookupResourceByName:()=>b,resolveResources:()=>A,resource:()=>w};for(var f in m)a(d,f,{get:m[f],enumerable:!0});t.exports=p(a({},"__esModule",{value:!0}),d);var h=e.r(28848),D=(o=null!=(r=e.r(23728))?u(c(r)):{},p(r&&r.__esModule?o:a(o,"default",{value:r,enumerable:!0}),r)),g=e.r(8399);let y=h.z.object({uri:h.z.string()}),v=h.z.object({content:h.z.array(g.PartSchema)});async function A(e,t){return t&&0!==t.length?await Promise.all(t.map(async t=>{if("string"==typeof t)return await b(e,t);if((0,h.isAction)(t))return t;throw Error("Resources must be strings, or actions")})):[]}async function b(e,t){let n=await e.lookupAction(t)||await e.lookupAction(`/resource/${t}`)||await e.lookupAction(`/dynamic-action-provider/${t}`);if(!n)throw Error(`Resource ${t} not found`);return n}function E(e,t,n){let r=_(t,n);return r.matches=z(t.uri,t.template),e.registerAction("resource",r),r}async function C(e,t,n){for(let e of t)if(e.matches(n))return e;for(let t of Object.keys(await e.listResolvableActions()))if(t.startsWith("/resource/")){let r=await e.lookupAction(t);if(r.matches(n))return r}}function F(e){return(0,h.isAction)(e)&&!e.__registry}function w(e,t){return _(e,t)}function _(e,t){let n=e.uri??e.template;if(!n)throw new h.GenkitError({status:"INVALID_ARGUMENT",message:"must specify either url or template options"});let r=z(e.uri,e.template),o=(0,h.action)({actionType:"resource",name:e.name??n,description:e.description,inputSchema:y,outputSchema:v,metadata:{resource:{uri:e.uri,template:e.template},...e.metadata,type:"resource",dynamic:!0}},async(o,u)=>{if(!r(o))throw new h.GenkitError({status:"INVALID_ARGUMENT",message:`input ${o} did not match template ${n}`});let a=await t(o,u);return a.content.map(t=>(t.metadata||(t.metadata={}),t.metadata?.resource?!t.metadata.resource.parent&&(t.metadata.resource.parent={uri:o.uri},e.template&&(t.metadata.resource.parent.template=e.template)):(t.metadata.resource={uri:o.uri},e.template&&(t.metadata.resource.template=e.template)),t)),a});return o.matches=r,o.attach=e=>o,o}function z(e,t){if(e)return t=>t.uri===e;if(t){let e=(0,D.default)(t);return t=>void 0!==e.fromUri(t.uri)}throw new h.GenkitError({status:"INVALID_ARGUMENT",message:"must specify either url or template options"})}},11841,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={Message:()=>p};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(83132);class p{role;content;metadata;parser;static parseData(e,t="user"){return"string"==typeof e?{role:t,content:[{text:e}]}:{...e,content:p.parseContent(e.content)}}static parse(e){return new p(p.parseData(e))}static parseContent(e){return"string"==typeof e?[{text:e}]:Array.isArray(e)?e.map(e=>"string"==typeof e?{text:e}:e):[e]}constructor(e,t){this.role=e.role,this.content=e.content,this.metadata=e.metadata,this.parser=t?.parser}get output(){return this.parser?.(this)||this.data||(0,l.extractJson)(this.text)}toolResponseParts(){return this.content.filter(e=>!!e.toolResponse)}get text(){return this.content.map(e=>e.text||"").join("")}get reasoning(){return this.content.map(e=>e.reasoning||"").join("")}get media(){return this.content.find(e=>e.media)?.media||null}get data(){return this.content.find(e=>e.data)?.data}get toolRequests(){return this.content.filter(e=>!!e.toolRequest)}get interrupts(){return this.toolRequests.filter(e=>!!e.metadata?.interrupt)}toJSON(){let e={role:this.role,content:[...this.content]};return this.metadata&&(e.metadata=this.metadata),e}}},66680,(e,t,n)=>{t.exports=e.x("node:crypto",()=>require("node:crypto"))},79403,e=>{"use strict";let t,n;e.s([],55276),e.i(55276);let r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i,o=function(e){return"string"==typeof e&&r.test(e)},u=function(e){let t;if(!o(e))throw TypeError("Invalid UUID");let n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/0x10000000000&255,n[11]=t/0x100000000&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n},a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function i(e,t=0){return(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase()}var s=e.i(66680);let c=new Uint8Array(256),l=c.length;function p(){return l>c.length-16&&(s.default.randomFillSync(c),l=0),c.slice(l,l+=16)}let d=0,m=0,f=function(e,r,o){let u=r&&o||0,a=r||Array(16),s=(e=e||{}).node,c=e.clockseq;if(e._v6||(s||(s=t),null==c&&(c=n)),null==s||null==c){let r=e.random||(e.rng||p)();null==s&&(s=[r[0],r[1],r[2],r[3],r[4],r[5]],t||e._v6||(s[0]|=1,t=s)),null==c&&(c=(r[6]<<8|r[7])&16383,void 0!==n||e._v6||(n=c))}let l=void 0!==e.msecs?e.msecs:Date.now(),f=void 0!==e.nsecs?e.nsecs:m+1,h=l-d+(f-m)/1e4;if(h<0&&void 0===e.clockseq&&(c=c+1&16383),(h<0||l>d)&&void 0===e.nsecs&&(f=0),f>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");d=l,m=f,n=c;let D=((0xfffffff&(l+=122192928e5))*1e4+f)%0x100000000;a[u++]=D>>>24&255,a[u++]=D>>>16&255,a[u++]=D>>>8&255,a[u++]=255&D;let g=l/0x100000000*1e4&0xfffffff;a[u++]=g>>>8&255,a[u++]=255&g,a[u++]=g>>>24&15|16,a[u++]=g>>>16&255,a[u++]=c>>>8|128,a[u++]=255&c;for(let e=0;e<6;++e)a[u+e]=s[e];return r||i(a)};function h(e){let t=function(e,t=!1){return Uint8Array.of((15&e[6])<<4|e[7]>>4&15,(15&e[7])<<4|(240&e[4])>>4,(15&e[4])<<4|(240&e[5])>>4,(15&e[5])<<4|(240&e[0])>>4,(15&e[0])<<4|(240&e[1])>>4,(15&e[1])<<4|(240&e[2])>>4,96|15&e[2],e[3],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}("string"==typeof e?u(e):e);return"string"==typeof e?i(t):t}function D(e,t,n){function r(e,r,o,a){var s;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));let t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=u(r)),(null==(s=r)?void 0:s.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+e.length);if(c.set(r),c.set(e,r.length),(c=n(c))[6]=15&c[6]|t,c[8]=63&c[8]|128,o){a=a||0;for(let e=0;e<16;++e)o[a+e]=c[e];return o}return i(c)}try{r.name=e}catch(e){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}let g=D("v3",48,function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),s.default.createHash("md5").update(e).digest()}),y={randomUUID:s.default.randomUUID},v=D("v5",80,function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),s.default.createHash("sha1").update(e).digest()});function A(e={},t,n=0){let r=f({...e,_v6:!0},new Uint8Array(16));if(r=h(r),t){for(let e=0;e<16;e++)t[n+e]=r[e];return t}return i(r)}function b(e){var t;let n=(t="string"==typeof e?u(e):e,Uint8Array.of((15&t[3])<<4|t[4]>>4&15,(15&t[4])<<4|(240&t[5])>>4,(15&t[5])<<4|15&t[6],t[7],(15&t[1])<<4|(240&t[2])>>4,(15&t[2])<<4|(240&t[3])>>4,16|(240&t[0])>>4,(15&t[0])<<4|(240&t[1])>>4,t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]));return"string"==typeof e?i(n):n}let E=null,C=null,F=0;e.s(["MAX",0,"ffffffff-ffff-ffff-ffff-ffffffffffff","NIL",0,"00000000-0000-0000-0000-000000000000","parse",0,u,"stringify",0,function(e,t=0){let n=i(e,t);if(!o(n))throw TypeError("Stringified UUID is invalid");return n},"v1",0,f,"v1ToV6",()=>h,"v3",0,g,"v4",0,function(e,t,n){if(y.randomUUID&&!t&&!e)return y.randomUUID();let r=(e=e||{}).random||(e.rng||p)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return i(r)},"v5",0,v,"v6",()=>A,"v6ToV1",()=>b,"v7",0,function(e,t,n){e=e||{};let r=t&&n||0,o=t||new Uint8Array(16),u=e.random||(e.rng||p)(),a=void 0!==e.msecs?e.msecs:Date.now(),s=void 0!==e.seq?e.seq:null,c=C,l=E;return a>F&&void 0===e.msecs&&(F=a,null!==s&&(c=null,l=null)),null!==s&&(s>0x7fffffff&&(s=0x7fffffff),c=s>>>19&4095,l=524287&s),(null===c||null===l)&&(c=(c=127&u[6])<<8|u[7],l=(l=(l=63&u[8])<<8|u[9])<<5|u[10]>>>3),a+1e4>F&&null===s?++l>524287&&(l=0,++c>4095&&(c=0,F++)):F=a,C=c,E=l,o[r++]=F/0x10000000000&255,o[r++]=F/0x100000000&255,o[r++]=F/0x1000000&255,o[r++]=F/65536&255,o[r++]=F/256&255,o[r++]=255&F,o[r++]=c>>>4&15|112,o[r++]=255&c,o[r++]=l>>>13&63|128,o[r++]=l>>>5&255,o[r++]=l<<3&255|7&u[10],o[r++]=u[11],o[r++]=u[12],o[r++]=u[13],o[r++]=u[14],o[r++]=u[15],t||i(o)},"validate",0,o,"version",0,function(e){if(!o(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}],79403)},29790,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={CommonRetrieverOptionsSchema:()=>F,Document:()=>m.Document,DocumentDataSchema:()=>m.DocumentDataSchema,IndexerInfoSchema:()=>_,RetrieverInfoSchema:()=>g,defineIndexer:()=>A,defineRetriever:()=>y,defineSimpleRetriever:()=>O,index:()=>C,indexer:()=>b,indexerRef:()=>z,retrieve:()=>E,retriever:()=>v,retrieverRef:()=>w};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848),p=e.r(20121),d=e.r(39771),m=e.r(39771);let f=l.z.object({query:d.DocumentDataSchema,options:l.z.any().optional()}),h=l.z.object({documents:l.z.array(d.DocumentDataSchema)}),D=l.z.object({documents:l.z.array(d.DocumentDataSchema),options:l.z.any().optional()}),g=l.z.object({label:l.z.string().optional(),supports:l.z.object({media:l.z.boolean().optional()}).optional()});function y(e,t,n){let r=v(t,n);return e.registerAction("retriever",r),r}function v(e,t){var n;return(n=(0,l.action)({actionType:"retriever",name:e.name,inputSchema:e.configSchema?f.extend({options:e.configSchema.optional()}):f,outputSchema:h,metadata:{type:"retriever",info:e.info,retriever:{customOptions:e.configSchema?(0,p.toJsonSchema)({schema:e.configSchema}):void 0}}},e=>t(new d.Document(e.query),e.options))).__configSchema=e.configSchema,n}function A(e,t,n){let r=b(t,n);return e.registerAction("indexer",r),r}function b(e,t){var n;return(n=(0,l.action)({actionType:"indexer",name:e.name,inputSchema:e.configSchema?D.extend({options:e.configSchema.optional()}):D,outputSchema:l.z.void(),metadata:{type:"indexer",embedderInfo:e.embedderInfo,indexer:{customOptions:e.configSchema?(0,p.toJsonSchema)({schema:e.configSchema}):void 0}}},e=>t(e.documents.map(e=>new d.Document(e)),e.options))).__configSchema=e.configSchema,n}async function E(e,t){let n;if(!(n="string"==typeof t.retriever?await e.lookupAction(`/retriever/${t.retriever}`):Object.hasOwnProperty.call(t.retriever,"info")?await e.lookupAction(`/retriever/${t.retriever.name}`):t.retriever))throw Error("Unable to resolve the retriever");return(await n({query:"string"==typeof t.query?d.Document.fromText(t.query):t.query,options:t.options})).documents.map(e=>new d.Document(e))}async function C(e,t){let n;if(!(n="string"==typeof t.indexer?await e.lookupAction(`/indexer/${t.indexer}`):Object.hasOwnProperty.call(t.indexer,"info")?await e.lookupAction(`/indexer/${t.indexer.name}`):t.indexer))throw Error("Unable to utilize the provided indexer");return await n({documents:t.documents,options:t.options})}let F=l.z.object({k:l.z.number().describe("Number of documents to retrieve").optional()});function w(e){return{...e}}let _=g;function z(e){return{...e}}function O(e,t,n){return y(e,{name:t.name,configSchema:t.configSchema},async(e,r)=>({documents:(await n(e,r)).map(e=>{let n=function(e,t){if(!e)throw new l.GenkitError({status:"INVALID_ARGUMENT",message:"Items returned from simple retriever must be non-null."});if("string"==typeof e)return d.Document.fromText(e);if("function"==typeof t.content){let n=t.content(e);return"string"==typeof n?d.Document.fromText(n):new d.Document({content:n})}if("string"==typeof t.content&&"object"==typeof e)return d.Document.fromText(e[t.content]);throw new l.GenkitError({status:"INVALID_ARGUMENT",message:`Cannot convert item to document without content option. Item: ${JSON.stringify(e)}`})}(e,t);return"string"!=typeof e&&(n.metadata=function(e,t){if("string"!=typeof e){if(Array.isArray(t.metadata)&&"object"==typeof e){let n={};return t.metadata.forEach(t=>n[t]=e[t]),n}if("function"==typeof t.metadata)return t.metadata(e);if(!t.metadata&&"object"==typeof e){let n={...e};return"string"==typeof t.content&&delete n[t.content],n}throw new l.GenkitError({status:"INVALID_ARGUMENT",message:`Unable to extract metadata from item with supplied options. Item: ${JSON.stringify(e)}`})}}(e,t)),n})}))}},56435,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={CommonRerankerOptionsSchema:()=>C,RankedDocument:()=>D,RankedDocumentDataSchema:()=>h,RankedDocumentMetadataSchema:()=>f,RerankerInfoSchema:()=>v,defineReranker:()=>A,rerank:()=>E,reranker:()=>b,rerankerRef:()=>F};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848),p=e.r(20121),d=e.r(39771),m=e.r(29790);let f=l.z.object({score:l.z.number()}).passthrough(),h=l.z.object({content:l.z.array(d.PartSchema),metadata:f});class D extends m.Document{content;metadata;constructor(e){super(e),this.content=e.content,this.metadata=e.metadata}score(){return this.metadata.score}}let g=l.z.object({query:m.DocumentDataSchema,documents:l.z.array(m.DocumentDataSchema),options:l.z.any().optional()}),y=l.z.object({documents:l.z.array(h)}),v=l.z.object({label:l.z.string().optional(),supports:l.z.object({media:l.z.boolean().optional()}).optional()});function A(e,t,n){let r=b(t,n);return e.registerAction("reranker",r),r}function b(e,t){var n;return(n=(0,l.action)({actionType:"reranker",name:e.name,inputSchema:e.configSchema?g.extend({options:e.configSchema.optional()}):g,outputSchema:y,metadata:{type:"reranker",info:e.info,reranker:{customOptions:e.configSchema?(0,p.toJsonSchema)({schema:e.configSchema}):void 0}}},e=>t(new m.Document(e.query),e.documents.map(e=>new m.Document(e)),e.options))).__configSchema=e.configSchema,n}async function E(e,t){let n;if(!(n="string"==typeof t.reranker?await e.lookupAction(`/reranker/${t.reranker}`):Object.hasOwnProperty.call(t.reranker,"info")?await e.lookupAction(`/reranker/${t.reranker.name}`):t.reranker))throw Error("Unable to resolve the reranker");return(await n({query:"string"==typeof t.query?m.Document.fromText(t.query):t.query,documents:t.documents,options:t.options})).documents.map(e=>new D(e))}let C=l.z.object({k:l.z.number().describe("Number of documents to rerank").optional()});function F(e){return{...e}}},18309,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={LlmResponseSchema:()=>h,LlmStatsSchema:()=>d,ToolCallSchema:()=>f,ToolSchema:()=>m,toToolWireFormat:()=>D};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848),p=e.r(20121);let d=l.z.object({latencyMs:l.z.number().optional(),inputTokenCount:l.z.number().optional(),outputTokenCount:l.z.number().optional()}),m=l.z.object({name:l.z.string(),description:l.z.string().optional(),schema:l.z.any()}),f=l.z.object({toolName:l.z.string(),arguments:l.z.any()}),h=l.z.object({completion:l.z.string(),toolCalls:l.z.array(f).optional(),stats:d});function D(e){if(e)return e.map(e=>({name:e.__action.name,description:e.__action.description,schema:{input:(0,p.toJsonSchema)({schema:e.__action.inputSchema,jsonSchema:e.__action.inputJsonSchema}),output:(0,p.toJsonSchema)({schema:e.__action.outputSchema,jsonSchema:e.__action.outputJsonSchema})}}))}},12216,(e,t,n)=>{"use strict";let r,o;var u=Object.defineProperty,a=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,c=(e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of i(t))s.call(e,o)||o===n||u(e,o,{get:()=>t[o],enumerable:!(r=a(t,o))||r.enumerable});return e},l={},p={BaseDataPointSchema:()=>D.BaseDataPointSchema,Document:()=>f.Document,DocumentDataSchema:()=>f.DocumentDataSchema,EvalStatusEnum:()=>D.EvalStatusEnum,GenerateResponse:()=>g.GenerateResponse,GenerateResponseChunk:()=>g.GenerateResponseChunk,GenerateResponseChunkSchema:()=>v.GenerateResponseChunkSchema,GenerationBlockedError:()=>g.GenerationBlockedError,GenerationCommonConfigSchema:()=>v.GenerationCommonConfigSchema,GenerationResponseError:()=>g.GenerationResponseError,Message:()=>y.Message,MessageSchema:()=>v.MessageSchema,ModelRequestSchema:()=>v.ModelRequestSchema,ModelResponseSchema:()=>v.ModelResponseSchema,PartSchema:()=>v.PartSchema,ResourceInputSchema:()=>E.ResourceInputSchema,ResourceOutputSchema:()=>E.ResourceOutputSchema,RoleSchema:()=>v.RoleSchema,ToolInterruptError:()=>F.ToolInterruptError,asTool:()=>F.asTool,checkOperation:()=>m.checkOperation,defineHelper:()=>A.defineHelper,defineInterrupt:()=>F.defineInterrupt,definePartial:()=>A.definePartial,definePrompt:()=>A.definePrompt,defineResource:()=>E.defineResource,defineTool:()=>F.defineTool,dynamicResource:()=>E.dynamicResource,embed:()=>h.embed,embedderActionMetadata:()=>h.embedderActionMetadata,embedderRef:()=>h.embedderRef,evaluate:()=>D.evaluate,evaluatorRef:()=>D.evaluatorRef,generate:()=>g.generate,generateOperation:()=>g.generateOperation,generateStream:()=>g.generateStream,index:()=>C.index,indexerRef:()=>C.indexerRef,interrupt:()=>F.interrupt,isDynamicResourceAction:()=>E.isDynamicResourceAction,isExecutablePrompt:()=>A.isExecutablePrompt,loadPromptFolder:()=>A.loadPromptFolder,modelActionMetadata:()=>v.modelActionMetadata,modelRef:()=>v.modelRef,prompt:()=>A.prompt,rerank:()=>b.rerank,rerankerRef:()=>b.rerankerRef,resource:()=>E.resource,retrieve:()=>C.retrieve,retrieverRef:()=>C.retrieverRef,tagAsPreamble:()=>g.tagAsPreamble,toGenerateRequest:()=>g.toGenerateRequest};for(var d in p)u(l,d,{get:p[d],enumerable:!0});t.exports=c(u({},"__esModule",{value:!0}),l);var m=e.r(47525),f=e.r(39771),h=e.r(47721),D=e.r(88836),g=e.r(45597),y=e.r(11841),v=e.r(28761),A=e.r(67875),b=e.r(56435),E=e.r(55837),C=e.r(29790),F=e.r(52917);r=e.r(18309),o=t.exports,c(l,r,"default"),o&&c(o,r,"default")},40075,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={Chat:()=>g,MAIN_THREAD:()=>f,SESSION_ID_ATTR:()=>h,THREAD_NAME_ATTR:()=>D};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(11055),p=e.r(93064),d=e.r(12216),m=e.r(95018);let f="main",h=`${p.ATTR_PREFIX}:sessionId`,D=`${p.ATTR_PREFIX}:threadName`;class g{constructor(e,t,n){this.session=e,this.sessionId=n.id,this.threadName=n.thread,this.requestBase=t?.then(e=>{var t,r;let o={...e};if(o&&o.prompt){let e,t=o.prompt;e="string"==typeof t?{role:"user",content:[{text:t}]}:Array.isArray(t)?{role:"user",content:t}:{role:"user",content:[t]},o.messages=[...o.messages??[],e]}return(t=o.messages,t?.find(e=>e.metadata?.preamble))?o.messages=[...(r=o.messages,r?.filter(e=>e.metadata?.preamble)??[]),...y(n.messages)??[],...y(o.messages)??[]]:o.messages=[...n.messages??[],...o.messages??[]],this._messages=o.messages,o}),this._messages=n.messages}requestBase;sessionId;_messages;threadName;async send(e){return(0,m.runWithSession)(this.session.registry,this.session,()=>(0,p.runInNewSpan)(this.session.registry,{metadata:{name:"send"},labels:{[p.SPAN_TYPE_ATTR]:"helper",[h]:this.session.id,[D]:this.threadName}},async t=>{let n,r=v(e);(r.onChunk||r.streamingCallback)&&(n=r.onChunk??r.streamingCallback);let o={...await this.requestBase,messages:this.messages,...r};t.input=r;let u=await (0,d.generate)(this.session.registry,{...o,onChunk:n});return this.requestBase=Promise.resolve({...await this.requestBase,tools:u?.request?.tools?.map(e=>e.name),toolChoice:u?.request?.toolChoice,config:u?.request?.config}),await this.updateMessages(u.messages),t.output=JSON.stringify(u),u}))}sendStream(e){let t=new l.Channel,n=v(e),r=this.send({...n,onChunk:e=>t.send(e)});return r.then(()=>t.close(),e=>t.error(e)),{response:r,stream:t}}get messages(){return this._messages??[]}async updateMessages(e){this._messages=e,await this.session.updateMessages(this.threadName,e)}}function y(e){return e?.filter(e=>!e.metadata?.preamble)}function v(e){return"string"==typeof e||Array.isArray(e)?{prompt:e}:e}},95018,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={Session:()=>f,SessionError:()=>y,getCurrentSession:()=>g,inMemorySessionStore:()=>v,runWithSession:()=>D};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848),p=e.r(79403),d=e.r(40075),m=e.r(12216);class f{constructor(e,t){this.registry=e,this.id=t?.id??(0,p.v4)(),this.sessionData=t?.sessionData??{id:this.id},this.sessionData||(this.sessionData={id:this.id}),this.sessionData.threads||(this.sessionData.threads={}),this.store=t?.store??new A}id;sessionData;store;get state(){return this.sessionData.state}async updateState(e){let t=this.sessionData;t||(t={}),t.state=e,this.sessionData=t,await this.store.save(this.id,t)}async updateMessages(e,t){let n=this.sessionData;n||(n={}),n.threads||(n.threads={}),n.threads[e]=t.map(e=>e.toJSON?e.toJSON():e),this.sessionData=n,await this.store.save(this.id,n)}chat(e,t,n){return D(this.registry,this,()=>{let r,o,u,a=d.MAIN_THREAD;if(e&&("string"==typeof e?a=e:(0,m.isExecutablePrompt)(e)?o=e:r=e),t&&((0,m.isExecutablePrompt)(t)?o=t:r=t),n&&(r=n),o){let e=r;u=o.render(e?.input,e).then(e=>({...e,messages:(0,m.tagAsPreamble)(e?.messages)}))}else{let e={...r},t=[];e.system&&t.push({role:"system",content:m.Message.parseContent(e.system)}),delete e.system,e.messages&&t.push(...e.messages),e.messages=(0,m.tagAsPreamble)(t),u=Promise.resolve(e)}return new d.Chat(this,u,{thread:a,id:this.id,messages:(this.sessionData?.threads&&this.sessionData?.threads[a])??[]})})}run(e){return D(this.registry,this,e)}toJSON(){return this.sessionData}}let h="ai.session";function D(e,t,n){return(0,l.getAsyncContext)().run(h,t,n)}function g(e){return(0,l.getAsyncContext)().getStore(h)}class y extends Error{constructor(e){super(e)}}function v(){return new A}class A{data={};async get(e){return this.data[e]}async save(e,t){this.data[e]=t}}},67875,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={defineHelper:()=>R,definePartial:()=>P,definePrompt:()=>E,isExecutablePrompt:()=>x,isPromptAction:()=>b,loadPromptFolder:()=>k,loadPromptFolderRecursively:()=>B,prompt:()=>$};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848),p=e.r(11055),d=e.r(63041),m=e.r(20121),f=e.r(93064),h=e.r(22734),D=e.r(14747),g=e.r(45597),y=e.r(11841),v=e.r(28761),A=e.r(95018);function b(e){return e.__action.metadata?.type==="prompt"}function E(e,t){return C(e,`${t.name}${t.variant?`.${t.variant}`:""}`,Promise.resolve(t),t.metadata)}function C(e,t,n,r){var o;let u,a={},i=async(t,r)=>await (0,f.runInNewSpan)({metadata:{name:"render",input:t},labels:{[f.SPAN_TYPE_ATTR]:"promptTemplate"}},async o=>{let u,i=[];r={...r};let s=(0,A.getCurrentSession)(e),c=await n;await w(e,s,t,i,c,a,r),await _(e,s,t,i,c,r,a),await z(e,s,t,i,c,a,r),u="function"==typeof c.docs?await c.docs(t,{state:s?.state,context:r?.context||(0,l.getContext)()||{}}):c.docs;let p=(0,l.stripUndefinedProps)({model:c.model,maxTurns:c.maxTurns,messages:i,docs:u,tools:c.tools,returnToolRequests:c.returnToolRequests,toolChoice:c.toolChoice,context:c.context,output:c.output,use:c.use,...(0,l.stripUndefinedProps)(r),config:{...c?.config,...r?.config},metadata:c.metadata?.metadata?{prompt:c.metadata?.metadata}:void 0});return r?.abortSignal&&(p.abortSignal=r.abortSignal),0!==Object.keys(p.config).length||r?.config||delete p.config,o.output=p,p}),s=(0,p.lazy)(()=>n.then(t=>{let n=F(t);return{name:`${t.name}${t.variant?`.${t.variant}`:""}`,inputJsonSchema:t.input?.jsonSchema,inputSchema:t.input?.schema,description:t.description,actionType:"prompt",metadata:n,fn:async t=>(0,g.toGenerateRequest)(e,await i(t,void 0))}})),c=(0,l.defineActionAsync)(e,"prompt",t,s,e=>{e.__executablePrompt=m}),d=(0,p.lazy)(()=>n.then(t=>{let n=F(t);return{name:`${t.name}${t.variant?`.${t.variant}`:""}`,inputJsonSchema:t.input?.jsonSchema,inputSchema:t.input?.schema,outputSchema:v.GenerateActionOptionsSchema,description:t.description,actionType:"executable-prompt",metadata:n,fn:async t=>await (0,g.toGenerateActionOptions)(e,await i(t,void 0))}}));(0,l.defineActionAsync)(e,"executable-prompt",t,d,e=>{e.__executablePrompt=m});let m=(o={registry:e,name:t,renderOptionsFn:i,rendererAction:c,metadata:r},(u=async(e,t)=>await (0,f.runInNewSpan)(o.registry,{metadata:{name:(await o.rendererAction).__action.name,input:e},labels:{[f.SPAN_TYPE_ATTR]:"dotprompt"}},async n=>{let r=await (0,g.generate)(o.registry,{...await o.renderOptionsFn(e,t)});return n.output=r,r})).ref={name:o.name,metadata:o.metadata},u.render=async(e,t)=>({...await o.renderOptionsFn(e,t)}),u.stream=(e,t)=>(0,g.generateStream)(o.registry,o.renderOptionsFn(e,t)),u.asTool=async()=>await o.rendererAction,u);return m}function F(e){let t={...e.metadata,prompt:{...e.metadata?.prompt,config:e.config,input:{schema:e.input?(0,m.toJsonSchema)(e.input):void 0},name:e.name.includes(".")?e.name.split(".")[0]:e.name,model:function(e){if(void 0!==e)return"string"==typeof e?e:e.name?e.name:e.__action.name}(e.model)},type:"prompt"};return e.variant&&(t.prompt.variant=e.variant),t}async function w(e,t,n,r,o,u,a){"function"==typeof o.system?r.push({role:"system",content:O(await o.system(n,{state:t?.state,context:a?.context||(0,l.getContext)()||{}}))}):"string"==typeof o.system?(u.system||(u.system=await e.dotprompt.compile(o.system)),r.push({role:"system",content:await S(e,u.system,n,t,o,a)})):o.system&&r.push({role:"system",content:O(o.system)})}async function _(e,t,n,r,o,u,a){if(o.messages)if("function"==typeof o.messages)r.push(...await o.messages(n,{state:t?.state,context:u?.context||(0,l.getContext)()||{},history:u?.messages}));else if("string"==typeof o.messages){a.messages||(a.messages=await e.dotprompt.compile(o.messages));let i=await a.messages({input:n,context:{...u?.context||(0,l.getContext)(),state:t?.state},messages:u?.messages?.map(e=>y.Message.parseData(e))});r.push(...i.messages)}else r.push(...o.messages);else u.messages&&r.push(...u.messages);u?.messages&&delete u.messages}async function z(e,t,n,r,o,u,a){"function"==typeof o.prompt?r.push({role:"user",content:O(await o.prompt(n,{state:t?.state,context:a?.context||(0,l.getContext)()||{}}))}):"string"==typeof o.prompt?(u.userPrompt||(u.userPrompt=await e.dotprompt.compile(o.prompt)),r.push({role:"user",content:await S(e,u.userPrompt,n,t,o,a)})):o.prompt&&r.push({role:"user",content:O(o.prompt)})}function O(e){return Array.isArray(e)?e:"string"==typeof e?[{text:e}]:[e]}async function S(e,t,n,r,o,u){let a=await t({input:n,context:{...u?.context||(0,l.getContext)(),state:r?.state}});if(1!==a.messages.length)throw Error("parts tempate must produce only one message");return a.messages[0].content}function x(e){return!!e?.render&&!!e?.asTool&&!!e?.stream}function k(e,t="./prompts",n){let r=(0,D.resolve)(t);(0,h.existsSync)(r)&&B(e,t,n,"")}function B(e,t,n,r){let o=(0,D.resolve)(t);for(let u of(0,h.readdirSync)((0,D.join)(o,r),{withFileTypes:!0})){let a=(0,D.join)(o,r),i=u.name;if(u.isFile()&&i.endsWith(".prompt"))if(i.startsWith("_")){let t=i.substring(1,i.length-7);P(e,t,(0,h.readFileSync)((0,D.join)(a,i),{encoding:"utf8"})),d.logger.debug(`Registered Dotprompt partial "${t}" from "${(0,D.join)(a,i)}"`)}else!function(e,t,n,r="",o="dotprompt"){let u=`${r??""}${(0,D.basename)(n,".prompt")}`,a=null;if(u.includes(".")){let e=u.split(".");u=e[0],a=e[1]}let i=(0,h.readFileSync)((0,D.join)(t,r??"",n),"utf8"),s=e.dotprompt.parse(i);C(e,T(u,a??void 0,o),(0,p.lazy)(async()=>{let t=await e.dotprompt.renderMetadata(s);a&&(t.variant=a),t.output?.schema?.description===null&&delete t.output.schema.description,t.input?.schema?.description===null&&delete t.input.schema.description;let n={...t.metadata,type:"prompt",prompt:{...t,template:s.template}};return t.raw?.metadata&&(n.metadata={...t.raw?.metadata}),{name:T(u,a??void 0,o),model:t.model,config:t.config,tools:t.tools,description:t.description,output:{jsonSchema:t.output?.schema,format:t.output?.format},input:{jsonSchema:t.input?.schema},metadata:n,maxTurns:t.raw?.maxTurns,toolChoice:t.raw?.toolChoice,returnToolRequests:t.raw?.returnToolRequests,messages:s.template}}))}(e,o,i,r?`${r}/`:"",n);else u.isDirectory()&&B(e,t,n,(0,D.join)(r,i))}}function P(e,t,n){e.dotprompt.definePartial(t,n)}function R(e,t,n){e.dotprompt.defineHelper(t,n)}async function $(e,t,n){return await N(e,t,n?.variant)}async function N(e,t,n){let r=await e.lookupAction(`/prompt/${T(t,n,void 0)}`);if(r)return r.__executablePrompt;throw new l.GenkitError({status:"NOT_FOUND",message:`Prompt ${t+(n?` (variant ${n})`:"")} not found`})}function T(e,t,n){return`${n?`${n}/`:""}${e}${t?`.${t}`:""}`}},52917,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={ToolInterruptError:()=>w,asTool:()=>f,defineInterrupt:()=>F,defineTool:()=>y,dynamicTool:()=>O,interrupt:()=>C,isDynamicTool:()=>E,isToolRequest:()=>A,isToolResponse:()=>b,lookupToolByName:()=>D,resolveTools:()=>h,toToolDefinition:()=>g,tool:()=>z};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848),p=e.r(20121),d=e.r(93064),m=e.r(67875);function f(e,t){if(t.__action?.metadata?.type==="tool")return t;let n=e=>((0,d.setCustomMetadataAttributes)({subtype:"tool"}),t(e));return n.__action={...t.__action,metadata:{...t.__action.metadata,type:"tool"}},n}async function h(e,t){return t&&0!==t.length?await Promise.all(t.map(async t=>{if("string"==typeof t)return await D(e,t);if((0,l.isAction)(t))return f(e,t);if((0,m.isExecutablePrompt)(t))return await t.asTool();if(t.name)return await D(e,t.metadata?.originalName||t.name);throw Error("Tools must be strings, tool definitions, or actions.")})):[]}async function D(e,t){let n=await e.lookupAction(t)||await e.lookupAction(`/tool/${t}`)||await e.lookupAction(`/prompt/${t}`)||await e.lookupAction(`/dynamic-action-provider/${t}`);if(!n)throw Error(`Tool ${t} not found`);return n}function g(e){let t=e.__action.name,n=t;t.includes("/")&&(n=t.substring(t.lastIndexOf("/")+1));let r={name:n,description:e.__action.description||"",outputSchema:(0,p.toJsonSchema)({schema:e.__action.outputSchema??l.z.void(),jsonSchema:e.__action.outputJsonSchema}),inputSchema:(0,p.toJsonSchema)({schema:e.__action.inputSchema??l.z.void(),jsonSchema:e.__action.inputJsonSchema})};return t!==n&&(r.metadata={originalName:t}),r}function y(e,t,n){let r=(0,l.defineAction)(e,{...t,actionType:"tool",metadata:{...t.metadata||{},type:"tool"}},(t,r)=>n(t,{...r,context:{...r.context},interrupt:_(e)}));return v(r,t,e),r}function v(e,t,n){e.respond=(e,r,o)=>(n&&(0,l.assertUnstable)(n,"beta","The 'tool.reply' method is part of the 'interrupts' beta feature."),(0,p.parseSchema)(r,{jsonSchema:t.outputJsonSchema,schema:t.outputSchema}),{toolResponse:(0,l.stripUndefinedProps)({name:e.toolRequest.name,ref:e.toolRequest.ref,output:r}),metadata:{interruptResponse:o?.metadata||!0}}),e.restart=(e,r,o)=>{n&&(0,l.assertUnstable)(n,"beta","The 'tool.restart' method is part of the 'interrupts' beta feature.");let u=o?.replaceInput;return u&&(u=(0,p.parseSchema)(u,{schema:t.inputSchema,jsonSchema:t.inputJsonSchema})),{toolRequest:(0,l.stripUndefinedProps)({name:e.toolRequest.name,ref:e.toolRequest.ref,input:u||e.toolRequest.input}),metadata:(0,l.stripUndefinedProps)({...e.metadata,resumed:r||!0,replacedInput:u?e.toolRequest.input:void 0})}}}function A(e){return!!e.toolRequest}function b(e){return!!e.toolResponse}function E(e){return(0,l.isAction)(e)&&!e.__registry}function C(e){let{requestMetadata:t,...n}=e;return O(n,async(t,{interrupt:n})=>{e.requestMetadata?n("object"==typeof e.requestMetadata?e.requestMetadata:await Promise.resolve(e.requestMetadata(t))):n()})}function F(e,t){let n=C(t);return e.registerAction("tool",n),n}class w extends Error{constructor(e){super(),this.metadata=e,this.name="ToolInterruptError"}}function _(e){return t=>{throw e&&(0,l.assertUnstable)(e,"beta","Tool interrupts are a beta feature."),new w(t)}}function z(e,t){return O(e,t)}function O(e,t){let n=(0,l.action)({...e,actionType:"tool",metadata:{...e.metadata||{},type:"tool",dynamic:!0}},(e,n)=>{let r=_(n.registry);return t?t(e,{...n,context:{...n.context},interrupt:r}):r()});return v(n,e),n.attach=e=>n,n}},16392,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={assertValidToolNames:()=>h,resolveRestartedTools:()=>b,resolveResumeOption:()=>A,resolveToolRequest:()=>g,resolveToolRequests:()=>y,toPendingOutput:()=>D,toToolMap:()=>f};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848),p=e.r(63041),d=e.r(67875),m=e.r(52917);function f(e){h(e);let t={};for(let n of e){let e=n.__action.name;t[e.substring(e.lastIndexOf("/")+1)]=n}return t}function h(e){let t={};for(let n of e){let e=n.__action.name,r=e.substring(e.lastIndexOf("/")+1);if(t[r])throw new l.GenkitError({status:"INVALID_ARGUMENT",message:`Cannot provide two tools with the same name: '${e}' and '${t[r]}'`});t[r]=e}}function D(e,t){return{...e,metadata:{...e.metadata,pendingOutput:t.toolResponse.output}}}async function g(e,t,n,r){let o=n[t.toolRequest.name];if(!o)throw new l.GenkitError({status:"NOT_FOUND",message:`Tool ${t.toolRequest.name} not found`,detail:{request:e}});if((0,d.isPromptAction)(o)){let e=o.__action.metadata;return{preamble:{...await o(t.toolRequest.input),model:e.prompt?.model},response:{toolResponse:{name:t.toolRequest.name,ref:t.toolRequest.ref,output:`transferred to ${t.toolRequest.name}`}}}}try{let e,n=await o(t.toolRequest.input,(e={metadata:t.metadata},t.metadata?.resumed&&(e.resumed=t.metadata.resumed),e));return{response:(0,l.stripUndefinedProps)({toolResponse:{name:t.toolRequest.name,ref:t.toolRequest.ref,output:n}})}}catch(e){if(e instanceof m.ToolInterruptError||"ToolInterruptError"===e.name)return p.logger.debug(`tool '${n[t.toolRequest?.name].__action.name}' triggered an interrupt${e.metadata?`: ${JSON.stringify(e.metadata)}`:""}`),{interrupt:{toolRequest:t.toolRequest,metadata:{...t.metadata,interrupt:e.metadata||!0}}};throw e}}async function y(e,t,n){let r,o=f(await (0,m.resolveTools)(e,t.tools)),u=[],a=!1,i={...n,content:[...n.content]};return(await Promise.all(i.content.map(async(e,n)=>{if(!e.toolRequest)return;let{preamble:s,response:c,interrupt:p}=await g(t,e,o);if(s){if(r)throw new l.GenkitError({status:"INVALID_ARGUMENT",message:"Model attempted to transfer to multiple prompt tools."});r=s}c&&(u.push(c),i.content.splice(n,1,D(e,c))),p&&(i.content.splice(n,1,p),a=!0)})),a)?{revisedModelMessage:i}:{toolMessage:{role:"tool",content:u},transferPreamble:r}}async function v(e,t,n){var r,o;let u,a,i,s;if(t.metadata?.pendingOutput){let{pendingOutput:e,...n}=t.metadata,r={toolResponse:{name:t.toolRequest.name,ref:t.toolRequest.ref,output:e},metadata:{...n,source:"pending"}};return(0,l.stripUndefinedProps)({toolResponse:r,toolRequest:{...t,metadata:n}})}let c=(r=e.resume?.respond||[],u=t.toolRequest?.name||t.toolResponse?.name,a=t.toolRequest?.ref||t.toolResponse?.ref,r.find(e=>e.toolResponse?.name===u&&e.toolResponse?.ref===a));if(c){let{interrupt:e,...n}=t.metadata||{};return(0,l.stripUndefinedProps)({toolResponse:c,toolRequest:{...t,metadata:{...n,resolvedInterrupt:e}}})}let p=(o=e.resume?.restart||[],i=t.toolRequest?.name||t.toolResponse?.name,s=t.toolRequest?.ref||t.toolResponse?.ref,o.find(e=>e.toolRequest?.name===i&&e.toolRequest?.ref===s));if(p){let{response:r,interrupt:o,preamble:u}=await g(e,p,n);if(u)throw new l.GenkitError({status:"INTERNAL",message:`Prompt tool '${p.toolRequest.name}' executed inside 'restart' resolution. This should never happen.`});if(o)return{interrupt:o};if(r){let{interrupt:e,...n}=t.metadata||{};return(0,l.stripUndefinedProps)({toolResponse:r,toolRequest:{...t,metadata:{...n,resolvedInterrupt:e}}})}}throw new l.GenkitError({status:"INVALID_ARGUMENT",message:`Unresolved tool request '${t.toolRequest.name}${t.toolRequest.ref?`#${t.toolRequest.ref}`:""}' was not handled by the 'resume' argument. You must supply replies or restarts for all interrupted tool requests.'`})}async function A(e,t){if(!t.resume)return{revisedRequest:t};let n=f(await (0,m.resolveTools)(e,t.tools)),r=t.messages,o=r.at(-1);if(!o||"model"!==o.role||!o.content.find(e=>e.toolRequest))throw new l.GenkitError({status:"FAILED_PRECONDITION",message:"Cannot 'resume' generation unless the previous message is a model message with at least one tool request."});let u=[],a=!1;if(o.content=await Promise.all(o.content.map(async e=>{if(!(0,m.isToolRequest)(e))return e;let r=await v(t,e,n);return r.interrupt?(a=!0,r.interrupt):(u.push(r.toolResponse),r.toolRequest)})),a)return{interruptedResponse:{finishReason:"interrupted",finishMessage:"One or more tools triggered interrupts while resuming generation. The model was not called.",message:o}};let i=o.content.filter(e=>!!e.toolRequest).length;if(u.length!==i)throw new l.GenkitError({status:"FAILED_PRECONDITION",message:`Expected ${i} tool responses but resolved to ${u.length}.`,detail:{toolResponses:u,message:o}});let s={role:"tool",content:u,metadata:{resumed:t.resume.metadata||!0}};return(0,l.stripUndefinedProps)({revisedRequest:{...t,resume:void 0,messages:[...r,s]},toolMessage:s})}async function b(e,t){let n=f(await (0,m.resolveTools)(e,t.tools)),r=t.messages.at(-1);if(!r||"model"!==r.role)return[];let o=r.content.filter(e=>e.toolRequest&&e.metadata?.resumed);return await Promise.all(o.map(async e=>{let{response:r,interrupt:o}=await g(t,e,n);return o||D(e,r)}))}},79351,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={defineGenerateAction:()=>A,generateHelper:()=>b,inferRoleFromParts:()=>_,shouldInjectFormatInstructions:()=>C};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848),p=e.r(63041),d=e.r(93064),m=e.r(78425),f=e.r(45597),h=e.r(17676),D=e.r(28761),g=e.r(55837),y=e.r(52917),v=e.r(16392);function A(e){return(0,l.defineAction)(e,{actionType:"util",name:"generate",inputSchema:D.GenerateActionOptionsSchema,outputSchema:D.GenerateResponseSchema,streamSchema:D.GenerateResponseChunkSchema},async(t,{streamingRequested:n,sendChunk:r})=>{let o=n=>F(e,{rawRequest:t,currentTurn:0,messageIndex:0,middleware:[],streamingCallback:n});return n?o(e=>r(e.toJSON?e.toJSON():e)):o()})}async function b(e,t){let n=t.currentTurn??0,r=t.messageIndex??0;return await (0,d.runInNewSpan)(e,{metadata:{name:t.rawRequest.stepName||"generate"},labels:{[d.SPAN_TYPE_ATTR]:"util"}},async o=>{o.name=t.rawRequest.stepName||"generate",o.input=t.rawRequest;let u=await F(e,{rawRequest:t.rawRequest,middleware:t.middleware,currentTurn:n,messageIndex:r,abortSignal:t.abortSignal,streamingCallback:t.streamingCallback});return o.output=JSON.stringify(u),u})}async function E(e,t){let[n,r,o,u]=await Promise.all([(0,D.resolveModel)(e,t.model,{warnDeprecated:!0}).then(e=>e.modelAction),(0,y.resolveTools)(e,t.tools),(0,g.resolveResources)(e,t.resources),(0,m.resolveFormat)(e,t.output)]);return{model:n,tools:r,resources:o,format:u}}function C(e,t){return e?.defaultInstructions!==!1||t?.instructions}async function F(e,{rawRequest:t,middleware:n,currentTurn:r,messageIndex:o,abortSignal:u,streamingCallback:a}){var i,s,c;let p,d,{model:D,tools:g,resources:y,format:A}=await E(e,t);p={...s=t},s.output?.jsonSchema&&!s.output?.format&&(p.output={...s.output,format:"json"}),d=(0,m.resolveInstructions)(A,p.output?.jsonSchema,p?.output?.instructions),A&&(C(A.config,s?.output)&&(p.messages=(0,m.injectInstructions)(p.messages,d)),p.output={...A.config,...p.output}),t=p,t=await z(e,t,y),await (0,v.assertValidToolNames)(g);let{revisedRequest:F,interruptedResponse:_,toolMessage:O}=await (0,v.resolveResumeOption)(e,t);if(_)throw new l.GenkitError({status:"FAILED_PRECONDITION",message:"One or more tools triggered an interrupt during a restarted execution.",detail:{message:_.message}});t=F;let S=await w(t,g,A,D),x=[],k="model",B=(e,t)=>{e!==k&&x.length&&o++,k=e;let n=[...x];return x.push(t),new h.GenerateResponseChunk(t,{index:o,role:e,previousChunks:n,parser:A?.handler(S.output?.schema).parseChunk})};O&&a&&a(B("tool",O));let P=async(e,t)=>n&&e!==n.length?(0,n[e])(t,async n=>P(e+1,n||t)):await D(t,{abortSignal:u,onChunk:a&&(e=>a&&a(B("model",e)))}),R=await P(0,S);if(i="background-model"===D.__action.actionType?new f.GenerateResponse({operation:R},{request:S,parser:A?.handler(S.output?.schema).parseMessage}):new f.GenerateResponse(R,{request:S,parser:A?.handler(S.output?.schema).parseMessage}),"background-model"===D.__action.actionType)return i.toJSON();i.assertValid();let $=i.message,N=$.content.filter(e=>!!e.toolRequest);if(t.returnToolRequests||0===N.length)return 0===N.length&&i.assertValidSchema(S),i.toJSON();let T=t.maxTurns??5;if(r+1>T)throw new f.GenerationResponseError(i,`Exceeded maximum tool call iterations (${T})`,"ABORTED",{request:S});let{revisedModelMessage:j,toolMessage:I,transferPreamble:Z}=await (0,v.resolveToolRequests)(e,t,$);if(j)return{...i.toJSON(),finishReason:"interrupted",finishMessage:"One or more tool calls resulted in interrupts.",message:j};a?.(B("tool",{content:I.content}));let M={...t,messages:[...t.messages,$.toJSON(),I]};return c=M,M=Z?(Z?.model&&(c.model=Z.model),(0,l.stripUndefinedProps)({...c,messages:[...(0,f.tagAsPreamble)(Z.messages),...c.messages.filter(e=>!e.metadata?.preamble)],toolChoice:Z.toolChoice||c.toolChoice,tools:Z.tools||c.tools,config:Z.config||c.config})):c,await b(e,{rawRequest:M,middleware:n,currentTurn:r+1,messageIndex:o+1,streamingCallback:a,abortSignal:u})}async function w(e,t,n,r){let o=r.__action.metadata?.model;(e.tools?.length??0)>0&&o?.supports&&!o?.supports?.tools&&p.logger.warn(`The model '${r.__action.name}' does not support tools (you set: ${e.tools?.length} tools). The model may not behave the way you expect.`),e.toolChoice&&o?.supports&&!o?.supports?.toolChoice&&p.logger.warn(`The model '${r.__action.name}' does not support the 'toolChoice' option (you set: ${e.toolChoice}). The model may not behave the way you expect.`);let u={messages:e.messages,config:e.config,docs:e.docs,tools:t?.map(y.toToolDefinition)||[],output:(0,l.stripUndefinedProps)({constrained:e.output?.constrained,contentType:e.output?.contentType,format:e.output?.format,schema:e.output?.jsonSchema})};return e.toolChoice&&(u.toolChoice=e.toolChoice),u.output&&!u.output.schema&&delete u.output.schema,u}function _(e){let t=new Set;for(let n of e){let e=function(e){if(void 0!==e.toolRequest)return"model";if(void 0!==e.toolResponse)return"tool";if(void 0!==e.text||void 0!==e.media||void 0!==e.data)return"user";throw Error("No recognized fields in content")}(n);if(t.add(e),t.size>1)throw Error("Contents contain mixed roles")}return Array.from(t)[0]}async function z(e,t,n){if(!t.messages.find(e=>!!e.content.find(e=>e.resource)))return t;let r=[];for(let o of t.messages){if(!o.content.find(e=>e.resource)){r.push(o);continue}let t=[];for(let r of o.content){if(!r.resource){t.push(r);continue}let o=await (0,g.findMatchingResource)(e,n,r.resource);if(!o)throw new l.GenkitError({status:"NOT_FOUND",message:`failed to find matching resource for ${r.resource.uri}`});let u=await o(r.resource);t.push(...u.content)}r.push({...o,content:t})}return{...t,messages:r}}},12171,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={GenerateResponse:()=>m};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(20121),p=e.r(45597),d=e.r(11841);class m{message;finishReason;finishMessage;usage;custom;raw;request;operation;model;parser;constructor(e,t){const n=e.message||e.candidates?.[0]?.message;n&&((t?.request?.output?.contentType||t?.request?.output?.format)&&(n.metadata={...n.metadata,generate:{output:{contentType:t?.request?.output?.contentType,format:t?.request?.output?.format}}}),this.message=new d.Message(n,{parser:t?.parser})),this.finishReason=e.finishReason||e.candidates?.[0]?.finishReason,this.finishMessage=e.finishMessage||e.candidates?.[0]?.finishMessage,this.usage=e.usage||{},this.custom=e.custom||{},this.raw=e.raw||this.custom,this.request=t?.request,this.operation=e?.operation}assertValid(){if("blocked"===this.finishReason)throw new p.GenerationBlockedError(this,`Generation blocked${this.finishMessage?`: ${this.finishMessage}`:"."}`);if(!this.message&&!this.operation)throw new p.GenerationResponseError(this,`Model did not generate a message. Finish reason: '${this.finishReason}': ${this.finishMessage}`)}assertValidSchema(e){if(e?.output?.schema||this.request?.output?.schema){let t=this.output;(0,l.parseSchema)(t,{jsonSchema:e?.output?.schema||this.request?.output?.schema})}}isValid(e){try{return this.assertValid(),this.assertValidSchema(e),!0}catch(e){return!1}}get output(){return this.message?.output||null}get text(){return this.message?.text||""}get reasoning(){return this.message?.reasoning||""}get media(){return this.message?.media||null}get data(){return this.message?.data||null}get toolRequests(){return this.message?.toolRequests||[]}get interrupts(){return this.message?.interrupts||[]}get messages(){if(!this.request)throw Error("Can't construct history for response without request reference.");if(!this.message)throw Error("Can't construct history for response without generated message.");return[...this.request?.messages,this.message.toJSON()]}toJSON(){let e={message:this.message?.toJSON(),finishReason:this.finishReason,finishMessage:this.finishMessage,usage:this.usage,custom:this.custom.toJSON?.()||this.custom,request:this.request,operation:this.operation};return e.finishMessage||delete e.finishMessage,e.request||delete e.request,e.operation||delete e.operation,e}}},45597,(e,t,n)=>{"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},s={GenerateResponse:()=>g.GenerateResponse,GenerateResponseChunk:()=>D.GenerateResponseChunk,GenerationBlockedError:()=>z,GenerationResponseError:()=>F,generate:()=>O,generateOperation:()=>S,generateStream:()=>R,tagAsPreamble:()=>$,toGenerateActionOptions:()=>x,toGenerateRequest:()=>C};for(var c in s)r(i,c,{get:s[c],enumerable:!0});t.exports=((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of u(t))a.call(e,n)||void 0===n||r(e,n,{get:()=>t[n],enumerable:!(i=o(t,n))||i.enumerable});return e})(r({},"__esModule",{value:!0}),i);var l=e.r(28848),p=e.r(11055),d=e.r(63433),m=e.r(20121),f=e.r(78425),h=e.r(79351),D=e.r(17676),g=e.r(12171),y=e.r(11841),v=e.r(28761),A=e.r(67875),b=e.r(55837),E=e.r(52917);async function C(e,t){let n,r,o=[];if(t.system&&o.push({role:"system",content:y.Message.parseContent(t.system)}),t.messages&&o.push(...t.messages.map(e=>y.Message.parseData(e))),t.prompt&&o.push({role:"user",content:y.Message.parseContent(t.prompt)}),0===o.length)throw new l.GenkitError({status:"INVALID_ARGUMENT",message:"at least one message is required in generate request"});if(t.resume&&!(o.at(-1)?.role==="model"&&o.at(-1)?.content.find(e=>!!e.toolRequest)))throw new l.GenkitError({status:"FAILED_PRECONDITION",message:"Last message must be a 'model' role with at least one tool request to 'resume' generation.",detail:o.at(-1)});t.tools&&(n=await (0,E.resolveTools)(e,t.tools)),t.resources&&(r=await (0,b.resolveResources)(e,t.resources));let u=(0,m.toJsonSchema)({schema:t.output?.schema,jsonSchema:t.output?.jsonSchema}),a=await (0,f.resolveFormat)(e,t.output),i=(0,f.resolveInstructions)(a,u,t?.output?.instructions),s={messages:(0,h.shouldInjectFormatInstructions)(a?.config,t.output)?(0,f.injectInstructions)(o,i):o,config:t.config,docs:t.docs,tools:n?.map(E.toToolDefinition)||[],resources:r?.map(e=>e.__action)||[],output:{...a?.config||{},...t.output,schema:u}};return s?.output?.schema||delete s?.output?.schema,s}class F extends l.GenkitError{detail;constructor(e,t,n,r){super({status:n||"FAILED_PRECONDITION",message:t}),this.detail={response:e,...r}}}async function w(e,t){if(!t)return;let n=[];for(let r of t)if("string"==typeof r){let t=await B(e,r);n.push(...t)}else if((0,l.isAction)(r)||(0,E.isDynamicTool)(r))n.push(`/${r.__action.metadata?.type}/${r.__action.name}`);else if((0,A.isExecutablePrompt)(r)){let e=await r.asTool();n.push(`/prompt/${e.__action.name}`)}else throw Error(`Unable to determine type of tool: ${JSON.stringify(r)}`);return n}async function _(e,t){if(!t)return;let n=[];for(let r of t)if("string"==typeof r){let t=await P(e,r);n.push(...t)}else if((0,l.isAction)(r))n.push(`/resource/${r.__action.name}`);else throw Error(`Unable to resolve resource: ${JSON.stringify(r)}`);return n}class z extends F{}async function O(e,t){var n,r,o,u;let a,i,s={...await Promise.resolve(t)},c=await (0,f.resolveFormat)(e,s.output);o=(n=e,r=s,a=!1,r?.tools?.forEach(e=>{(0,E.isDynamicTool)(e)&&(a||(a=!0,n=d.Registry.withParent(n)),n.registerAction("tool",e))}),e=n),u=s,i=!1,u?.resources?.forEach(e=>{(0,b.isDynamicResourceAction)(e)&&(i||(i=!0,o=d.Registry.withParent(o)),o.registerAction("resource",e))}),e=o;let p=await x(e,s),m=await w(e,s.tools),D=await _(e,s.resources),y=function(e){if(e!==l.sentinelNoopStreamingCallback)return e}(s.onChunk??s.streamingCallback),v=await (0,l.runWithContext)(s.context,()=>(0,h.generateHelper)(e,{rawRequest:p,middleware:s.use,abortSignal:s.abortSignal,streamingCallback:y})),A=await C(e,{...s,tools:m,resources:D});return new g.GenerateResponse(v,{request:v.request??A,parser:c?.handler(A.output?.schema).parseMessage})}async function S(e,t){(0,l.assertUnstable)(e,"beta","generateOperation is a beta feature."),t=await t;let n=await (0,v.resolveModel)(e,t.model);if(!n.modelAction.__action.metadata?.model.supports?.longRunning)throw new l.GenkitError({status:"INVALID_ARGUMENT",message:`Model '${n.modelAction.__action.name}' does not support long running operations.`});let{operation:r}=await O(e,t);if(!r)throw new l.GenkitError({status:"FAILED_PRECONDITION",message:`Model '${n.modelAction.__action.name}' did not return an operation.`});return r}async function x(e,t){let n=await (0,v.resolveModel)(e,t.model),r=await w(e,t.tools),o=await _(e,t.resources),u=function(e){let t=[];if(e.system&&t.push({role:"system",content:y.Message.parseContent(e.system)}),e.messages&&t.push(...e.messages),e.prompt&&t.push({role:"user",content:y.Message.parseContent(e.prompt)}),0===t.length)throw new l.GenkitError({status:"INVALID_ARGUMENT",message:"at least one message is required in generate request"});return t}(t),a=(0,m.toJsonSchema)({schema:t.output?.schema,jsonSchema:t.output?.jsonSchema});(t.output?.schema||t.output?.jsonSchema)&&!t.output?.format&&(t.output.format="json");let i={model:n.modelAction.__action.name,docs:t.docs,messages:u,tools:r,resources:o,toolChoice:t.toolChoice,config:{version:n.version,...k(n.config),...k(t.config)},output:t.output&&{...t.output,format:t.output.format,jsonSchema:a},resume:t.resume&&{respond:[t.resume.respond||[]].flat(),restart:[t.resume.restart||[]].flat(),metadata:t.resume.metadata},returnToolRequests:t.returnToolRequests,maxTurns:t.maxTurns,stepName:t.stepName};return 0!==Object.keys(i.config).length||t.config||delete i.config,i}function k(e){if(!e)return e;let t={...e};return Object.keys(e).forEach(e=>{void 0===t[e]&&delete t[e]}),t}async function B(e,t){let n;if(t.split(":").length>1&&(n=await e.resolveActionNames(`/dynamic-action-provider/${t}`)).length)return n;if(await e.lookupAction(`/tool/${t}`))return[`/tool/${t}`];if(await e.lookupAction(`/prompt/${t}`))return[`/prompt/${t}`];throw Error(`Unable to resolve tool: ${t}`)}async function P(e,t){let n;if(t.split(":").length>1&&(n=await e.resolveActionNames(`/dynamic-action-provider/${t}`)).length)return n;if(await e.lookupAction(`/resource/${t}`))return[`/resource/${t}`];throw Error(`Unable to resolve resource: ${t}`)}function R(e,t){let n=new p.Channel,r=Promise.resolve(t).then(t=>O(e,{...t,onChunk:e=>n.send(e)}));return r.then(()=>n.close(),e=>n.error(e)),{response:r,stream:n}}function $(e){if(e)return e.map(e=>({...e,metadata:{...e.metadata,preamble:!0}}))}},40683,e=>{"use strict";e.i(47525),e.i(39771),e.i(47721),e.i(88836),e.i(45597),e.i(11841),e.i(28761),e.i(67875),e.i(56435),e.i(55837),e.i(29790),e.i(52917),e.i(18309),e.s([])},36109,e=>e.a(async(t,n)=>{try{let t=await e.y("@genkit-ai/googleai");e.n(t),n()}catch(e){n(e)}},!0),7855,e=>{"use strict";function t(e,t,n){function r(n,r){if(n._zod||Object.defineProperty(n,"_zod",{value:{def:r,constr:a,traits:new Set},enumerable:!1}),n._zod.traits.has(e))return;n._zod.traits.add(e),t(n,r);let o=a.prototype,u=Object.keys(o);for(let e=0;e<u.length;e++){let t=u[e];t in n||(n[t]=o[t].bind(n))}}let o=n?.Parent??Object;class u extends o{}function a(e){var t;let o=n?.Parent?new u:this;for(let n of(r(o,e),(t=o._zod).deferred??(t.deferred=[]),o._zod.deferred))n();return o}return Object.defineProperty(u,"name",{value:e}),Object.defineProperty(a,"init",{value:r}),Object.defineProperty(a,Symbol.hasInstance,{value:t=>!!n?.Parent&&t instanceof n.Parent||t?._zod?.traits?.has(e)}),Object.defineProperty(a,"name",{value:e}),a}e.s(["ZodStringFormat",()=>rO,"object",()=>r2,"string",()=>rz],7855),Object.freeze({status:"aborted"}),Symbol("zod_brand");class n extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class r extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}let o={};function u(e){return e&&Object.assign(o,e),o}function a(e){return e}function i(e){return e}function s(e){}function c(e){throw Error()}function l(e){}function p(e){let t=Object.values(e).filter(e=>"number"==typeof e);return Object.entries(e).filter(([e,n])=>-1===t.indexOf(+e)).map(([e,t])=>t)}function d(e,t="|"){return e.map(e=>M(e)).join(t)}function m(e,t){return"bigint"==typeof t?t.toString():t}function f(e){return{get value(){{let t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function h(e){return null==e}function D(e){let t=+!!e.startsWith("^"),n=e.endsWith("$")?e.length-1:e.length;return e.slice(t,n)}function g(e,t){let n=(e.toString().split(".")[1]||"").length,r=t.toString(),o=(r.split(".")[1]||"").length;if(0===o&&/\d?e-\d?/.test(r)){let e=r.match(/\d?e-(\d?)/);e?.[1]&&(o=Number.parseInt(e[1]))}let u=n>o?n:o;return Number.parseInt(e.toFixed(u).replace(".",""))%Number.parseInt(t.toFixed(u).replace(".",""))/10**u}let y=Symbol("evaluating");function v(e,t,n){let r;Object.defineProperty(e,t,{get(){if(r!==y)return void 0===r&&(r=y,r=n()),r},set(n){Object.defineProperty(e,t,{value:n})},configurable:!0})}function A(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))}function b(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function E(...e){let t={};for(let n of e)Object.assign(t,Object.getOwnPropertyDescriptors(n));return Object.defineProperties({},t)}function C(e){return E(e._zod.def)}function F(e,t){return t?t.reduce((e,t)=>e?.[t],e):e}function w(e){let t=Object.keys(e);return Promise.all(t.map(t=>e[t])).then(e=>{let n={};for(let r=0;r<t.length;r++)n[t[r]]=e[r];return n})}function _(e=10){let t="abcdefghijklmnopqrstuvwxyz",n="";for(let r=0;r<e;r++)n+=t[Math.floor(Math.random()*t.length)];return n}function z(e){return JSON.stringify(e)}function O(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}let S="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function x(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}let k=f(()=>{if("undefined"!=typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(e){return!1}});function B(e){if(!1===x(e))return!1;let t=e.constructor;if(void 0===t||"function"!=typeof t)return!0;let n=t.prototype;return!1!==x(n)&&!1!==Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")}function P(e){return B(e)?{...e}:Array.isArray(e)?[...e]:e}function R(e){let t=0;for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}let $=new Set(["string","number","symbol"]),N=new Set(["string","number","bigint","boolean","symbol","undefined"]);function T(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function j(e,t,n){let r=new e._zod.constr(t??e._zod.def);return(!t||n?.parent)&&(r._zod.parent=e),r}function I(e){if(!e)return{};if("string"==typeof e)return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");e.error=e.message}return(delete e.message,"string"==typeof e.error)?{...e,error:()=>e.error}:e}function Z(e){let t;return new Proxy({},{get:(n,r,o)=>(t??(t=e()),Reflect.get(t,r,o)),set:(n,r,o,u)=>(t??(t=e()),Reflect.set(t,r,o,u)),has:(n,r)=>(t??(t=e()),Reflect.has(t,r)),deleteProperty:(n,r)=>(t??(t=e()),Reflect.deleteProperty(t,r)),ownKeys:n=>(t??(t=e()),Reflect.ownKeys(t)),getOwnPropertyDescriptor:(n,r)=>(t??(t=e()),Reflect.getOwnPropertyDescriptor(t,r)),defineProperty:(n,r,o)=>(t??(t=e()),Reflect.defineProperty(t,r,o))})}function M(e){return"bigint"==typeof e?e.toString()+"n":"string"==typeof e?`"${e}"`:`${e}`}function U(e){return Object.keys(e).filter(t=>"optional"===e[t]._zod.optin&&"optional"===e[t]._zod.optout)}let q={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-0x80000000,0x7fffffff],uint32:[0,0xffffffff],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},L={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function J(e,t){let n=e._zod.def,r=E(e._zod.def,{get shape(){let e={};for(let r in t){if(!(r in n.shape))throw Error(`Unrecognized key: "${r}"`);t[r]&&(e[r]=n.shape[r])}return b(this,"shape",e),e},checks:[]});return j(e,r)}function G(e,t){let n=e._zod.def,r=E(e._zod.def,{get shape(){let r={...e._zod.def.shape};for(let e in t){if(!(e in n.shape))throw Error(`Unrecognized key: "${e}"`);t[e]&&delete r[e]}return b(this,"shape",r),r},checks:[]});return j(e,r)}function V(e,t){if(!B(t))throw Error("Invalid input to extend: expected a plain object");let n=e._zod.def.checks;if(n&&n.length>0)throw Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");let r=E(e._zod.def,{get shape(){let n={...e._zod.def.shape,...t};return b(this,"shape",n),n},checks:[]});return j(e,r)}function W(e,t){if(!B(t))throw Error("Invalid input to safeExtend: expected a plain object");let n={...e._zod.def,get shape(){let n={...e._zod.def.shape,...t};return b(this,"shape",n),n},checks:e._zod.def.checks};return j(e,n)}function H(e,t){let n=E(e._zod.def,{get shape(){let n={...e._zod.def.shape,...t._zod.def.shape};return b(this,"shape",n),n},get catchall(){return t._zod.def.catchall},checks:[]});return j(e,n)}function K(e,t,n){let r=E(t._zod.def,{get shape(){let r=t._zod.def.shape,o={...r};if(n)for(let t in n){if(!(t in r))throw Error(`Unrecognized key: "${t}"`);n[t]&&(o[t]=e?new e({type:"optional",innerType:r[t]}):r[t])}else for(let t in r)o[t]=e?new e({type:"optional",innerType:r[t]}):r[t];return b(this,"shape",o),o},checks:[]});return j(t,r)}function Y(e,t,n){let r=E(t._zod.def,{get shape(){let r=t._zod.def.shape,o={...r};if(n)for(let t in n){if(!(t in o))throw Error(`Unrecognized key: "${t}"`);n[t]&&(o[t]=new e({type:"nonoptional",innerType:r[t]}))}else for(let t in r)o[t]=new e({type:"nonoptional",innerType:r[t]});return b(this,"shape",o),o},checks:[]});return j(t,r)}function X(e,t=0){if(!0===e.aborted)return!0;for(let n=t;n<e.issues.length;n++)if(e.issues[n]?.continue!==!0)return!0;return!1}function Q(e,t){return t.map(t=>(t.path??(t.path=[]),t.path.unshift(e),t))}function ee(e){return"string"==typeof e?e:e?.message}function et(e,t,n){let r={...e,path:e.path??[]};return e.message||(r.message=ee(e.inst?._zod.def?.error?.(e))??ee(t?.error?.(e))??ee(n.customError?.(e))??ee(n.localeError?.(e))??"Invalid input"),delete r.inst,delete r.continue,t?.reportInput||delete r.input,r}function en(e){return e instanceof Set?"set":e instanceof Map?"map":e instanceof File?"file":"unknown"}function er(e){return Array.isArray(e)?"array":"string"==typeof e?"string":"unknown"}function eo(...e){let[t,n,r]=e;return"string"==typeof t?{message:t,code:"custom",input:n,inst:r}:{...t}}function eu(e){return Object.entries(e).filter(([e,t])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}function ea(e){let t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}function ei(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function es(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),n="=".repeat((4-t.length%4)%4);return ea(t+n)}function ec(e){return ei(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function el(e){let t=e.replace(/^0x/,"");if(t.length%2!=0)throw Error("Invalid hex string length");let n=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2)n[e/2]=Number.parseInt(t.slice(e,e+2),16);return n}function ep(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}class ed{constructor(...e){}}e.s(["BIGINT_FORMAT_RANGES",0,L,"Class",()=>ed,"NUMBER_FORMAT_RANGES",0,q,"aborted",()=>X,"allowsEval",0,k,"assert",()=>l,"assertEqual",()=>a,"assertIs",()=>s,"assertNever",()=>c,"assertNotEqual",()=>i,"assignProp",()=>b,"base64ToUint8Array",()=>ea,"base64urlToUint8Array",()=>es,"cached",()=>f,"captureStackTrace",0,S,"cleanEnum",()=>eu,"cleanRegex",()=>D,"clone",()=>j,"cloneDef",()=>C,"createTransparentProxy",()=>Z,"defineLazy",()=>v,"esc",()=>z,"escapeRegex",()=>T,"extend",()=>V,"finalizeIssue",()=>et,"floatSafeRemainder",()=>g,"getElementAtPath",()=>F,"getEnumValues",()=>p,"getLengthableOrigin",()=>er,"getParsedType",0,e=>{let t=typeof e;switch(t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(e)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return"promise";if("undefined"!=typeof Map&&e instanceof Map)return"map";if("undefined"!=typeof Set&&e instanceof Set)return"set";if("undefined"!=typeof Date&&e instanceof Date)return"date";if("undefined"!=typeof File&&e instanceof File)return"file";return"object";default:throw Error(`Unknown data type: ${t}`)}},"getSizableOrigin",()=>en,"hexToUint8Array",()=>el,"isObject",()=>x,"isPlainObject",()=>B,"issue",()=>eo,"joinValues",()=>d,"jsonStringifyReplacer",()=>m,"merge",()=>H,"mergeDefs",()=>E,"normalizeParams",()=>I,"nullish",()=>h,"numKeys",()=>R,"objectClone",()=>A,"omit",()=>G,"optionalKeys",()=>U,"partial",()=>K,"pick",()=>J,"prefixIssues",()=>Q,"primitiveTypes",0,N,"promiseAllObject",()=>w,"propertyKeyTypes",0,$,"randomString",()=>_,"required",()=>Y,"safeExtend",()=>W,"shallowClone",()=>P,"slugify",()=>O,"stringifyPrimitive",()=>M,"uint8ArrayToBase64",()=>ei,"uint8ArrayToBase64url",()=>ec,"uint8ArrayToHex",()=>ep,"unwrapMessage",()=>ee],86618);let em=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,m,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},ef=t("$ZodError",em),eh=t("$ZodError",em,{Parent:Error}),eD=e=>(t,r,o,a)=>{let i=o?Object.assign(o,{async:!1}):{async:!1},s=t._zod.run({value:r,issues:[]},i);if(s instanceof Promise)throw new n;if(s.issues.length){let t=new(a?.Err??e)(s.issues.map(e=>et(e,i,u())));throw S(t,a?.callee),t}return s.value},eg=eD(eh),ey=e=>async(t,n,r,o)=>{let a=r?Object.assign(r,{async:!0}):{async:!0},i=t._zod.run({value:n,issues:[]},a);if(i instanceof Promise&&(i=await i),i.issues.length){let t=new(o?.Err??e)(i.issues.map(e=>et(e,a,u())));throw S(t,o?.callee),t}return i.value},ev=ey(eh),eA=e=>(t,r,o)=>{let a=o?{...o,async:!1}:{async:!1},i=t._zod.run({value:r,issues:[]},a);if(i instanceof Promise)throw new n;return i.issues.length?{success:!1,error:new(e??ef)(i.issues.map(e=>et(e,a,u())))}:{success:!0,data:i.value}},eb=eA(eh),eE=e=>async(t,n,r)=>{let o=r?Object.assign(r,{async:!0}):{async:!0},a=t._zod.run({value:n,issues:[]},o);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new e(a.issues.map(e=>et(e,o,u())))}:{success:!0,data:a.value}},eC=eE(eh),eF=/^[cC][^\s-]{8,}$/,ew=/^[0-9a-z]+$/,e_=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,ez=/^[0-9a-vA-V]{20}$/,eO=/^[A-Za-z0-9]{27}$/,eS=/^[a-zA-Z0-9_-]{21}$/,ex=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,ek=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,eB=e=>e?RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,eP=eB(4),eR=eB(6),e$=eB(7),eN=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,eT=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u;function ej(){return RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")}let eI=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,eZ=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,eM=e=>{let t=T(e??":");return RegExp(`^(?:[0-9A-F]{2}${t}){5}[0-9A-F]{2}$|^(?:[0-9a-f]{2}${t}){5}[0-9a-f]{2}$`)},eU=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,eq=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,eL=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,eJ=/^[A-Za-z0-9_-]*$/,eG=/^\+(?:[0-9]){6,14}[0-9]$/,eV="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",eW=RegExp(`^${eV}$`);function eH(e){let t="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof e.precision?-1===e.precision?`${t}`:0===e.precision?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function eK(e){return RegExp(`^${eH(e)}$`)}function eY(e){let t=eH({precision:e.precision}),n=["Z"];e.local&&n.push(""),e.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");let r=`${t}(?:${n.join("|")})`;return RegExp(`^${eV}T(?:${r})$`)}let eX=e=>{let t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return RegExp(`^${t}$`)},eQ=/^-?\d+n?$/,e0=/^-?\d+$/,e1=/^-?\d+(?:\.\d+)?/,e2=/^(?:true|false)$/i,e8=/^null$/i,e4=/^undefined$/i,e9=/^[^A-Z]*$/,e3=/^[^a-z]*$/;function e6(e,t){return RegExp(`^[A-Za-z0-9+/]{${e}}${t}$`)}function e5(e){return RegExp(`^[A-Za-z0-9_-]{${e}}$`)}let e7=e6(22,"=="),te=e5(22),tt=e6(27,"="),tn=e5(27),tr=e6(43,"="),to=e5(43),tu=e6(64,""),ta=e5(64),ti=e6(86,"=="),ts=e5(86);e.s(["base64",0,eL,"base64url",0,eJ,"bigint",0,eQ,"boolean",0,e2,"browserEmail",0,/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,"cidrv4",0,eU,"cidrv6",0,eq,"cuid",0,eF,"cuid2",0,ew,"date",0,eW,"datetime",()=>eY,"domain",0,/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,"duration",0,ex,"e164",0,eG,"email",0,eN,"emoji",()=>ej,"extendedDuration",0,/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,"guid",0,ek,"hex",0,/^[0-9a-fA-F]*$/,"hostname",0,/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,"html5Email",0,/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,"idnEmail",0,eT,"integer",0,e0,"ipv4",0,eI,"ipv6",0,eZ,"ksuid",0,eO,"lowercase",0,e9,"mac",0,eM,"md5_base64",0,e7,"md5_base64url",0,te,"md5_hex",0,/^[0-9a-fA-F]{32}$/,"nanoid",0,eS,"null",()=>e8,"number",0,e1,"rfc5322Email",0,/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,"sha1_base64",0,tt,"sha1_base64url",0,tn,"sha1_hex",0,/^[0-9a-fA-F]{40}$/,"sha256_base64",0,tr,"sha256_base64url",0,to,"sha256_hex",0,/^[0-9a-fA-F]{64}$/,"sha384_base64",0,tu,"sha384_base64url",0,ta,"sha384_hex",0,/^[0-9a-fA-F]{96}$/,"sha512_base64",0,ti,"sha512_base64url",0,ts,"sha512_hex",0,/^[0-9a-fA-F]{128}$/,"string",0,eX,"time",()=>eK,"ulid",0,e_,"undefined",()=>e4,"unicodeEmail",0,eT,"uppercase",0,e3,"uuid",0,eB,"uuid4",0,eP,"uuid6",0,eR,"uuid7",0,e$,"xid",0,ez],21131);let tc=t("$ZodCheck",(e,t)=>{var n;e._zod??(e._zod={}),e._zod.def=t,(n=e._zod).onattach??(n.onattach=[])}),tl={number:"number",bigint:"bigint",object:"date"},tp=t("$ZodCheckLessThan",(e,t)=>{tc.init(e,t);let n=tl[typeof t.value];e._zod.onattach.push(e=>{let n=e._zod.bag,r=(t.inclusive?n.maximum:n.exclusiveMaximum)??1/0;t.value<r&&(t.inclusive?n.maximum=t.value:n.exclusiveMaximum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value<=t.value:r.value<t.value)||r.issues.push({origin:n,code:"too_big",maximum:t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),td=t("$ZodCheckGreaterThan",(e,t)=>{tc.init(e,t);let n=tl[typeof t.value];e._zod.onattach.push(e=>{let n=e._zod.bag,r=(t.inclusive?n.minimum:n.exclusiveMinimum)??-1/0;t.value>r&&(t.inclusive?n.minimum=t.value:n.exclusiveMinimum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value>=t.value:r.value>t.value)||r.issues.push({origin:n,code:"too_small",minimum:t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),tm=t("$ZodCheckMultipleOf",(e,t)=>{tc.init(e,t),e._zod.onattach.push(e=>{var n;(n=e._zod.bag).multipleOf??(n.multipleOf=t.value)}),e._zod.check=n=>{if(typeof n.value!=typeof t.value)throw Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof n.value?n.value%t.value===BigInt(0):0===g(n.value,t.value))||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:t.value,input:n.value,inst:e,continue:!t.abort})}}),tf=t("$ZodCheckNumberFormat",(e,t)=>{tc.init(e,t),t.format=t.format||"float64";let n=t.format?.includes("int"),r=n?"int":"number",[o,u]=q[t.format];e._zod.onattach.push(e=>{let r=e._zod.bag;r.format=t.format,r.minimum=o,r.maximum=u,n&&(r.pattern=e0)}),e._zod.check=a=>{let i=a.value;if(n){if(!Number.isInteger(i))return void a.issues.push({expected:r,format:t.format,code:"invalid_type",continue:!1,input:i,inst:e});if(!Number.isSafeInteger(i))return void(i>0?a.issues.push({input:i,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:r,continue:!t.abort}):a.issues.push({input:i,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:r,continue:!t.abort}))}i<o&&a.issues.push({origin:"number",input:i,code:"too_small",minimum:o,inclusive:!0,inst:e,continue:!t.abort}),i>u&&a.issues.push({origin:"number",input:i,code:"too_big",maximum:u,inst:e})}}),th=t("$ZodCheckBigIntFormat",(e,t)=>{tc.init(e,t);let[n,r]=L[t.format];e._zod.onattach.push(e=>{let o=e._zod.bag;o.format=t.format,o.minimum=n,o.maximum=r}),e._zod.check=o=>{let u=o.value;u<n&&o.issues.push({origin:"bigint",input:u,code:"too_small",minimum:n,inclusive:!0,inst:e,continue:!t.abort}),u>r&&o.issues.push({origin:"bigint",input:u,code:"too_big",maximum:r,inst:e})}}),tD=t("$ZodCheckMaxSize",(e,t)=>{var n;tc.init(e,t),(n=e._zod.def).when??(n.when=e=>{let t=e.value;return!h(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let n=e._zod.bag.maximum??1/0;t.maximum<n&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{let r=n.value;r.size<=t.maximum||n.issues.push({origin:en(r),code:"too_big",maximum:t.maximum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),tg=t("$ZodCheckMinSize",(e,t)=>{var n;tc.init(e,t),(n=e._zod.def).when??(n.when=e=>{let t=e.value;return!h(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let n=e._zod.bag.minimum??-1/0;t.minimum>n&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{let r=n.value;r.size>=t.minimum||n.issues.push({origin:en(r),code:"too_small",minimum:t.minimum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),ty=((e,t)=>{var n;tc.init(e,t),(n=e._zod.def).when??(n.when=e=>{let t=e.value;return!h(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let n=e._zod.bag;n.minimum=t.size,n.maximum=t.size,n.size=t.size}),e._zod.check=n=>{let r=n.value,o=r.size;if(o===t.size)return;let u=o>t.size;n.issues.push({origin:en(r),...u?{code:"too_big",maximum:t.size}:{code:"too_small",minimum:t.size},inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort})}},t("$ZodCheckMaxLength",(e,t)=>{var n;tc.init(e,t),(n=e._zod.def).when??(n.when=e=>{let t=e.value;return!h(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let n=e._zod.bag.maximum??1/0;t.maximum<n&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{let r=n.value;if(r.length<=t.maximum)return;let o=er(r);n.issues.push({origin:o,code:"too_big",maximum:t.maximum,inclusive:!0,input:r,inst:e,continue:!t.abort})}})),tv=t("$ZodCheckMinLength",(e,t)=>{var n;tc.init(e,t),(n=e._zod.def).when??(n.when=e=>{let t=e.value;return!h(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let n=e._zod.bag.minimum??-1/0;t.minimum>n&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{let r=n.value;if(r.length>=t.minimum)return;let o=er(r);n.issues.push({origin:o,code:"too_small",minimum:t.minimum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),tA=t("$ZodCheckLengthEquals",(e,t)=>{var n;tc.init(e,t),(n=e._zod.def).when??(n.when=e=>{let t=e.value;return!h(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let n=e._zod.bag;n.minimum=t.length,n.maximum=t.length,n.length=t.length}),e._zod.check=n=>{let r=n.value,o=r.length;if(o===t.length)return;let u=er(r),a=o>t.length;n.issues.push({origin:u,...a?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort})}}),tb=t("$ZodCheckStringFormat",(e,t)=>{var n,r;tc.init(e,t),e._zod.onattach.push(e=>{let n=e._zod.bag;n.format=t.format,t.pattern&&(n.patterns??(n.patterns=new Set),n.patterns.add(t.pattern))}),t.pattern?(n=e._zod).check??(n.check=n=>{t.pattern.lastIndex=0,t.pattern.test(n.value)||n.issues.push({origin:"string",code:"invalid_format",format:t.format,input:n.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(r=e._zod).check??(r.check=()=>{})}),tE=t("$ZodCheckRegex",(e,t)=>{tb.init(e,t),e._zod.check=n=>{t.pattern.lastIndex=0,t.pattern.test(n.value)||n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),tC=t("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=e9),tb.init(e,t)}),tF=t("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=e3),tb.init(e,t)}),tw=t("$ZodCheckIncludes",(e,t)=>{tc.init(e,t);let n=T(t.includes),r=new RegExp("number"==typeof t.position?`^.{${t.position}}${n}`:n);t.pattern=r,e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(r)}),e._zod.check=n=>{n.value.includes(t.includes,t.position)||n.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:n.value,inst:e,continue:!t.abort})}}),t_=t("$ZodCheckStartsWith",(e,t)=>{tc.init(e,t);let n=RegExp(`^${T(t.prefix)}.*`);t.pattern??(t.pattern=n),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(n)}),e._zod.check=n=>{n.value.startsWith(t.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:n.value,inst:e,continue:!t.abort})}}),tz=t("$ZodCheckEndsWith",(e,t)=>{tc.init(e,t);let n=RegExp(`.*${T(t.suffix)}$`);t.pattern??(t.pattern=n),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(n)}),e._zod.check=n=>{n.value.endsWith(t.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:n.value,inst:e,continue:!t.abort})}});(e,t)=>{tc.init(e,t);let n=new Set(t.mime);e._zod.onattach.push(e=>{e._zod.bag.mime=t.mime}),e._zod.check=r=>{n.has(r.value.type)||r.issues.push({code:"invalid_value",values:t.mime,input:r.value.type,inst:e,continue:!t.abort})}};let tO=t("$ZodCheckOverwrite",(e,t)=>{tc.init(e,t),e._zod.check=e=>{e.value=t.tx(e.value)}});class tS{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if("function"==typeof e){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let t=e.split("\n").filter(e=>e),n=Math.min(...t.map(e=>e.length-e.trimStart().length));for(let e of t.map(e=>e.slice(n)).map(e=>" ".repeat(2*this.indent)+e))this.content.push(e)}compile(){return Function(...this?.args,[...(this?.content??[""]).map(e=>`  ${e}`)].join("\n"))}}let tx={major:4,minor:1,patch:13},tk=t("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=tx;let o=[...e._zod.def.checks??[]];for(let t of(e._zod.traits.has("$ZodCheck")&&o.unshift(e),o))for(let n of t._zod.onattach)n(e);if(0===o.length)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{let t=(e,t,r)=>{let o,u=X(e);for(let a of t){if(a._zod.def.when){if(!a._zod.def.when(e))continue}else if(u)continue;let t=e.issues.length,i=a._zod.check(e);if(i instanceof Promise&&r?.async===!1)throw new n;if(o||i instanceof Promise)o=(o??Promise.resolve()).then(async()=>{await i,e.issues.length!==t&&(u||(u=X(e,t)))});else{if(e.issues.length===t)continue;u||(u=X(e,t))}}return o?o.then(()=>e):e},r=(r,u,a)=>{if(X(r))return r.aborted=!0,r;let i=t(u,o,a);if(i instanceof Promise){if(!1===a.async)throw new n;return i.then(t=>e._zod.parse(t,a))}return e._zod.parse(i,a)};e._zod.run=(u,a)=>{if(a.skipChecks)return e._zod.parse(u,a);if("backward"===a.direction){let t=e._zod.parse({value:u.value,issues:[]},{...a,skipChecks:!0});return t instanceof Promise?t.then(e=>r(e,u,a)):r(t,u,a)}let i=e._zod.parse(u,a);if(i instanceof Promise){if(!1===a.async)throw new n;return i.then(e=>t(e,o,a))}return t(i,o,a)}}e["~standard"]={validate:t=>{try{let n=eb(e,t);return n.success?{value:n.data}:{issues:n.error?.issues}}catch(n){return eC(e,t).then(e=>e.success?{value:e.data}:{issues:e.error?.issues})}},vendor:"zod",version:1}}),tB=t("$ZodString",(e,t)=>{tk.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??eX(e._zod.bag),e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=String(n.value)}catch(e){}return"string"==typeof n.value||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:e}),n}}),tP=t("$ZodStringFormat",(e,t)=>{tb.init(e,t),tB.init(e,t)}),tR=t("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=ek),tP.init(e,t)}),t$=t("$ZodUUID",(e,t)=>{if(t.version){let e={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(void 0===e)throw Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=eB(e))}else t.pattern??(t.pattern=eB());tP.init(e,t)}),tN=t("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=eN),tP.init(e,t)}),tT=t("$ZodURL",(e,t)=>{tP.init(e,t),e._zod.check=n=>{try{let r=n.value.trim(),o=new URL(r);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(o.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:n.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:n.value,inst:e,continue:!t.abort})),t.normalize?n.value=o.href:n.value=r;return}catch(r){n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:e,continue:!t.abort})}}}),tj=t("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=ej()),tP.init(e,t)}),tI=t("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=eS),tP.init(e,t)}),tZ=t("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=eF),tP.init(e,t)}),tM=t("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=ew),tP.init(e,t)}),tU=t("$ZodULID",(e,t)=>{t.pattern??(t.pattern=e_),tP.init(e,t)}),tq=t("$ZodXID",(e,t)=>{t.pattern??(t.pattern=ez),tP.init(e,t)}),tL=t("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=eO),tP.init(e,t)}),tJ=t("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=eY(t)),tP.init(e,t)}),tG=t("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=eW),tP.init(e,t)}),tV=t("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=eK(t)),tP.init(e,t)}),tW=t("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=ex),tP.init(e,t)}),tH=t("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=eI),tP.init(e,t),e._zod.bag.format="ipv4"}),tK=t("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=eZ),tP.init(e,t),e._zod.bag.format="ipv6",e._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:e,continue:!t.abort})}}}),tY=t("$ZodMAC",(e,t)=>{t.pattern??(t.pattern=eM(t.delimiter)),tP.init(e,t),e._zod.bag.format="mac"}),tX=t("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=eU),tP.init(e,t)}),tQ=t("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=eq),tP.init(e,t),e._zod.check=n=>{let r=n.value.split("/");try{if(2!==r.length)throw Error();let[e,t]=r;if(!t)throw Error();let n=Number(t);if(`${n}`!==t||n<0||n>128)throw Error();new URL(`http://[${e}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:e,continue:!t.abort})}}});function t0(e){if(""===e)return!0;if(e.length%4!=0)return!1;try{return atob(e),!0}catch{return!1}}let t1=t("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=eL),tP.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=n=>{t0(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:e,continue:!t.abort})}});function t2(e){if(!eJ.test(e))return!1;let t=e.replace(/[-_]/g,e=>"-"===e?"+":"/");return t0(t.padEnd(4*Math.ceil(t.length/4),"="))}let t8=t("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=eJ),tP.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=n=>{t2(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:e,continue:!t.abort})}}),t4=t("$ZodE164",(e,t)=>{t.pattern??(t.pattern=eG),tP.init(e,t)});function t9(e,t=null){try{let n=e.split(".");if(3!==n.length)return!1;let[r]=n;if(!r)return!1;let o=JSON.parse(atob(r));if("typ"in o&&o?.typ!=="JWT"||!o.alg||t&&(!("alg"in o)||o.alg!==t))return!1;return!0}catch{return!1}}let t3=t("$ZodJWT",(e,t)=>{tP.init(e,t),e._zod.check=n=>{t9(n.value,t.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:e,continue:!t.abort})}}),t6=t("$ZodCustomStringFormat",(e,t)=>{tP.init(e,t),e._zod.check=n=>{t.fn(n.value)||n.issues.push({code:"invalid_format",format:t.format,input:n.value,inst:e,continue:!t.abort})}}),t5=t("$ZodNumber",(e,t)=>{tk.init(e,t),e._zod.pattern=e._zod.bag.pattern??e1,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=Number(n.value)}catch(e){}let o=n.value;if("number"==typeof o&&!Number.isNaN(o)&&Number.isFinite(o))return n;let u="number"==typeof o?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:o,inst:e,...u?{received:u}:{}}),n}}),t7=t("$ZodNumberFormat",(e,t)=>{tf.init(e,t),t5.init(e,t)}),ne=t("$ZodBoolean",(e,t)=>{tk.init(e,t),e._zod.pattern=e2,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=!!n.value}catch(e){}let o=n.value;return"boolean"==typeof o||n.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:e}),n}}),nt=t("$ZodBigInt",(e,t)=>{tk.init(e,t),e._zod.pattern=eQ,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=BigInt(n.value)}catch(e){}return"bigint"==typeof n.value||n.issues.push({expected:"bigint",code:"invalid_type",input:n.value,inst:e}),n}}),nn=t("$ZodBigIntFormat",(e,t)=>{th.init(e,t),nt.init(e,t)}),nr=t("$ZodSymbol",(e,t)=>{tk.init(e,t),e._zod.parse=(t,n)=>{let r=t.value;return"symbol"==typeof r||t.issues.push({expected:"symbol",code:"invalid_type",input:r,inst:e}),t}}),no=t("$ZodUndefined",(e,t)=>{tk.init(e,t),e._zod.pattern=e4,e._zod.values=new Set([void 0]),e._zod.optin="optional",e._zod.optout="optional",e._zod.parse=(t,n)=>{let r=t.value;return void 0===r||t.issues.push({expected:"undefined",code:"invalid_type",input:r,inst:e}),t}}),nu=t("$ZodNull",(e,t)=>{tk.init(e,t),e._zod.pattern=e8,e._zod.values=new Set([null]),e._zod.parse=(t,n)=>{let r=t.value;return null===r||t.issues.push({expected:"null",code:"invalid_type",input:r,inst:e}),t}}),na=t("$ZodAny",(e,t)=>{tk.init(e,t),e._zod.parse=e=>e}),ni=t("$ZodUnknown",(e,t)=>{tk.init(e,t),e._zod.parse=e=>e}),ns=t("$ZodNever",(e,t)=>{tk.init(e,t),e._zod.parse=(t,n)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:e}),t)}),nc=t("$ZodVoid",(e,t)=>{tk.init(e,t),e._zod.parse=(t,n)=>{let r=t.value;return void 0===r||t.issues.push({expected:"void",code:"invalid_type",input:r,inst:e}),t}}),nl=t("$ZodDate",(e,t)=>{tk.init(e,t),e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=new Date(n.value)}catch(e){}let o=n.value,u=o instanceof Date;return u&&!Number.isNaN(o.getTime())||n.issues.push({expected:"date",code:"invalid_type",input:o,...u?{received:"Invalid Date"}:{},inst:e}),n}});function np(e,t,n){e.issues.length&&t.issues.push(...Q(n,e.issues)),t.value[n]=e.value}let nd=t("$ZodArray",(e,t)=>{tk.init(e,t),e._zod.parse=(n,r)=>{let o=n.value;if(!Array.isArray(o))return n.issues.push({expected:"array",code:"invalid_type",input:o,inst:e}),n;n.value=Array(o.length);let u=[];for(let e=0;e<o.length;e++){let a=o[e],i=t.element._zod.run({value:a,issues:[]},r);i instanceof Promise?u.push(i.then(t=>np(t,n,e))):np(i,n,e)}return u.length?Promise.all(u).then(()=>n):n}});function nm(e,t,n,r){e.issues.length&&t.issues.push(...Q(n,e.issues)),void 0===e.value?n in r&&(t.value[n]=void 0):t.value[n]=e.value}function nf(e){let t=Object.keys(e.shape);for(let n of t)if(!e.shape?.[n]?._zod?.traits?.has("$ZodType"))throw Error(`Invalid element at key "${n}": expected a Zod schema`);let n=U(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(n)}}function nh(e,t,n,r,o,u){let a=[],i=o.keySet,s=o.catchall._zod,c=s.def.type;for(let o in t){if(i.has(o))continue;if("never"===c){a.push(o);continue}let u=s.run({value:t[o],issues:[]},r);u instanceof Promise?e.push(u.then(e=>nm(e,n,o,t))):nm(u,n,o,t)}return(a.length&&n.issues.push({code:"unrecognized_keys",keys:a,input:t,inst:u}),e.length)?Promise.all(e).then(()=>n):n}let nD=t("$ZodObject",(e,t)=>{let n;tk.init(e,t);let r=Object.getOwnPropertyDescriptor(t,"shape");if(!r?.get){let e=t.shape;Object.defineProperty(t,"shape",{get:()=>{let n={...e};return Object.defineProperty(t,"shape",{value:n}),n}})}let o=f(()=>nf(t));v(e._zod,"propValues",()=>{let e=t.shape,n={};for(let t in e){let r=e[t]._zod;if(r.values)for(let e of(n[t]??(n[t]=new Set),r.values))n[t].add(e)}return n});let u=t.catchall;e._zod.parse=(t,r)=>{n??(n=o.value);let a=t.value;if(!x(a))return t.issues.push({expected:"object",code:"invalid_type",input:a,inst:e}),t;t.value={};let i=[],s=n.shape;for(let e of n.keys){let n=s[e]._zod.run({value:a[e],issues:[]},r);n instanceof Promise?i.push(n.then(n=>nm(n,t,e,a))):nm(n,t,e,a)}return u?nh(i,a,t,r,o.value,e):i.length?Promise.all(i).then(()=>t):t}}),ng=t("$ZodObjectJIT",(e,t)=>{let n,r;nD.init(e,t);let u=e._zod.parse,a=f(()=>nf(t)),i=!o.jitless,s=i&&k.value,c=t.catchall;e._zod.parse=(o,l)=>{r??(r=a.value);let p=o.value;return x(p)?i&&s&&l?.async===!1&&!0!==l.jitless?(n||(n=(e=>{let t=new tS(["shape","payload","ctx"]),n=a.value,r=e=>{let t=z(e);return`shape[${t}]._zod.run({ value: input[${t}], issues: [] }, ctx)`};t.write("const input = payload.value;");let o=Object.create(null),u=0;for(let e of n.keys)o[e]=`key_${u++}`;for(let e of(t.write("const newResult = {};"),n.keys)){let n=o[e],u=z(e);t.write(`const ${n} = ${r(e)};`),t.write(`
        if (${n}.issues.length) {
          payload.issues = payload.issues.concat(${n}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${u}, ...iss.path] : [${u}]
          })));
        }
        
        
        if (${n}.value === undefined) {
          if (${u} in input) {
            newResult[${u}] = undefined;
          }
        } else {
          newResult[${u}] = ${n}.value;
        }
        
      `)}t.write("payload.value = newResult;"),t.write("return payload;");let i=t.compile();return(t,n)=>i(e,t,n)})(t.shape)),o=n(o,l),c)?nh([],p,o,l,r,e):o:u(o,l):(o.issues.push({expected:"object",code:"invalid_type",input:p,inst:e}),o)}});function ny(e,t,n,r){for(let n of e)if(0===n.issues.length)return t.value=n.value,t;let o=e.filter(e=>!X(e));return 1===o.length?(t.value=o[0].value,o[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map(e=>e.issues.map(e=>et(e,r,u())))}),t)}let nv=t("$ZodUnion",(e,t)=>{tk.init(e,t),v(e._zod,"optin",()=>t.options.some(e=>"optional"===e._zod.optin)?"optional":void 0),v(e._zod,"optout",()=>t.options.some(e=>"optional"===e._zod.optout)?"optional":void 0),v(e._zod,"values",()=>{if(t.options.every(e=>e._zod.values))return new Set(t.options.flatMap(e=>Array.from(e._zod.values)))}),v(e._zod,"pattern",()=>{if(t.options.every(e=>e._zod.pattern)){let e=t.options.map(e=>e._zod.pattern);return RegExp(`^(${e.map(e=>D(e.source)).join("|")})$`)}});let n=1===t.options.length,r=t.options[0]._zod.run;e._zod.parse=(o,u)=>{if(n)return r(o,u);let a=!1,i=[];for(let e of t.options){let t=e._zod.run({value:o.value,issues:[]},u);if(t instanceof Promise)i.push(t),a=!0;else{if(0===t.issues.length)return t;i.push(t)}}return a?Promise.all(i).then(t=>ny(t,o,e,u)):ny(i,o,e,u)}}),nA=t("$ZodDiscriminatedUnion",(e,t)=>{nv.init(e,t);let n=e._zod.parse;v(e._zod,"propValues",()=>{let e={};for(let n of t.options){let r=n._zod.propValues;if(!r||0===Object.keys(r).length)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(n)}"`);for(let[t,n]of Object.entries(r))for(let r of(e[t]||(e[t]=new Set),n))e[t].add(r)}return e});let r=f(()=>{let e=t.options,n=new Map;for(let r of e){let e=r._zod.propValues?.[t.discriminator];if(!e||0===e.size)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(r)}"`);for(let t of e){if(n.has(t))throw Error(`Duplicate discriminator value "${String(t)}"`);n.set(t,r)}}return n});e._zod.parse=(o,u)=>{let a=o.value;if(!x(a))return o.issues.push({code:"invalid_type",expected:"object",input:a,inst:e}),o;let i=r.value.get(a?.[t.discriminator]);return i?i._zod.run(o,u):t.unionFallback?n(o,u):(o.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:t.discriminator,input:a,path:[t.discriminator],inst:e}),o)}}),nb=t("$ZodIntersection",(e,t)=>{tk.init(e,t),e._zod.parse=(e,n)=>{let r=e.value,o=t.left._zod.run({value:r,issues:[]},n),u=t.right._zod.run({value:r,issues:[]},n);return o instanceof Promise||u instanceof Promise?Promise.all([o,u]).then(([t,n])=>nE(e,t,n)):nE(e,o,u)}});function nE(e,t,n){if(t.issues.length&&e.issues.push(...t.issues),n.issues.length&&e.issues.push(...n.issues),X(e))return e;let r=function e(t,n){if(t===n||t instanceof Date&&n instanceof Date&&+t==+n)return{valid:!0,data:t};if(B(t)&&B(n)){let r=Object.keys(n),o=Object.keys(t).filter(e=>-1!==r.indexOf(e)),u={...t,...n};for(let r of o){let o=e(t[r],n[r]);if(!o.valid)return{valid:!1,mergeErrorPath:[r,...o.mergeErrorPath]};u[r]=o.data}return{valid:!0,data:u}}if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return{valid:!1,mergeErrorPath:[]};let r=[];for(let o=0;o<t.length;o++){let u=e(t[o],n[o]);if(!u.valid)return{valid:!1,mergeErrorPath:[o,...u.mergeErrorPath]};r.push(u.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}(t.value,n.value);if(!r.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return e.value=r.data,e}let nC=t("$ZodTuple",(e,t)=>{tk.init(e,t);let n=t.items;e._zod.parse=(r,o)=>{let u=r.value;if(!Array.isArray(u))return r.issues.push({input:u,inst:e,expected:"tuple",code:"invalid_type"}),r;r.value=[];let a=[],i=[...n].reverse().findIndex(e=>"optional"!==e._zod.optin),s=-1===i?0:n.length-i;if(!t.rest){let t=u.length>n.length,o=u.length<s-1;if(t||o)return r.issues.push({...t?{code:"too_big",maximum:n.length}:{code:"too_small",minimum:n.length},input:u,inst:e,origin:"array"}),r}let c=-1;for(let e of n){if(++c>=u.length&&c>=s)continue;let t=e._zod.run({value:u[c],issues:[]},o);t instanceof Promise?a.push(t.then(e=>nF(e,r,c))):nF(t,r,c)}if(t.rest)for(let e of u.slice(n.length)){c++;let n=t.rest._zod.run({value:e,issues:[]},o);n instanceof Promise?a.push(n.then(e=>nF(e,r,c))):nF(n,r,c)}return a.length?Promise.all(a).then(()=>r):r}});function nF(e,t,n){e.issues.length&&t.issues.push(...Q(n,e.issues)),t.value[n]=e.value}let nw=t("$ZodRecord",(e,t)=>{tk.init(e,t),e._zod.parse=(n,r)=>{let o=n.value;if(!B(o))return n.issues.push({expected:"record",code:"invalid_type",input:o,inst:e}),n;let a=[],i=t.keyType._zod.values;if(i){let u;n.value={};let s=new Set;for(let e of i)if("string"==typeof e||"number"==typeof e||"symbol"==typeof e){s.add("number"==typeof e?e.toString():e);let u=t.valueType._zod.run({value:o[e],issues:[]},r);u instanceof Promise?a.push(u.then(t=>{t.issues.length&&n.issues.push(...Q(e,t.issues)),n.value[e]=t.value})):(u.issues.length&&n.issues.push(...Q(e,u.issues)),n.value[e]=u.value)}for(let e in o)s.has(e)||(u=u??[]).push(e);u&&u.length>0&&n.issues.push({code:"unrecognized_keys",input:o,inst:e,keys:u})}else for(let i of(n.value={},Reflect.ownKeys(o))){if("__proto__"===i)continue;let s=t.keyType._zod.run({value:i,issues:[]},r);if(s instanceof Promise)throw Error("Async schemas not supported in object keys currently");if(s.issues.length){n.issues.push({code:"invalid_key",origin:"record",issues:s.issues.map(e=>et(e,r,u())),input:i,path:[i],inst:e}),n.value[s.value]=s.value;continue}let c=t.valueType._zod.run({value:o[i],issues:[]},r);c instanceof Promise?a.push(c.then(e=>{e.issues.length&&n.issues.push(...Q(i,e.issues)),n.value[s.value]=e.value})):(c.issues.length&&n.issues.push(...Q(i,c.issues)),n.value[s.value]=c.value)}return a.length?Promise.all(a).then(()=>n):n}}),n_=t("$ZodMap",(e,t)=>{tk.init(e,t),e._zod.parse=(n,r)=>{let o=n.value;if(!(o instanceof Map))return n.issues.push({expected:"map",code:"invalid_type",input:o,inst:e}),n;let u=[];for(let[a,i]of(n.value=new Map,o)){let s=t.keyType._zod.run({value:a,issues:[]},r),c=t.valueType._zod.run({value:i,issues:[]},r);s instanceof Promise||c instanceof Promise?u.push(Promise.all([s,c]).then(([t,u])=>{nz(t,u,n,a,o,e,r)})):nz(s,c,n,a,o,e,r)}return u.length?Promise.all(u).then(()=>n):n}});function nz(e,t,n,r,o,a,i){e.issues.length&&($.has(typeof r)?n.issues.push(...Q(r,e.issues)):n.issues.push({code:"invalid_key",origin:"map",input:o,inst:a,issues:e.issues.map(e=>et(e,i,u()))})),t.issues.length&&($.has(typeof r)?n.issues.push(...Q(r,t.issues)):n.issues.push({origin:"map",code:"invalid_element",input:o,inst:a,key:r,issues:t.issues.map(e=>et(e,i,u()))})),n.value.set(e.value,t.value)}let nO=t("$ZodSet",(e,t)=>{tk.init(e,t),e._zod.parse=(n,r)=>{let o=n.value;if(!(o instanceof Set))return n.issues.push({input:o,inst:e,expected:"set",code:"invalid_type"}),n;let u=[];for(let e of(n.value=new Set,o)){let o=t.valueType._zod.run({value:e,issues:[]},r);o instanceof Promise?u.push(o.then(e=>nS(e,n))):nS(o,n)}return u.length?Promise.all(u).then(()=>n):n}});function nS(e,t){e.issues.length&&t.issues.push(...e.issues),t.value.add(e.value)}let nx=t("$ZodEnum",(e,t)=>{tk.init(e,t);let n=p(t.entries),r=new Set(n);e._zod.values=r,e._zod.pattern=RegExp(`^(${n.filter(e=>$.has(typeof e)).map(e=>"string"==typeof e?T(e):e.toString()).join("|")})$`),e._zod.parse=(t,o)=>{let u=t.value;return r.has(u)||t.issues.push({code:"invalid_value",values:n,input:u,inst:e}),t}}),nk=t("$ZodLiteral",(e,t)=>{if(tk.init(e,t),0===t.values.length)throw Error("Cannot create literal schema with no valid values");let n=new Set(t.values);e._zod.values=n,e._zod.pattern=RegExp(`^(${t.values.map(e=>"string"==typeof e?T(e):e?T(e.toString()):String(e)).join("|")})$`),e._zod.parse=(r,o)=>{let u=r.value;return n.has(u)||r.issues.push({code:"invalid_value",values:t.values,input:u,inst:e}),r}}),nB=t("$ZodFile",(e,t)=>{tk.init(e,t),e._zod.parse=(t,n)=>{let r=t.value;return r instanceof File||t.issues.push({expected:"file",code:"invalid_type",input:r,inst:e}),t}}),nP=t("$ZodTransform",(e,t)=>{tk.init(e,t),e._zod.parse=(o,u)=>{if("backward"===u.direction)throw new r(e.constructor.name);let a=t.transform(o.value,o);if(u.async)return(a instanceof Promise?a:Promise.resolve(a)).then(e=>(o.value=e,o));if(a instanceof Promise)throw new n;return o.value=a,o}});function nR(e,t){return e.issues.length&&void 0===t?{issues:[],value:void 0}:e}let n$=t("$ZodOptional",(e,t)=>{tk.init(e,t),e._zod.optin="optional",e._zod.optout="optional",v(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),v(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${D(e.source)})?$`):void 0}),e._zod.parse=(e,n)=>{if("optional"===t.innerType._zod.optin){let r=t.innerType._zod.run(e,n);return r instanceof Promise?r.then(t=>nR(t,e.value)):nR(r,e.value)}return void 0===e.value?e:t.innerType._zod.run(e,n)}}),nN=t("$ZodNullable",(e,t)=>{tk.init(e,t),v(e._zod,"optin",()=>t.innerType._zod.optin),v(e._zod,"optout",()=>t.innerType._zod.optout),v(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${D(e.source)}|null)$`):void 0}),v(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(e,n)=>null===e.value?e:t.innerType._zod.run(e,n)}),nT=t("$ZodDefault",(e,t)=>{tk.init(e,t),e._zod.optin="optional",v(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,n)=>{if("backward"===n.direction)return t.innerType._zod.run(e,n);if(void 0===e.value)return e.value=t.defaultValue,e;let r=t.innerType._zod.run(e,n);return r instanceof Promise?r.then(e=>nj(e,t)):nj(r,t)}});function nj(e,t){return void 0===e.value&&(e.value=t.defaultValue),e}let nI=t("$ZodPrefault",(e,t)=>{tk.init(e,t),e._zod.optin="optional",v(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,n)=>("backward"===n.direction||void 0===e.value&&(e.value=t.defaultValue),t.innerType._zod.run(e,n))}),nZ=t("$ZodNonOptional",(e,t)=>{tk.init(e,t),v(e._zod,"values",()=>{let e=t.innerType._zod.values;return e?new Set([...e].filter(e=>void 0!==e)):void 0}),e._zod.parse=(n,r)=>{let o=t.innerType._zod.run(n,r);return o instanceof Promise?o.then(t=>nM(t,e)):nM(o,e)}});function nM(e,t){return e.issues.length||void 0!==e.value||e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}let nU=t("$ZodSuccess",(e,t)=>{tk.init(e,t),e._zod.parse=(e,n)=>{if("backward"===n.direction)throw new r("ZodSuccess");let o=t.innerType._zod.run(e,n);return o instanceof Promise?o.then(t=>(e.value=0===t.issues.length,e)):(e.value=0===o.issues.length,e)}}),nq=t("$ZodCatch",(e,t)=>{tk.init(e,t),v(e._zod,"optin",()=>t.innerType._zod.optin),v(e._zod,"optout",()=>t.innerType._zod.optout),v(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,n)=>{if("backward"===n.direction)return t.innerType._zod.run(e,n);let r=t.innerType._zod.run(e,n);return r instanceof Promise?r.then(r=>(e.value=r.value,r.issues.length&&(e.value=t.catchValue({...e,error:{issues:r.issues.map(e=>et(e,n,u()))},input:e.value}),e.issues=[]),e)):(e.value=r.value,r.issues.length&&(e.value=t.catchValue({...e,error:{issues:r.issues.map(e=>et(e,n,u()))},input:e.value}),e.issues=[]),e)}}),nL=t("$ZodNaN",(e,t)=>{tk.init(e,t),e._zod.parse=(t,n)=>("number"==typeof t.value&&Number.isNaN(t.value)||t.issues.push({input:t.value,inst:e,expected:"nan",code:"invalid_type"}),t)}),nJ=t("$ZodPipe",(e,t)=>{tk.init(e,t),v(e._zod,"values",()=>t.in._zod.values),v(e._zod,"optin",()=>t.in._zod.optin),v(e._zod,"optout",()=>t.out._zod.optout),v(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(e,n)=>{if("backward"===n.direction){let r=t.out._zod.run(e,n);return r instanceof Promise?r.then(e=>nG(e,t.in,n)):nG(r,t.in,n)}let r=t.in._zod.run(e,n);return r instanceof Promise?r.then(e=>nG(e,t.out,n)):nG(r,t.out,n)}});function nG(e,t,n){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},n)}let nV=t("$ZodCodec",(e,t)=>{tk.init(e,t),v(e._zod,"values",()=>t.in._zod.values),v(e._zod,"optin",()=>t.in._zod.optin),v(e._zod,"optout",()=>t.out._zod.optout),v(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(e,n)=>{if("forward"===(n.direction||"forward")){let r=t.in._zod.run(e,n);return r instanceof Promise?r.then(e=>nW(e,t,n)):nW(r,t,n)}{let r=t.out._zod.run(e,n);return r instanceof Promise?r.then(e=>nW(e,t,n)):nW(r,t,n)}}});function nW(e,t,n){if(e.issues.length)return e.aborted=!0,e;if("forward"===(n.direction||"forward")){let r=t.transform(e.value,e);return r instanceof Promise?r.then(r=>nH(e,r,t.out,n)):nH(e,r,t.out,n)}{let r=t.reverseTransform(e.value,e);return r instanceof Promise?r.then(r=>nH(e,r,t.in,n)):nH(e,r,t.in,n)}}function nH(e,t,n,r){return e.issues.length?(e.aborted=!0,e):n._zod.run({value:t,issues:e.issues},r)}let nK=t("$ZodReadonly",(e,t)=>{tk.init(e,t),v(e._zod,"propValues",()=>t.innerType._zod.propValues),v(e._zod,"values",()=>t.innerType._zod.values),v(e._zod,"optin",()=>t.innerType?._zod?.optin),v(e._zod,"optout",()=>t.innerType?._zod?.optout),e._zod.parse=(e,n)=>{if("backward"===n.direction)return t.innerType._zod.run(e,n);let r=t.innerType._zod.run(e,n);return r instanceof Promise?r.then(nY):nY(r)}});function nY(e){return e.value=Object.freeze(e.value),e}let nX=t("$ZodTemplateLiteral",(e,t)=>{tk.init(e,t);let n=[];for(let e of t.parts)if("object"==typeof e&&null!==e){if(!e._zod.pattern)throw Error(`Invalid template literal part, no pattern found: ${[...e._zod.traits].shift()}`);let t=e._zod.pattern instanceof RegExp?e._zod.pattern.source:e._zod.pattern;if(!t)throw Error(`Invalid template literal part: ${e._zod.traits}`);let r=+!!t.startsWith("^"),o=t.endsWith("$")?t.length-1:t.length;n.push(t.slice(r,o))}else if(null===e||N.has(typeof e))n.push(T(`${e}`));else throw Error(`Invalid template literal part: ${e}`);e._zod.pattern=RegExp(`^${n.join("")}$`),e._zod.parse=(n,r)=>("string"!=typeof n.value?n.issues.push({input:n.value,inst:e,expected:"template_literal",code:"invalid_type"}):(e._zod.pattern.lastIndex=0,e._zod.pattern.test(n.value)||n.issues.push({input:n.value,inst:e,code:"invalid_format",format:t.format??"template_literal",pattern:e._zod.pattern.source})),n)}),nQ=t("$ZodFunction",(e,t)=>(tk.init(e,t),e._def=t,e._zod.def=t,e.implement=t=>{if("function"!=typeof t)throw Error("implement() must be called with a function");return function(...n){let r=Reflect.apply(t,this,e._def.input?eg(e._def.input,n):n);return e._def.output?eg(e._def.output,r):r}},e.implementAsync=t=>{if("function"!=typeof t)throw Error("implementAsync() must be called with a function");return async function(...n){let r=e._def.input?await ev(e._def.input,n):n,o=await Reflect.apply(t,this,r);return e._def.output?await ev(e._def.output,o):o}},e._zod.parse=(t,n)=>("function"!=typeof t.value?t.issues.push({code:"invalid_type",expected:"function",input:t.value,inst:e}):e._def.output&&"promise"===e._def.output._zod.def.type?t.value=e.implementAsync(t.value):t.value=e.implement(t.value),t),e.input=(...t)=>{let n=e.constructor;return new n(Array.isArray(t[0])?{type:"function",input:new nC({type:"tuple",items:t[0],rest:t[1]}),output:e._def.output}:{type:"function",input:t[0],output:e._def.output})},e.output=t=>new e.constructor({type:"function",input:e._def.input,output:t}),e)),n0=t("$ZodPromise",(e,t)=>{tk.init(e,t),e._zod.parse=(e,n)=>Promise.resolve(e.value).then(e=>t.innerType._zod.run({value:e,issues:[]},n))}),n1=t("$ZodLazy",(e,t)=>{tk.init(e,t),v(e._zod,"innerType",()=>t.getter()),v(e._zod,"pattern",()=>e._zod.innerType?._zod?.pattern),v(e._zod,"propValues",()=>e._zod.innerType?._zod?.propValues),v(e._zod,"optin",()=>e._zod.innerType?._zod?.optin??void 0),v(e._zod,"optout",()=>e._zod.innerType?._zod?.optout??void 0),e._zod.parse=(t,n)=>e._zod.innerType._zod.run(t,n)}),n2=t("$ZodCustom",(e,t)=>{tc.init(e,t),tk.init(e,t),e._zod.parse=(e,t)=>e,e._zod.check=n=>{let r=n.value,o=t.fn(r);if(o instanceof Promise)return o.then(t=>n8(t,n,r,e));n8(o,n,r,e)}});function n8(e,t,n,r){if(!e){let e={code:"custom",input:n,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(e.params=r._zod.def.params),t.issues.push(eo(e))}}e.s(["$ZodAny",0,na,"$ZodArray",0,nd,"$ZodBase64",0,t1,"$ZodBase64URL",0,t8,"$ZodBigInt",0,nt,"$ZodBigIntFormat",0,nn,"$ZodBoolean",0,ne,"$ZodCIDRv4",0,tX,"$ZodCIDRv6",0,tQ,"$ZodCUID",0,tZ,"$ZodCUID2",0,tM,"$ZodCatch",0,nq,"$ZodCodec",0,nV,"$ZodCustom",0,n2,"$ZodCustomStringFormat",0,t6,"$ZodDate",0,nl,"$ZodDefault",0,nT,"$ZodDiscriminatedUnion",0,nA,"$ZodE164",0,t4,"$ZodEmail",0,tN,"$ZodEmoji",0,tj,"$ZodEnum",0,nx,"$ZodFile",0,nB,"$ZodFunction",0,nQ,"$ZodGUID",0,tR,"$ZodIPv4",0,tH,"$ZodIPv6",0,tK,"$ZodISODate",0,tG,"$ZodISODateTime",0,tJ,"$ZodISODuration",0,tW,"$ZodISOTime",0,tV,"$ZodIntersection",0,nb,"$ZodJWT",0,t3,"$ZodKSUID",0,tL,"$ZodLazy",0,n1,"$ZodLiteral",0,nk,"$ZodMAC",0,tY,"$ZodMap",0,n_,"$ZodNaN",0,nL,"$ZodNanoID",0,tI,"$ZodNever",0,ns,"$ZodNonOptional",0,nZ,"$ZodNull",0,nu,"$ZodNullable",0,nN,"$ZodNumber",0,t5,"$ZodNumberFormat",0,t7,"$ZodObject",0,nD,"$ZodObjectJIT",0,ng,"$ZodOptional",0,n$,"$ZodPipe",0,nJ,"$ZodPrefault",0,nI,"$ZodPromise",0,n0,"$ZodReadonly",0,nK,"$ZodRecord",0,nw,"$ZodSet",0,nO,"$ZodString",0,tB,"$ZodStringFormat",0,tP,"$ZodSuccess",0,nU,"$ZodSymbol",0,nr,"$ZodTemplateLiteral",0,nX,"$ZodTransform",0,nP,"$ZodTuple",0,nC,"$ZodType",0,tk,"$ZodULID",0,tU,"$ZodURL",0,tT,"$ZodUUID",0,t$,"$ZodUndefined",0,no,"$ZodUnion",0,nv,"$ZodUnknown",0,ni,"$ZodVoid",0,nc,"$ZodXID",0,tq,"isValidBase64",()=>t0,"isValidBase64URL",()=>t2,"isValidJWT",()=>t9],39510),Symbol("ZodOutput"),Symbol("ZodInput");(ru=globalThis).__zod_globalRegistry??(ru.__zod_globalRegistry=new class e{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...t){let n=t[0];if(this._map.set(e,n),n&&"object"==typeof n&&"id"in n){if(this._idmap.has(n.id))throw Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){let t=this._map.get(e);return t&&"object"==typeof t&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){let t=e._zod.parent;if(t){let n={...this.get(t)??{}};delete n.id;let r={...n,...this._map.get(e)};return Object.keys(r).length?r:void 0}return this._map.get(e)}has(e){return this._map.has(e)}});let n4=globalThis.__zod_globalRegistry;function n9(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...I(t)})}function n3(e,t){return new tp({check:"less_than",...I(t),value:e,inclusive:!1})}function n6(e,t){return new tp({check:"less_than",...I(t),value:e,inclusive:!0})}function n5(e,t){return new td({check:"greater_than",...I(t),value:e,inclusive:!1})}function n7(e,t){return new td({check:"greater_than",...I(t),value:e,inclusive:!0})}function re(e,t){return new tm({check:"multiple_of",...I(t),value:e})}function rt(e,t){return new ty({check:"max_length",...I(t),maximum:e})}function rn(e,t){return new tv({check:"min_length",...I(t),minimum:e})}function rr(e,t){return new tA({check:"length_equals",...I(t),length:e})}function ro(e){return new tO({check:"overwrite",tx:e})}e.i(39510),e.i(21131);var ru,ra=e.i(86618),ra=ra;let ri=t("ZodISODateTime",(e,t)=>{tJ.init(e,t),rO.init(e,t)}),rs=t("ZodISODate",(e,t)=>{tG.init(e,t),rO.init(e,t)}),rc=t("ZodISOTime",(e,t)=>{tV.init(e,t),rO.init(e,t)}),rl=t("ZodISODuration",(e,t)=>{tW.init(e,t),rO.init(e,t)}),rp=t("ZodError",(e,t)=>{ef.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:t=>(function(e,t=e=>e.message){let n={_errors:[]},r=e=>{for(let o of e.issues)if("invalid_union"===o.code&&o.errors.length)o.errors.map(e=>r({issues:e}));else if("invalid_key"===o.code)r({issues:o.issues});else if("invalid_element"===o.code)r({issues:o.issues});else if(0===o.path.length)n._errors.push(t(o));else{let e=n,r=0;for(;r<o.path.length;){let n=o.path[r];r===o.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(o))):e[n]=e[n]||{_errors:[]},e=e[n],r++}}};return r(e),n})(e,t)},flatten:{value:t=>(function(e,t=e=>e.message){let n={},r=[];for(let o of e.issues)o.path.length>0?(n[o.path[0]]=n[o.path[0]]||[],n[o.path[0]].push(t(o))):r.push(t(o));return{formErrors:r,fieldErrors:n}})(e,t)},addIssue:{value:t=>{e.issues.push(t),e.message=JSON.stringify(e.issues,m,2)}},addIssues:{value:t=>{e.issues.push(...t),e.message=JSON.stringify(e.issues,m,2)}},isEmpty:{get:()=>0===e.issues.length}})},{Parent:Error}),rd=eD(rp),rm=ey(rp),rf=eA(rp),rh=eE(rp),rD=(e,t,n)=>{let r=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return eD(rp)(e,t,r)},rg=(e,t,n)=>eD(rp)(e,t,n),ry=async(e,t,n)=>{let r=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return ey(rp)(e,t,r)},rv=async(e,t,n)=>ey(rp)(e,t,n),rA=(e,t,n)=>{let r=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return eA(rp)(e,t,r)},rb=(e,t,n)=>eA(rp)(e,t,n),rE=async(e,t,n)=>{let r=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return eE(rp)(e,t,r)},rC=async(e,t,n)=>eE(rp)(e,t,n),rF=t("ZodType",(e,t)=>(tk.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...n)=>e.clone(ra.mergeDefs(t,{checks:[...t.checks??[],...n.map(e=>"function"==typeof e?{_zod:{check:e,def:{check:"custom"},onattach:[]}}:e)]})),e.clone=(t,n)=>j(e,t,n),e.brand=()=>e,e.register=(t,n)=>(t.add(e,n),e),e.parse=(t,n)=>rd(e,t,n,{callee:e.parse}),e.safeParse=(t,n)=>rf(e,t,n),e.parseAsync=async(t,n)=>rm(e,t,n,{callee:e.parseAsync}),e.safeParseAsync=async(t,n)=>rh(e,t,n),e.spa=e.safeParseAsync,e.encode=(t,n)=>rD(e,t,n),e.decode=(t,n)=>rg(e,t,n),e.encodeAsync=async(t,n)=>ry(e,t,n),e.decodeAsync=async(t,n)=>rv(e,t,n),e.safeEncode=(t,n)=>rA(e,t,n),e.safeDecode=(t,n)=>rb(e,t,n),e.safeEncodeAsync=async(t,n)=>rE(e,t,n),e.safeDecodeAsync=async(t,n)=>rC(e,t,n),e.refine=(t,n)=>e.check(function(e,t={}){return new os({type:"custom",check:"custom",fn:e,...I(t)})}(t,n)),e.superRefine=t=>e.check(function(e){var t;let n,r;return t=t=>(t.addIssue=e=>{"string"==typeof e?t.issues.push(eo(e,t.value,n._zod.def)):(e.fatal&&(e.continue=!1),e.code??(e.code="custom"),e.input??(e.input=t.value),e.inst??(e.inst=n),e.continue??(e.continue=!n._zod.def.abort),t.issues.push(eo(e)))},e(t.value,t)),(r=new tc({check:"custom",...I(void 0)}))._zod.check=t,n=r}(t)),e.overwrite=t=>e.check(ro(t)),e.optional=()=>r5(e),e.nullable=()=>oe(e),e.nullish=()=>r5(oe(e)),e.nonoptional=t=>{var n,r;return n=e,r=t,new or({type:"nonoptional",innerType:n,...ra.normalizeParams(r)})},e.array=()=>(function(e,t){return new r0({type:"array",element:e,...I(void 0)})})(e),e.or=t=>new r8({type:"union",options:[e,t],...ra.normalizeParams(void 0)}),e.and=t=>new r4({type:"intersection",left:e,right:t}),e.transform=t=>oa(e,new r3({type:"transform",transform:t})),e.default=t=>{var n,r;return n=e,r=t,new ot({type:"default",innerType:n,get defaultValue(){return"function"==typeof r?r():ra.shallowClone(r)}})},e.prefault=t=>{var n,r;return n=e,r=t,new on({type:"prefault",innerType:n,get defaultValue(){return"function"==typeof r?r():ra.shallowClone(r)}})},e.catch=t=>{var n;return new oo({type:"catch",innerType:e,catchValue:"function"==typeof(n=t)?n:()=>n})},e.pipe=t=>oa(e,t),e.readonly=()=>new oi({type:"readonly",innerType:e}),e.describe=t=>{let n=e.clone();return n4.add(n,{description:t}),n},Object.defineProperty(e,"description",{get:()=>n4.get(e)?.description,configurable:!0}),e.meta=(...t)=>{if(0===t.length)return n4.get(e);let n=e.clone();return n4.add(n,t[0]),n},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),rw=t("_ZodString",(e,t)=>{tB.init(e,t),rF.init(e,t);let n=e._zod.bag;e.format=n.format??null,e.minLength=n.minimum??null,e.maxLength=n.maximum??null,e.regex=(...t)=>e.check(function(e,t){return new tE({check:"string_format",format:"regex",...I(t),pattern:e})}(...t)),e.includes=(...t)=>e.check(function(e,t){return new tw({check:"string_format",format:"includes",...I(t),includes:e})}(...t)),e.startsWith=(...t)=>e.check(function(e,t){return new t_({check:"string_format",format:"starts_with",...I(t),prefix:e})}(...t)),e.endsWith=(...t)=>e.check(function(e,t){return new tz({check:"string_format",format:"ends_with",...I(t),suffix:e})}(...t)),e.min=(...t)=>e.check(rn(...t)),e.max=(...t)=>e.check(rt(...t)),e.length=(...t)=>e.check(rr(...t)),e.nonempty=(...t)=>e.check(rn(1,...t)),e.lowercase=t=>e.check(new tC({check:"string_format",format:"lowercase",...I(t)})),e.uppercase=t=>e.check(new tF({check:"string_format",format:"uppercase",...I(t)})),e.trim=()=>e.check(ro(e=>e.trim())),e.normalize=(...t)=>e.check(function(e){return ro(t=>t.normalize(e))}(...t)),e.toLowerCase=()=>e.check(ro(e=>e.toLowerCase())),e.toUpperCase=()=>e.check(ro(e=>e.toUpperCase())),e.slugify=()=>e.check(ro(e=>O(e)))}),r_=t("ZodString",(e,t)=>{tB.init(e,t),rw.init(e,t),e.email=t=>e.check(new rS({type:"string",format:"email",check:"string_format",abort:!1,...I(t)})),e.url=t=>e.check(new rB({type:"string",format:"url",check:"string_format",abort:!1,...I(t)})),e.jwt=t=>e.check(new rV({type:"string",format:"jwt",check:"string_format",abort:!1,...I(t)})),e.emoji=t=>e.check(new rP({type:"string",format:"emoji",check:"string_format",abort:!1,...I(t)})),e.guid=t=>e.check(n9(rx,t)),e.uuid=t=>e.check(new rk({type:"string",format:"uuid",check:"string_format",abort:!1,...I(t)})),e.uuidv4=t=>e.check(new rk({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...I(t)})),e.uuidv6=t=>e.check(new rk({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...I(t)})),e.uuidv7=t=>e.check(new rk({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...I(t)})),e.nanoid=t=>e.check(new rR({type:"string",format:"nanoid",check:"string_format",abort:!1,...I(t)})),e.guid=t=>e.check(n9(rx,t)),e.cuid=t=>e.check(new r$({type:"string",format:"cuid",check:"string_format",abort:!1,...I(t)})),e.cuid2=t=>e.check(new rN({type:"string",format:"cuid2",check:"string_format",abort:!1,...I(t)})),e.ulid=t=>e.check(new rT({type:"string",format:"ulid",check:"string_format",abort:!1,...I(t)})),e.base64=t=>e.check(new rL({type:"string",format:"base64",check:"string_format",abort:!1,...I(t)})),e.base64url=t=>e.check(new rJ({type:"string",format:"base64url",check:"string_format",abort:!1,...I(t)})),e.xid=t=>e.check(new rj({type:"string",format:"xid",check:"string_format",abort:!1,...I(t)})),e.ksuid=t=>e.check(new rI({type:"string",format:"ksuid",check:"string_format",abort:!1,...I(t)})),e.ipv4=t=>e.check(new rZ({type:"string",format:"ipv4",check:"string_format",abort:!1,...I(t)})),e.ipv6=t=>e.check(new rM({type:"string",format:"ipv6",check:"string_format",abort:!1,...I(t)})),e.cidrv4=t=>e.check(new rU({type:"string",format:"cidrv4",check:"string_format",abort:!1,...I(t)})),e.cidrv6=t=>e.check(new rq({type:"string",format:"cidrv6",check:"string_format",abort:!1,...I(t)})),e.e164=t=>e.check(new rG({type:"string",format:"e164",check:"string_format",abort:!1,...I(t)})),e.datetime=t=>e.check(new ri({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...I(t)})),e.date=t=>e.check(new rs({type:"string",format:"date",check:"string_format",...I(t)})),e.time=t=>e.check(new rc({type:"string",format:"time",check:"string_format",precision:null,...I(t)})),e.duration=t=>e.check(new rl({type:"string",format:"duration",check:"string_format",...I(t)}))});function rz(e){return new r_({type:"string",...I(e)})}let rO=t("ZodStringFormat",(e,t)=>{tP.init(e,t),rw.init(e,t)}),rS=t("ZodEmail",(e,t)=>{tN.init(e,t),rO.init(e,t)}),rx=t("ZodGUID",(e,t)=>{tR.init(e,t),rO.init(e,t)}),rk=t("ZodUUID",(e,t)=>{t$.init(e,t),rO.init(e,t)}),rB=t("ZodURL",(e,t)=>{tT.init(e,t),rO.init(e,t)}),rP=t("ZodEmoji",(e,t)=>{tj.init(e,t),rO.init(e,t)}),rR=t("ZodNanoID",(e,t)=>{tI.init(e,t),rO.init(e,t)}),r$=t("ZodCUID",(e,t)=>{tZ.init(e,t),rO.init(e,t)}),rN=t("ZodCUID2",(e,t)=>{tM.init(e,t),rO.init(e,t)}),rT=t("ZodULID",(e,t)=>{tU.init(e,t),rO.init(e,t)}),rj=t("ZodXID",(e,t)=>{tq.init(e,t),rO.init(e,t)}),rI=t("ZodKSUID",(e,t)=>{tL.init(e,t),rO.init(e,t)}),rZ=t("ZodIPv4",(e,t)=>{tH.init(e,t),rO.init(e,t)}),rM=t("ZodIPv6",(e,t)=>{tK.init(e,t),rO.init(e,t)}),rU=t("ZodCIDRv4",(e,t)=>{tX.init(e,t),rO.init(e,t)}),rq=t("ZodCIDRv6",(e,t)=>{tQ.init(e,t),rO.init(e,t)}),rL=t("ZodBase64",(e,t)=>{t1.init(e,t),rO.init(e,t)}),rJ=t("ZodBase64URL",(e,t)=>{t8.init(e,t),rO.init(e,t)}),rG=t("ZodE164",(e,t)=>{t4.init(e,t),rO.init(e,t)}),rV=t("ZodJWT",(e,t)=>{t3.init(e,t),rO.init(e,t)}),rW=t("ZodNumber",(e,t)=>{t5.init(e,t),rF.init(e,t),e.gt=(t,n)=>e.check(n5(t,n)),e.gte=(t,n)=>e.check(n7(t,n)),e.min=(t,n)=>e.check(n7(t,n)),e.lt=(t,n)=>e.check(n3(t,n)),e.lte=(t,n)=>e.check(n6(t,n)),e.max=(t,n)=>e.check(n6(t,n)),e.int=t=>e.check(rK(t)),e.safe=t=>e.check(rK(t)),e.positive=t=>e.check(n5(0,t)),e.nonnegative=t=>e.check(n7(0,t)),e.negative=t=>e.check(n3(0,t)),e.nonpositive=t=>e.check(n6(0,t)),e.multipleOf=(t,n)=>e.check(re(t,n)),e.step=(t,n)=>e.check(re(t,n)),e.finite=()=>e;let n=e._zod.bag;e.minValue=Math.max(n.minimum??-1/0,n.exclusiveMinimum??-1/0)??null,e.maxValue=Math.min(n.maximum??1/0,n.exclusiveMaximum??1/0)??null,e.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),e.isFinite=!0,e.format=n.format??null}),rH=t("ZodNumberFormat",(e,t)=>{t7.init(e,t),rW.init(e,t)});function rK(e){return new rH({type:"number",check:"number_format",abort:!1,format:"safeint",...I(e)})}(e,t)=>{nt.init(e,t),rF.init(e,t),e.gte=(t,n)=>e.check(n7(t,n)),e.min=(t,n)=>e.check(n7(t,n)),e.gt=(t,n)=>e.check(n5(t,n)),e.gte=(t,n)=>e.check(n7(t,n)),e.min=(t,n)=>e.check(n7(t,n)),e.lt=(t,n)=>e.check(n3(t,n)),e.lte=(t,n)=>e.check(n6(t,n)),e.max=(t,n)=>e.check(n6(t,n)),e.positive=t=>e.check(n5(BigInt(0),t)),e.negative=t=>e.check(n3(BigInt(0),t)),e.nonpositive=t=>e.check(n6(BigInt(0),t)),e.nonnegative=t=>e.check(n7(BigInt(0),t)),e.multipleOf=(t,n)=>e.check(re(t,n));let n=e._zod.bag;e.minValue=n.minimum??null,e.maxValue=n.maximum??null,e.format=n.format??null};let rY=t("ZodUnknown",(e,t)=>{ni.init(e,t),rF.init(e,t)});function rX(){return new rY({type:"unknown"})}let rQ=t("ZodNever",(e,t)=>{ns.init(e,t),rF.init(e,t)}),r0=t("ZodArray",(e,t)=>{nd.init(e,t),rF.init(e,t),e.element=t.element,e.min=(t,n)=>e.check(rn(t,n)),e.nonempty=t=>e.check(rn(1,t)),e.max=(t,n)=>e.check(rt(t,n)),e.length=(t,n)=>e.check(rr(t,n)),e.unwrap=()=>e.element}),r1=t("ZodObject",(e,t)=>{ng.init(e,t),rF.init(e,t),ra.defineLazy(e,"shape",()=>t.shape),e.keyof=()=>{var t;return new r9({type:"enum",entries:Array.isArray(t=Object.keys(e._zod.def.shape))?Object.fromEntries(t.map(e=>[e,e])):t,...ra.normalizeParams(void 0)})},e.catchall=t=>e.clone({...e._zod.def,catchall:t}),e.passthrough=()=>e.clone({...e._zod.def,catchall:rX()}),e.loose=()=>e.clone({...e._zod.def,catchall:rX()}),e.strict=()=>e.clone({...e._zod.def,catchall:new rQ({type:"never",...I(void 0)})}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=t=>ra.extend(e,t),e.safeExtend=t=>ra.safeExtend(e,t),e.merge=t=>ra.merge(e,t),e.pick=t=>ra.pick(e,t),e.omit=t=>ra.omit(e,t),e.partial=(...t)=>ra.partial(r6,e,t[0]),e.required=(...t)=>ra.required(or,e,t[0])});function r2(e,t){return new r1({type:"object",shape:e??{},...ra.normalizeParams(t)})}let r8=t("ZodUnion",(e,t)=>{nv.init(e,t),rF.init(e,t),e.options=t.options}),r4=t("ZodIntersection",(e,t)=>{nb.init(e,t),rF.init(e,t)}),r9=t("ZodEnum",(e,t)=>{nx.init(e,t),rF.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);let n=new Set(Object.keys(t.entries));e.extract=(e,r)=>{let o={};for(let r of e)if(n.has(r))o[r]=t.entries[r];else throw Error(`Key ${r} not found in enum`);return new r9({...t,checks:[],...ra.normalizeParams(r),entries:o})},e.exclude=(e,r)=>{let o={...t.entries};for(let t of e)if(n.has(t))delete o[t];else throw Error(`Key ${t} not found in enum`);return new r9({...t,checks:[],...ra.normalizeParams(r),entries:o})}}),r3=t("ZodTransform",(e,t)=>{nP.init(e,t),rF.init(e,t),e._zod.parse=(n,o)=>{if("backward"===o.direction)throw new r(e.constructor.name);n.addIssue=r=>{"string"==typeof r?n.issues.push(ra.issue(r,n.value,t)):(r.fatal&&(r.continue=!1),r.code??(r.code="custom"),r.input??(r.input=n.value),r.inst??(r.inst=e),n.issues.push(ra.issue(r)))};let u=t.transform(n.value,n);return u instanceof Promise?u.then(e=>(n.value=e,n)):(n.value=u,n)}}),r6=t("ZodOptional",(e,t)=>{n$.init(e,t),rF.init(e,t),e.unwrap=()=>e._zod.def.innerType});function r5(e){return new r6({type:"optional",innerType:e})}let r7=t("ZodNullable",(e,t)=>{nN.init(e,t),rF.init(e,t),e.unwrap=()=>e._zod.def.innerType});function oe(e){return new r7({type:"nullable",innerType:e})}let ot=t("ZodDefault",(e,t)=>{nT.init(e,t),rF.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap}),on=t("ZodPrefault",(e,t)=>{nI.init(e,t),rF.init(e,t),e.unwrap=()=>e._zod.def.innerType}),or=t("ZodNonOptional",(e,t)=>{nZ.init(e,t),rF.init(e,t),e.unwrap=()=>e._zod.def.innerType}),oo=t("ZodCatch",(e,t)=>{nq.init(e,t),rF.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap}),ou=t("ZodPipe",(e,t)=>{nJ.init(e,t),rF.init(e,t),e.in=t.in,e.out=t.out});function oa(e,t){return new ou({type:"pipe",in:e,out:t})}let oi=t("ZodReadonly",(e,t)=>{nK.init(e,t),rF.init(e,t),e.unwrap=()=>e._zod.def.innerType}),os=t("ZodCustom",(e,t)=>{n2.init(e,t),rF.init(e,t)})},96014,e=>e.a(async(t,n)=>{try{var r=e.i(44594);e.i(40683);var o=e.i(45597),u=e.i(36109),a=e.i(7855),i=t([r,u]);[r,u]=i.then?(await i)():i;let s=(0,r.defineFlow)({name:"quoteFlow",inputSchema:a.object({theme:a.string(),language:a.string()}),outputSchema:a.string()},async({theme:e,language:t})=>{let n=`Generate an inspiring quote or proverb about "${e}" in ${t}. 
    The quote should be short, impactful, and related to nature or wisdom if possible. 
    Return ONLY the quote text, no attribution or extra text.`;return(await o.generate({model:u.gemini15Pro,prompt:n,config:{temperature:.7}})).text});e.s(["quoteFlow",0,s]),n()}catch(e){n(e)}},!1),89707,e=>e.a(async(t,n)=>{try{var r=e.i(89171),o=e.i(96014),u=e.i(44594),a=t([o,u]);async function i(e){console.log(`[PUSH NOTIFICATION] ${e}`)}async function s(e){e.headers.get("Authorization")!==`Bearer ${process.env.CRON_SECRET}`&&console.warn("Unauthorized cron attempt");let t=new Date().getUTCHours(),n="Nature and Wisdom";n=t>=6&&t<10?"Wisdom & Presence":t>=10&&t<15?"Creation, Courage & Transformation":"Reflection & Peace";try{let e=await (0,u.runFlow)(o.quoteFlow,{theme:n,language:"en"}),t=`${e} - Share the weather you see now!`;return await i(t),r.NextResponse.json({success:!0,message:t})}catch(e){return console.error("Error in notify route:",e),r.NextResponse.json({success:!1,error:"Failed to generate quote"},{status:500})}}[o,u]=a.then?(await a)():a,e.s(["GET",()=>s]),n()}catch(e){n(e)}},!1),40798,e=>e.a(async(t,n)=>{try{var r=e.i(47909),o=e.i(74017),u=e.i(96250),a=e.i(59756),i=e.i(61916),s=e.i(14444),c=e.i(37092),l=e.i(69741),p=e.i(16795),d=e.i(87718),m=e.i(95169),f=e.i(47587),h=e.i(66012),D=e.i(70101),g=e.i(26937),y=e.i(10372),v=e.i(93695);e.i(52474);var A=e.i(220),b=e.i(89707),E=t([b]);[b]=E.then?(await E)():E;let w=new r.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/notify/route",pathname:"/api/notify",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/notify/route.ts",nextConfigOutput:"",userland:b}),{workAsyncStorage:_,workUnitAsyncStorage:z,serverHooks:O}=w;function C(){return(0,u.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:z})}async function F(e,t,n){w.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let r="/api/notify/route";r=r.replace(/\/index$/,"")||"/";let u=await w.prepare(e,t,{srcPage:r,multiZoneDraftMode:!1});if(!u)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:b,params:E,nextConfig:C,parsedUrl:F,isDraftMode:_,prerenderManifest:z,routerServerContext:O,isOnDemandRevalidate:S,revalidateOnlyGenerated:x,resolvedPathname:k,clientReferenceManifest:B,serverActionsManifest:P}=u,R=(0,l.normalizeAppPath)(r),$=!!(z.dynamicRoutes[R]||z.routes[k]),N=async()=>((null==O?void 0:O.render404)?await O.render404(e,t,F,!1):t.end("This page could not be found"),null);if($&&!_){let e=!!z.routes[k],t=z.dynamicRoutes[R];if(t&&!1===t.fallback&&!e){if(C.experimental.adapterPath)return await N();throw new v.NoFallbackError}}let T=null;!$||w.isDev||_||(T=k,T="/index"===T?"/":T);let j=!0===w.isDev||!$,I=$&&!j;P&&B&&(0,s.setReferenceManifestsSingleton)({page:r,clientReferenceManifest:B,serverActionsManifest:P,serverModuleMap:(0,c.createServerModuleMap)({serverActionsManifest:P})});let Z=e.method||"GET",M=(0,i.getTracer)(),U=M.getActiveScopeSpan(),q={params:E,prerenderManifest:z,renderOpts:{experimental:{authInterrupts:!!C.experimental.authInterrupts},cacheComponents:!!C.cacheComponents,supportsDynamicResponse:j,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:C.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,n,r)=>w.onRequestError(e,t,r,O)},sharedContext:{buildId:b}},L=new p.NodeNextRequest(e),J=new p.NodeNextResponse(t),G=d.NextRequestAdapter.fromNodeNextRequest(L,(0,d.signalFromNodeResponse)(t));try{let u=async e=>w.handle(G,q).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let n=M.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let o=n.get("next.route");if(o){let t=`${Z} ${o}`;e.setAttributes({"next.route":o,"http.route":o,"next.span_name":t}),e.updateName(t)}else e.updateName(`${Z} ${r}`)}),s=!!(0,a.getRequestMeta)(e,"minimalMode"),c=async a=>{var i,c;let l=async({previousCacheEntry:o})=>{try{if(!s&&S&&x&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let r=await u(a);e.fetchMetrics=q.renderOpts.fetchMetrics;let i=q.renderOpts.pendingWaitUntil;i&&n.waitUntil&&(n.waitUntil(i),i=void 0);let c=q.renderOpts.collectedTags;if(!$)return await (0,h.sendResponse)(L,J,r,q.renderOpts.pendingWaitUntil),null;{let e=await r.blob(),t=(0,D.toNodeOutgoingHttpHeaders)(r.headers);c&&(t[y.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let n=void 0!==q.renderOpts.collectedRevalidate&&!(q.renderOpts.collectedRevalidate>=y.INFINITE_CACHE)&&q.renderOpts.collectedRevalidate,o=void 0===q.renderOpts.collectedExpire||q.renderOpts.collectedExpire>=y.INFINITE_CACHE?void 0:q.renderOpts.collectedExpire;return{value:{kind:A.CachedRouteKind.APP_ROUTE,status:r.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:n,expire:o}}}}catch(t){throw(null==o?void 0:o.isStale)&&await w.onRequestError(e,t,{routerKind:"App Router",routePath:r,routeType:"route",revalidateReason:(0,f.getRevalidateReason)({isStaticGeneration:I,isOnDemandRevalidate:S})},O),t}},p=await w.handleResponse({req:e,nextConfig:C,cacheKey:T,routeKind:o.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:z,isRoutePPREnabled:!1,isOnDemandRevalidate:S,revalidateOnlyGenerated:x,responseGenerator:l,waitUntil:n.waitUntil,isMinimalMode:s});if(!$)return null;if((null==p||null==(i=p.value)?void 0:i.kind)!==A.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(c=p.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",S?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),_&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,D.fromNodeOutgoingHttpHeaders)(p.value.headers);return s&&$||d.delete(y.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,g.getCacheControlHeader)(p.cacheControl)),await (0,h.sendResponse)(L,J,new Response(p.value.body,{headers:d,status:p.value.status||200})),null};U?await c(U):await M.withPropagatedContext(e.headers,()=>M.trace(m.BaseServerSpan.handleRequest,{spanName:`${Z} ${r}`,kind:i.SpanKind.SERVER,attributes:{"http.method":Z,"http.target":e.url}},c))}catch(t){if(t instanceof v.NoFallbackError||await w.onRequestError(e,t,{routerKind:"App Router",routePath:R,routeType:"route",revalidateReason:(0,f.getRevalidateReason)({isStaticGeneration:I,isOnDemandRevalidate:S})}),$)throw t;return await (0,h.sendResponse)(L,J,new Response(null,{status:500})),null}}e.s(["handler",()=>F,"patchFetch",()=>C,"routeModule",()=>w,"serverHooks",()=>O,"workAsyncStorage",()=>_,"workUnitAsyncStorage",()=>z]),n()}catch(e){n(e)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__27ff1b89._.js.map